window.__require=function t(e,i,o){function s(n,r){if(!i[n]){if(!e[n]){var c=n.split("/");if(c=c[c.length-1],!e[c]){var l="function"==typeof __require&&__require;if(!r&&l)return l(c,!0);if(a)return a(c,!0);throw new Error("Cannot find module '"+n+"'")}n=c}var h=i[n]={exports:{}};e[n][0].call(h.exports,function(t){return s(e[n][1][t]||t)},h,h.exports,t,e,i,o)}return i[n].exports}for(var a="function"==typeof __require&&__require,n=0;n<o.length;n++)s(o[n]);return s}({ListItem:[function(t,e,i){"use strict";cc._RF.push(e,"582d0m2jOtPf6Wqj3ZoSn94","ListItem");var o,s=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),a=this&&this.__decorate||function(t,e,i,o){var s,a=arguments.length,n=a<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(t,e,i,o);else for(var r=t.length-1;r>=0;r--)(s=t[r])&&(n=(a<3?s(n):a>3?s(e,i,n):s(e,i))||n);return a>3&&n&&Object.defineProperty(e,i,n),n};Object.defineProperty(i,"__esModule",{value:!0});var n,r=cc._decorator,c=r.ccclass,l=r.property,h=r.disallowMultiple,p=r.menu,u=r.executionOrder;(function(t){t[t.NONE=0]="NONE",t[t.TOGGLE=1]="TOGGLE",t[t.SWITCH=2]="SWITCH"})(n||(n={}));var d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.icon=null,e.title=null,e.selectedMode=n.NONE,e.selectedFlag=null,e.selectedSpriteFrame=null,e._unselectedSpriteFrame=null,e.adaptiveSize=!1,e._selected=!1,e._eventReg=!1,e}return s(e,t),Object.defineProperty(e.prototype,"selected",{get:function(){return this._selected},set:function(t){if(this._selected=t,this.selectedFlag)switch(this.selectedMode){case n.TOGGLE:this.selectedFlag.active=t;break;case n.SWITCH:var e=this.selectedFlag.getComponent(cc.Sprite);e&&(e.spriteFrame=t?this.selectedSpriteFrame:this._unselectedSpriteFrame)}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"btnCom",{get:function(){return this._btnCom||(this._btnCom=this.node.getComponent(cc.Button)),this._btnCom},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){if(this.selectedMode==n.SWITCH){var t=this.selectedFlag.getComponent(cc.Sprite);this._unselectedSpriteFrame=t.spriteFrame}},e.prototype.onDestroy=function(){this.node.off(cc.Node.EventType.SIZE_CHANGED,this._onSizeChange,this)},e.prototype._registerEvent=function(){this._eventReg||(this.btnCom&&this.list.selectedMode>0&&this.btnCom.clickEvents.unshift(this.createEvt(this,"onClickThis")),this.adaptiveSize&&this.node.on(cc.Node.EventType.SIZE_CHANGED,this._onSizeChange,this),this._eventReg=!0)},e.prototype._onSizeChange=function(){this.list._onItemAdaptive(this.node)},e.prototype.createEvt=function(t,e,i){if(void 0===i&&(i=null),t.isValid){t.comName=t.comName||t.name.match(/\<(.*?)\>/g).pop().replace(/\<|>/g,"");var o=new cc.Component.EventHandler;return o.target=i||t.node,o.component=t.comName,o.handler=e,o}},e.prototype.showAni=function(t,e,i){var o,s=this;switch(t){case 0:o=cc.tween(s.node).to(.2,{scale:.7}).by(.3,{y:2*s.node.height});break;case 1:o=cc.tween(s.node).to(.2,{scale:.7}).by(.3,{x:2*s.node.width});break;case 2:o=cc.tween(s.node).to(.2,{scale:.7}).by(.3,{y:-2*s.node.height});break;case 3:o=cc.tween(s.node).to(.2,{scale:.7}).by(.3,{x:-2*s.node.width});break;default:o=cc.tween(s.node).to(.3,{scale:.1})}(e||i)&&o.call(function(){if(i){s.list._delSingleItem(s.node);for(var t=s.list.displayData.length-1;t>=0;t--)if(s.list.displayData[t].id==s.listId){s.list.displayData.splice(t,1);break}}e()}),o.start()},e.prototype.onClickThis=function(){this.list.selectedId=this.listId},a([l({type:cc.Sprite,tooltip:!1})],e.prototype,"icon",void 0),a([l({type:cc.Node,tooltip:!1})],e.prototype,"title",void 0),a([l({type:cc.Enum(n),tooltip:!1})],e.prototype,"selectedMode",void 0),a([l({type:cc.Node,tooltip:!1,visible:function(){return this.selectedMode>n.NONE}})],e.prototype,"selectedFlag",void 0),a([l({type:cc.SpriteFrame,tooltip:!1,visible:function(){return this.selectedMode==n.SWITCH}})],e.prototype,"selectedSpriteFrame",void 0),a([l({tooltip:!1})],e.prototype,"adaptiveSize",void 0),a([c,h(),p("\u81ea\u5b9a\u4e49\u7ec4\u4ef6/List Item"),u(-5001)],e)}(cc.Component);i.default=d,cc._RF.pop()},{}],List:[function(t,e,i){"use strict";cc._RF.push(e,"1ea82d5JjZHn5508iS5VKPn","List");var o,s=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),a=this&&this.__decorate||function(t,e,i,o){var s,a=arguments.length,n=a<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(t,e,i,o);else for(var r=t.length-1;r>=0;r--)(s=t[r])&&(n=(a<3?s(n):a>3?s(e,i,n):s(e,i))||n);return a>3&&n&&Object.defineProperty(e,i,n),n};Object.defineProperty(i,"__esModule",{value:!0});var n,r,c,l=cc._decorator,h=l.ccclass,p=l.property,u=l.disallowMultiple,d=l.menu,_=l.executionOrder,m=l.requireComponent,y=t("./ListItem");(function(t){t[t.NODE=1]="NODE",t[t.PREFAB=2]="PREFAB"})(n||(n={})),function(t){t[t.NORMAL=1]="NORMAL",t[t.ADHERING=2]="ADHERING",t[t.PAGE=3]="PAGE"}(r||(r={})),function(t){t[t.NONE=0]="NONE",t[t.SINGLE=1]="SINGLE",t[t.MULT=2]="MULT"}(c||(c={}));var f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.templateType=n.NODE,e.tmpNode=null,e.tmpPrefab=null,e._slideMode=r.NORMAL,e.pageDistance=.3,e.pageChangeEvent=new cc.Component.EventHandler,e._virtual=!0,e.cyclic=!1,e.lackCenter=!1,e.lackSlide=!1,e._updateRate=0,e.frameByFrameRenderNum=0,e.renderEvent=new cc.Component.EventHandler,e.selectedMode=c.NONE,e.repeatEventSingle=!1,e.selectedEvent=new cc.Component.EventHandler,e._selectedId=-1,e._forceUpdate=!1,e._updateDone=!0,e._numItems=0,e._inited=!1,e._needUpdateWidget=!1,e._aniDelRuning=!1,e._doneAfterUpdate=!1,e.adhering=!1,e._adheringBarrier=!1,e.curPageNum=0,e}return s(e,t),Object.defineProperty(e.prototype,"slideMode",{get:function(){return this._slideMode},set:function(t){this._slideMode=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"virtual",{get:function(){return this._virtual},set:function(t){null!=t&&(this._virtual=t),0!=this._numItems&&this._onScrolling()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"updateRate",{get:function(){return this._updateRate},set:function(t){t>=0&&t<=6&&(this._updateRate=t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"selectedId",{get:function(){return this._selectedId},set:function(t){var e,i=this;switch(i.selectedMode){case c.SINGLE:if(!i.repeatEventSingle&&t==i._selectedId)return;e=i.getItemByListId(t);var o=void 0;if(i._selectedId>=0?i._lastSelectedId=i._selectedId:i._lastSelectedId=null,i._selectedId=t,e&&((o=e.getComponent(y.default)).selected=!0),i._lastSelectedId>=0&&i._lastSelectedId!=i._selectedId){var s=i.getItemByListId(i._lastSelectedId);s&&(s.getComponent(y.default).selected=!1)}i.selectedEvent&&cc.Component.EventHandler.emitEvents([i.selectedEvent],e,t%this._actualNumItems,null==i._lastSelectedId?null:i._lastSelectedId%this._actualNumItems);break;case c.MULT:if(!(e=i.getItemByListId(t)))return;o=e.getComponent(y.default),i._selectedId>=0&&(i._lastSelectedId=i._selectedId),i._selectedId=t;var a=!o.selected;o.selected=a;var n=i.multSelected.indexOf(t);a&&n<0?i.multSelected.push(t):!a&&n>=0&&i.multSelected.splice(n,1),i.selectedEvent&&cc.Component.EventHandler.emitEvents([i.selectedEvent],e,t%this._actualNumItems,null==i._lastSelectedId?null:i._lastSelectedId%this._actualNumItems,a)}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"numItems",{get:function(){return this._actualNumItems},set:function(t){var e=this;if(e.checkInited(!1))if(null==t||t<0)cc.error("numItems set the wrong::",t);else if(e._actualNumItems=e._numItems=t,e._forceUpdate=!0,e._virtual)e._resizeContent(),e.cyclic&&(e._numItems=e._cyclicNum*e._numItems),e._onScrolling(),e.frameByFrameRenderNum||e.slideMode!=r.PAGE||(e.curPageNum=e.nearestListId);else{e.cyclic&&(e._resizeContent(),e._numItems=e._cyclicNum*e._numItems);var i=e.content.getComponent(cc.Layout);if(i&&(i.enabled=!0),e._delRedundantItem(),e.firstListId=0,e.frameByFrameRenderNum>0){for(var o=e.frameByFrameRenderNum>e._numItems?e._numItems:e.frameByFrameRenderNum,s=0;s<o;s++)e._createOrUpdateItem2(s);e.frameByFrameRenderNum<e._numItems&&(e._updateCounter=e.frameByFrameRenderNum,e._updateDone=!1)}else{for(s=0;s<e._numItems;s++)e._createOrUpdateItem2(s);e.displayItemNum=e._numItems}}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scrollView",{get:function(){return this._scrollView},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){this._init()},e.prototype.onDestroy=function(){var t=this;cc.isValid(t._itemTmp)&&t._itemTmp.destroy(),cc.isValid(t.tmpNode)&&t.tmpNode.destroy(),t._pool&&t._pool.clear()},e.prototype.onEnable=function(){this._registerEvent(),this._init(),this._aniDelRuning&&(this._aniDelRuning=!1,this._aniDelItem&&(this._aniDelBeforePos&&(this._aniDelItem.position=this._aniDelBeforePos,delete this._aniDelBeforePos),this._aniDelBeforeScale&&(this._aniDelItem.scale=this._aniDelBeforeScale,delete this._aniDelBeforeScale),delete this._aniDelItem),this._aniDelCB&&(this._aniDelCB(),delete this._aniDelCB))},e.prototype.onDisable=function(){this._unregisterEvent()},e.prototype._registerEvent=function(){var t=this;t.node.on(cc.Node.EventType.TOUCH_START,t._onTouchStart,t,!0),t.node.on("touch-up",t._onTouchUp,t),t.node.on(cc.Node.EventType.TOUCH_CANCEL,t._onTouchCancelled,t,!0),t.node.on("scroll-began",t._onScrollBegan,t,!0),t.node.on("scroll-ended",t._onScrollEnded,t,!0),t.node.on("scrolling",t._onScrolling,t,!0),t.node.on(cc.Node.EventType.SIZE_CHANGED,t._onSizeChanged,t)},e.prototype._unregisterEvent=function(){var t=this;t.node.off(cc.Node.EventType.TOUCH_START,t._onTouchStart,t,!0),t.node.off("touch-up",t._onTouchUp,t),t.node.off(cc.Node.EventType.TOUCH_CANCEL,t._onTouchCancelled,t,!0),t.node.off("scroll-began",t._onScrollBegan,t,!0),t.node.off("scroll-ended",t._onScrollEnded,t,!0),t.node.off("scrolling",t._onScrolling,t,!0),t.node.off(cc.Node.EventType.SIZE_CHANGED,t._onSizeChanged,t)},e.prototype._init=function(){var t=this;if(!t._inited)if(t._scrollView=t.node.getComponent(cc.ScrollView),t.content=t._scrollView.content,t.content){switch(t._layout=t.content.getComponent(cc.Layout),t._align=t._layout.type,t._resizeMode=t._layout.resizeMode,t._startAxis=t._layout.startAxis,t._topGap=t._layout.paddingTop,t._rightGap=t._layout.paddingRight,t._bottomGap=t._layout.paddingBottom,t._leftGap=t._layout.paddingLeft,t._columnGap=t._layout.spacingX,t._lineGap=t._layout.spacingY,t._colLineNum,t._verticalDir=t._layout.verticalDirection,t._horizontalDir=t._layout.horizontalDirection,t.setTemplateItem(cc.instantiate(t.templateType==n.PREFAB?t.tmpPrefab:t.tmpNode)),t._slideMode!=r.ADHERING&&t._slideMode!=r.PAGE||(t._scrollView.inertia=!1,t._scrollView._onMouseWheel=function(){}),t.virtual||(t.lackCenter=!1),t._lastDisplayData=[],t.displayData=[],t._pool=new cc.NodePool,t._forceUpdate=!1,t._updateCounter=0,t._updateDone=!0,t.curPageNum=0,t.cyclic&&(t._scrollView._processAutoScrolling=this._processAutoScrolling.bind(t),t._scrollView._startBounceBackIfNeeded=function(){return!1}),t._align){case cc.Layout.Type.HORIZONTAL:switch(t._horizontalDir){case cc.Layout.HorizontalDirection.LEFT_TO_RIGHT:t._alignCalcType=1;break;case cc.Layout.HorizontalDirection.RIGHT_TO_LEFT:t._alignCalcType=2}break;case cc.Layout.Type.VERTICAL:switch(t._verticalDir){case cc.Layout.VerticalDirection.TOP_TO_BOTTOM:t._alignCalcType=3;break;case cc.Layout.VerticalDirection.BOTTOM_TO_TOP:t._alignCalcType=4}break;case cc.Layout.Type.GRID:switch(t._startAxis){case cc.Layout.AxisDirection.HORIZONTAL:switch(t._verticalDir){case cc.Layout.VerticalDirection.TOP_TO_BOTTOM:t._alignCalcType=3;break;case cc.Layout.VerticalDirection.BOTTOM_TO_TOP:t._alignCalcType=4}break;case cc.Layout.AxisDirection.VERTICAL:switch(t._horizontalDir){case cc.Layout.HorizontalDirection.LEFT_TO_RIGHT:t._alignCalcType=1;break;case cc.Layout.HorizontalDirection.RIGHT_TO_LEFT:t._alignCalcType=2}}}t.content.removeAllChildren(),t._inited=!0}else cc.error(t.node.name+"'s cc.ScrollView unset content!")},e.prototype._processAutoScrolling=function(t){this._scrollView._autoScrollAccumulatedTime+=1*t;var e=Math.min(1,this._scrollView._autoScrollAccumulatedTime/this._scrollView._autoScrollTotalTime);if(this._scrollView._autoScrollAttenuate){var i=e-1;e=i*i*i*i*i+1}var o=this._scrollView._autoScrollStartPosition.add(this._scrollView._autoScrollTargetDelta.mul(e)),s=this._scrollView.getScrollEndedEventTiming(),a=Math.abs(e-1)<=s;Math.abs(e-1)<=this._scrollView.getScrollEndedEventTiming()&&!this._scrollView._isScrollEndedWithThresholdEventFired&&(this._scrollView._dispatchEvent("scroll-ended-with-threshold"),this._scrollView._isScrollEndedWithThresholdEventFired=!0),a&&(this._scrollView._autoScrolling=!1);var n=o.sub(this._scrollView.getContentPosition());this._scrollView._moveContent(this._scrollView._clampDelta(n),a),this._scrollView._dispatchEvent("scrolling"),this._scrollView._autoScrolling||(this._scrollView._isBouncing=!1,this._scrollView._scrolling=!1,this._scrollView._dispatchEvent("scroll-ended"))},e.prototype.setTemplateItem=function(t){if(t){var e=this;e._itemTmp=t,e._resizeMode==cc.Layout.ResizeMode.CHILDREN?e._itemSize=e._layout.cellSize:e._itemSize=cc.size(t.width,t.height);var i=t.getComponent(y.default),o=!1;switch(i||(o=!0),o&&(e.selectedMode=c.NONE),(i=t.getComponent(cc.Widget))&&i.enabled&&(e._needUpdateWidget=!0),e.selectedMode==c.MULT&&(e.multSelected=[]),e._align){case cc.Layout.Type.HORIZONTAL:e._colLineNum=1,e._sizeType=!1;break;case cc.Layout.Type.VERTICAL:e._colLineNum=1,e._sizeType=!0;break;case cc.Layout.Type.GRID:switch(e._startAxis){case cc.Layout.AxisDirection.HORIZONTAL:var s=e.content.width-e._leftGap-e._rightGap;e._colLineNum=Math.floor((s+e._columnGap)/(e._itemSize.width+e._columnGap)),e._sizeType=!0;break;case cc.Layout.AxisDirection.VERTICAL:var a=e.content.height-e._topGap-e._bottomGap;e._colLineNum=Math.floor((a+e._lineGap)/(e._itemSize.height+e._lineGap)),e._sizeType=!1}}}},e.prototype.checkInited=function(t){return void 0===t&&(t=!0),!!this._inited||(t&&cc.error("List initialization not completed!"),!1)},e.prototype._resizeContent=function(){var t,e=this;switch(e._align){case cc.Layout.Type.HORIZONTAL:if(e._customSize){var i=e._getFixedSize(null);t=e._leftGap+i.val+e._itemSize.width*(e._numItems-i.count)+e._columnGap*(e._numItems-1)+e._rightGap}else t=e._leftGap+e._itemSize.width*e._numItems+e._columnGap*(e._numItems-1)+e._rightGap;break;case cc.Layout.Type.VERTICAL:e._customSize?(i=e._getFixedSize(null),t=e._topGap+i.val+e._itemSize.height*(e._numItems-i.count)+e._lineGap*(e._numItems-1)+e._bottomGap):t=e._topGap+e._itemSize.height*e._numItems+e._lineGap*(e._numItems-1)+e._bottomGap;break;case cc.Layout.Type.GRID:switch(e.lackCenter&&(e.lackCenter=!1),e._startAxis){case cc.Layout.AxisDirection.HORIZONTAL:var o=Math.ceil(e._numItems/e._colLineNum);t=e._topGap+e._itemSize.height*o+e._lineGap*(o-1)+e._bottomGap;break;case cc.Layout.AxisDirection.VERTICAL:var s=Math.ceil(e._numItems/e._colLineNum);t=e._leftGap+e._itemSize.width*s+e._columnGap*(s-1)+e._rightGap}}var a=e.content.getComponent(cc.Layout);if(a&&(a.enabled=!1),e._allItemSize=t,e._allItemSizeNoEdge=e._allItemSize-(e._sizeType?e._topGap+e._bottomGap:e._leftGap+e._rightGap),e.cyclic){var n=e._sizeType?e.node.height:e.node.width;e._cyclicPos1=0,n-=e._cyclicPos1,e._cyclicNum=Math.ceil(n/e._allItemSizeNoEdge)+1;var r=e._sizeType?e._lineGap:e._columnGap;e._cyclicPos2=e._cyclicPos1+e._allItemSizeNoEdge+r,e._cyclicAllItemSize=e._allItemSize+e._allItemSizeNoEdge*(e._cyclicNum-1)+r*(e._cyclicNum-1),e._cycilcAllItemSizeNoEdge=e._allItemSizeNoEdge*e._cyclicNum,e._cycilcAllItemSizeNoEdge+=r*(e._cyclicNum-1)}e._lack=!e.cyclic&&e._allItemSize<(e._sizeType?e.node.height:e.node.width);var c=e._lack&&e.lackCenter||!e.lackSlide?.1:0,l=e._lack?(e._sizeType?e.node.height:e.node.width)-c:e.cyclic?e._cyclicAllItemSize:e._allItemSize;l<0&&(l=0),e._sizeType?e.content.height=l:e.content.width=l},e.prototype._onScrolling=function(t){if(void 0===t&&(t=null),null==this.frameCount&&(this.frameCount=this._updateRate),!this._forceUpdate&&t&&"scroll-ended"!=t.type&&this.frameCount>0)this.frameCount--;else if(this.frameCount=this._updateRate,!this._aniDelRuning){if(this.cyclic){var e=this.content.getPosition();e=this._sizeType?e.y:e.x;var i=this._allItemSizeNoEdge+(this._sizeType?this._lineGap:this._columnGap),o=this._sizeType?cc.v2(0,i):cc.v2(i,0);switch(this._alignCalcType){case 1:e>-this._cyclicPos1?(this.content.x=-this._cyclicPos2,this._scrollView.isAutoScrolling()&&(this._scrollView._autoScrollStartPosition=this._scrollView._autoScrollStartPosition.sub(o))):e<-this._cyclicPos2&&(this.content.x=-this._cyclicPos1,this._scrollView.isAutoScrolling()&&(this._scrollView._autoScrollStartPosition=this._scrollView._autoScrollStartPosition.add(o)));break;case 2:e<this._cyclicPos1?(this.content.x=this._cyclicPos2,this._scrollView.isAutoScrolling()&&(this._scrollView._autoScrollStartPosition=this._scrollView._autoScrollStartPosition.add(o))):e>this._cyclicPos2&&(this.content.x=this._cyclicPos1,this._scrollView.isAutoScrolling()&&(this._scrollView._autoScrollStartPosition=this._scrollView._autoScrollStartPosition.sub(o)));break;case 3:e<this._cyclicPos1?(this.content.y=this._cyclicPos2,this._scrollView.isAutoScrolling()&&(this._scrollView._autoScrollStartPosition=this._scrollView._autoScrollStartPosition.add(o))):e>this._cyclicPos2&&(this.content.y=this._cyclicPos1,this._scrollView.isAutoScrolling()&&(this._scrollView._autoScrollStartPosition=this._scrollView._autoScrollStartPosition.sub(o)));break;case 4:e>-this._cyclicPos1?(this.content.y=-this._cyclicPos2,this._scrollView.isAutoScrolling()&&(this._scrollView._autoScrollStartPosition=this._scrollView._autoScrollStartPosition.sub(o))):e<-this._cyclicPos2&&(this.content.y=-this._cyclicPos1,this._scrollView.isAutoScrolling()&&(this._scrollView._autoScrollStartPosition=this._scrollView._autoScrollStartPosition.add(o)))}}var s,a,n,r;if(this._calcViewPos(),this._sizeType?(s=this.viewTop,n=this.viewBottom):(a=this.viewRight,r=this.viewLeft),this._virtual){this.displayData=[];var c=void 0,l=0,h=this._numItems-1;if(this._customSize)for(var p=!1;l<=h&&!p;l++)switch(c=this._calcItemPos(l),this._align){case cc.Layout.Type.HORIZONTAL:c.right>=r&&c.left<=a?this.displayData.push(c):0!=l&&this.displayData.length>0&&(p=!0);break;case cc.Layout.Type.VERTICAL:c.bottom<=s&&c.top>=n?this.displayData.push(c):0!=l&&this.displayData.length>0&&(p=!0);break;case cc.Layout.Type.GRID:switch(this._startAxis){case cc.Layout.AxisDirection.HORIZONTAL:c.bottom<=s&&c.top>=n?this.displayData.push(c):0!=l&&this.displayData.length>0&&(p=!0);break;case cc.Layout.AxisDirection.VERTICAL:c.right>=r&&c.left<=a?this.displayData.push(c):0!=l&&this.displayData.length>0&&(p=!0)}}else{var u=this._itemSize.width+this._columnGap,d=this._itemSize.height+this._lineGap;switch(this._alignCalcType){case 1:l=(r-this._leftGap)/u,h=(a-this._leftGap)/u;break;case 2:l=(-a-this._rightGap)/u,h=(-r-this._rightGap)/u;break;case 3:l=(-s-this._topGap)/d,h=(-n-this._topGap)/d;break;case 4:l=(n-this._bottomGap)/d,h=(s-this._bottomGap)/d}for(l=Math.floor(l)*this._colLineNum,h=Math.ceil(h)*this._colLineNum,l<0&&(l=0),--h>=this._numItems&&(h=this._numItems-1);l<=h;l++)this.displayData.push(this._calcItemPos(l))}if(this._delRedundantItem(),this.displayData.length<=0||!this._numItems)return void(this._lastDisplayData=[]);this.firstListId=this.displayData[0].id,this.displayItemNum=this.displayData.length;var _=this._lastDisplayData.length,m=this.displayItemNum!=_;if(m&&(this.frameByFrameRenderNum>0&&this._lastDisplayData.sort(function(t,e){return t-e}),m=this.firstListId!=this._lastDisplayData[0]||this.displayData[this.displayItemNum-1].id!=this._lastDisplayData[_-1]),this._forceUpdate||m)if(this.frameByFrameRenderNum>0)this._numItems>0?(this._updateDone?this._updateCounter=0:this._doneAfterUpdate=!0,this._updateDone=!1):(this._updateCounter=0,this._updateDone=!0);else{this._lastDisplayData=[];for(var y=0;y<this.displayItemNum;y++)this._createOrUpdateItem(this.displayData[y]);this._forceUpdate=!1}this._calcNearestItem()}}},e.prototype._calcViewPos=function(){var t=this.content.getPosition();switch(this._alignCalcType){case 1:this.elasticLeft=t.x>0?t.x:0,this.viewLeft=(t.x<0?-t.x:0)-this.elasticLeft,this.viewRight=this.viewLeft+this.node.width,this.elasticRight=this.viewRight>this.content.width?Math.abs(this.viewRight-this.content.width):0,this.viewRight+=this.elasticRight;break;case 2:this.elasticRight=t.x<0?-t.x:0,this.viewRight=(t.x>0?-t.x:0)+this.elasticRight,this.viewLeft=this.viewRight-this.node.width,this.elasticLeft=this.viewLeft<-this.content.width?Math.abs(this.viewLeft+this.content.width):0,this.viewLeft-=this.elasticLeft;break;case 3:this.elasticTop=t.y<0?Math.abs(t.y):0,this.viewTop=(t.y>0?-t.y:0)+this.elasticTop,this.viewBottom=this.viewTop-this.node.height,this.elasticBottom=this.viewBottom<-this.content.height?Math.abs(this.viewBottom+this.content.height):0,this.viewBottom+=this.elasticBottom;break;case 4:this.elasticBottom=t.y>0?Math.abs(t.y):0,this.viewBottom=(t.y<0?-t.y:0)-this.elasticBottom,this.viewTop=this.viewBottom+this.node.height,this.elasticTop=this.viewTop>this.content.height?Math.abs(this.viewTop-this.content.height):0,this.viewTop-=this.elasticTop}},e.prototype._calcItemPos=function(t){var e,i,o,s,a,n,r,c;switch(this._align){case cc.Layout.Type.HORIZONTAL:switch(this._horizontalDir){case cc.Layout.HorizontalDirection.LEFT_TO_RIGHT:if(this._customSize){var l=this._getFixedSize(t);a=this._leftGap+(this._itemSize.width+this._columnGap)*(t-l.count)+(l.val+this._columnGap*l.count),e=(h=this._customSize[t])>0?h:this._itemSize.width}else a=this._leftGap+(this._itemSize.width+this._columnGap)*t,e=this._itemSize.width;return this.lackCenter&&(a-=this._leftGap,a+=this.content.width/2-this._allItemSizeNoEdge/2),{id:t,left:a,right:n=a+e,x:a+this._itemTmp.anchorX*e,y:this._itemTmp.y};case cc.Layout.HorizontalDirection.RIGHT_TO_LEFT:return this._customSize?(l=this._getFixedSize(t),n=-this._rightGap-(this._itemSize.width+this._columnGap)*(t-l.count)-(l.val+this._columnGap*l.count),e=(h=this._customSize[t])>0?h:this._itemSize.width):(n=-this._rightGap-(this._itemSize.width+this._columnGap)*t,e=this._itemSize.width),this.lackCenter&&(n+=this._rightGap,n-=this.content.width/2-this._allItemSizeNoEdge/2),{id:t,right:n,left:a=n-e,x:a+this._itemTmp.anchorX*e,y:this._itemTmp.y}}break;case cc.Layout.Type.VERTICAL:switch(this._verticalDir){case cc.Layout.VerticalDirection.TOP_TO_BOTTOM:return this._customSize?(l=this._getFixedSize(t),o=-this._topGap-(this._itemSize.height+this._lineGap)*(t-l.count)-(l.val+this._lineGap*l.count),i=(h=this._customSize[t])>0?h:this._itemSize.height):(o=-this._topGap-(this._itemSize.height+this._lineGap)*t,i=this._itemSize.height),this.lackCenter&&(o+=this._topGap,o-=this.content.height/2-this._allItemSizeNoEdge/2),{id:t,top:o,bottom:s=o-i,x:this._itemTmp.x,y:s+this._itemTmp.anchorY*i};case cc.Layout.VerticalDirection.BOTTOM_TO_TOP:var h;if(this._customSize)l=this._getFixedSize(t),s=this._bottomGap+(this._itemSize.height+this._lineGap)*(t-l.count)+(l.val+this._lineGap*l.count),i=(h=this._customSize[t])>0?h:this._itemSize.height;else s=this._bottomGap+(this._itemSize.height+this._lineGap)*t,i=this._itemSize.height;return this.lackCenter&&(s-=this._bottomGap,s+=this.content.height/2-this._allItemSizeNoEdge/2),{id:t,top:o=s+i,bottom:s,x:this._itemTmp.x,y:s+this._itemTmp.anchorY*i}}case cc.Layout.Type.GRID:var p=Math.floor(t/this._colLineNum);switch(this._startAxis){case cc.Layout.AxisDirection.HORIZONTAL:switch(this._verticalDir){case cc.Layout.VerticalDirection.TOP_TO_BOTTOM:c=(s=(o=-this._topGap-(this._itemSize.height+this._lineGap)*p)-this._itemSize.height)+this._itemTmp.anchorY*this._itemSize.height;break;case cc.Layout.VerticalDirection.BOTTOM_TO_TOP:o=(s=this._bottomGap+(this._itemSize.height+this._lineGap)*p)+this._itemSize.height,c=s+this._itemTmp.anchorY*this._itemSize.height}switch(r=this._leftGap+t%this._colLineNum*(this._itemSize.width+this._columnGap),this._horizontalDir){case cc.Layout.HorizontalDirection.LEFT_TO_RIGHT:r+=this._itemTmp.anchorX*this._itemSize.width,r-=this.content.anchorX*this.content.width;break;case cc.Layout.HorizontalDirection.RIGHT_TO_LEFT:r+=(1-this._itemTmp.anchorX)*this._itemSize.width,r-=(1-this.content.anchorX)*this.content.width,r*=-1}return{id:t,top:o,bottom:s,x:r,y:c};case cc.Layout.AxisDirection.VERTICAL:switch(this._horizontalDir){case cc.Layout.HorizontalDirection.LEFT_TO_RIGHT:n=(a=this._leftGap+(this._itemSize.width+this._columnGap)*p)+this._itemSize.width,r=a+this._itemTmp.anchorX*this._itemSize.width,r-=this.content.anchorX*this.content.width;break;case cc.Layout.HorizontalDirection.RIGHT_TO_LEFT:r=(a=(n=-this._rightGap-(this._itemSize.width+this._columnGap)*p)-this._itemSize.width)+this._itemTmp.anchorX*this._itemSize.width,r+=(1-this.content.anchorX)*this.content.width}switch(c=-this._topGap-t%this._colLineNum*(this._itemSize.height+this._lineGap),this._verticalDir){case cc.Layout.VerticalDirection.TOP_TO_BOTTOM:c-=(1-this._itemTmp.anchorY)*this._itemSize.height,c+=(1-this.content.anchorY)*this.content.height;break;case cc.Layout.VerticalDirection.BOTTOM_TO_TOP:c-=this._itemTmp.anchorY*this._itemSize.height,c+=this.content.anchorY*this.content.height,c*=-1}return{id:t,left:a,right:n,x:r,y:c}}}},e.prototype._calcExistItemPos=function(t){var e=this.getItemByListId(t);if(!e)return null;var i={id:t,x:e.x,y:e.y};return this._sizeType?(i.top=e.y+e.height*(1-e.anchorY),i.bottom=e.y-e.height*e.anchorY):(i.left=e.x-e.width*e.anchorX,i.right=e.x+e.width*(1-e.anchorX)),i},e.prototype.getItemPos=function(t){return this._virtual?this._calcItemPos(t):this.frameByFrameRenderNum?this._calcItemPos(t):this._calcExistItemPos(t)},e.prototype._getFixedSize=function(t){if(!this._customSize)return null;null==t&&(t=this._numItems);var e=0,i=0;for(var o in this._customSize)parseInt(o)<t&&(e+=this._customSize[o],i++);return{val:e,count:i}},e.prototype._onScrollBegan=function(){this._beganPos=this._sizeType?this.viewTop:this.viewLeft},e.prototype._onScrollEnded=function(){var t=this;if(t.curScrollIsTouch=!1,null!=t.scrollToListId){var e=t.getItemByListId(t.scrollToListId);t.scrollToListId=null,e&&cc.tween(e).to(.1,{scale:1.06}).to(.1,{scale:1}).start()}t._onScrolling(),t._slideMode!=r.ADHERING||t.adhering?t._slideMode==r.PAGE&&(null!=t._beganPos&&t.curScrollIsTouch?this._pageAdhere():t.adhere()):t.adhere()},e.prototype._onTouchStart=function(t,e){if(!this._scrollView.hasNestedViewGroup(t,e)&&(this.curScrollIsTouch=!0,t.eventPhase!==cc.Event.AT_TARGET||t.target!==this.node)){for(var i=t.target;null==i._listId&&i.parent;)i=i.parent;this._scrollItem=null!=i._listId?i:t.target}},e.prototype._onTouchUp=function(){var t=this;t._scrollPos=null,t._slideMode==r.ADHERING?(this.adhering&&(this._adheringBarrier=!0),t.adhere()):t._slideMode==r.PAGE&&(null!=t._beganPos?this._pageAdhere():t.adhere()),this._scrollItem=null},e.prototype._onTouchCancelled=function(t,e){var i=this;i._scrollView.hasNestedViewGroup(t,e)||t.simulate||(i._scrollPos=null,i._slideMode==r.ADHERING?(i.adhering&&(i._adheringBarrier=!0),i.adhere()):i._slideMode==r.PAGE&&(null!=i._beganPos?i._pageAdhere():i.adhere()),this._scrollItem=null)},e.prototype._onSizeChanged=function(){this.checkInited(!1)&&this._onScrolling()},e.prototype._onItemAdaptive=function(t){if(!this._sizeType&&t.width!=this._itemSize.width||this._sizeType&&t.height!=this._itemSize.height){this._customSize||(this._customSize={});var e=this._sizeType?t.height:t.width;this._customSize[t._listId]!=e&&(this._customSize[t._listId]=e,this._resizeContent(),this.updateAll(),null!=this._scrollToListId&&(this._scrollPos=null,this.unschedule(this._scrollToSo),this.scrollTo(this._scrollToListId,Math.max(0,this._scrollToEndTime-(new Date).getTime()/1e3))))}},e.prototype._pageAdhere=function(){var t=this;if(t.cyclic||!(t.elasticTop>0||t.elasticRight>0||t.elasticBottom>0||t.elasticLeft>0)){var e=t._sizeType?t.viewTop:t.viewLeft,i=(t._sizeType?t.node.height:t.node.width)*t.pageDistance;if(Math.abs(t._beganPos-e)>i)switch(t._alignCalcType){case 1:case 4:t._beganPos>e?t.prePage(.5):t.nextPage(.5);break;case 2:case 3:t._beganPos<e?t.prePage(.5):t.nextPage(.5)}else t.elasticTop<=0&&t.elasticRight<=0&&t.elasticBottom<=0&&t.elasticLeft<=0&&t.adhere();t._beganPos=null}},e.prototype.adhere=function(){var t=this;if(t.checkInited()&&!(t.elasticTop>0||t.elasticRight>0||t.elasticBottom>0||t.elasticLeft>0)){t.adhering=!0,t._calcNearestItem();var e=(t._sizeType?t._topGap:t._leftGap)/(t._sizeType?t.node.height:t.node.width);t.scrollTo(t.nearestListId,.7,e)}},e.prototype.update=function(){if(!(this.frameByFrameRenderNum<=0||this._updateDone))if(this._virtual){for(var t=this._updateCounter+this.frameByFrameRenderNum>this.displayItemNum?this.displayItemNum:this._updateCounter+this.frameByFrameRenderNum,e=this._updateCounter;e<t;e++){var i=this.displayData[e];i&&this._createOrUpdateItem(i)}this._updateCounter>=this.displayItemNum-1?this._doneAfterUpdate?(this._updateCounter=0,this._updateDone=!1,this._doneAfterUpdate=!1):(this._updateDone=!0,this._delRedundantItem(),this._forceUpdate=!1,this._calcNearestItem(),this.slideMode==r.PAGE&&(this.curPageNum=this.nearestListId)):this._updateCounter+=this.frameByFrameRenderNum}else if(this._updateCounter<this._numItems){for(t=this._updateCounter+this.frameByFrameRenderNum>this._numItems?this._numItems:this._updateCounter+this.frameByFrameRenderNum,e=this._updateCounter;e<t;e++)this._createOrUpdateItem2(e);this._updateCounter+=this.frameByFrameRenderNum}else this._updateDone=!0,this._calcNearestItem(),this.slideMode==r.PAGE&&(this.curPageNum=this.nearestListId)},e.prototype._createOrUpdateItem=function(t){var e=this.getItemByListId(t.id);if(e)this._forceUpdate&&this.renderEvent&&(e.setPosition(cc.v2(t.x,t.y)),this._resetItemSize(e),this.renderEvent&&cc.Component.EventHandler.emitEvents([this.renderEvent],e,t.id%this._actualNumItems));else{var i=this._pool.size()>0;if(e=i?this._pool.get():cc.instantiate(this._itemTmp),i&&cc.isValid(e)||(e=cc.instantiate(this._itemTmp),i=!1),e._listId!=t.id&&(e._listId=t.id,e.setContentSize(this._itemSize)),e.setPosition(cc.v2(t.x,t.y)),this._resetItemSize(e),this.content.addChild(e),i&&this._needUpdateWidget){var o=e.getComponent(cc.Widget);o&&o.updateAlignment()}e.setSiblingIndex(this.content.childrenCount-1);var s=e.getComponent(y.default);e.listItem=s,s&&(s.listId=t.id,s.list=this,s._registerEvent()),this.renderEvent&&cc.Component.EventHandler.emitEvents([this.renderEvent],e,t.id%this._actualNumItems)}this._resetItemSize(e),this._updateListItem(e.listItem),this._lastDisplayData.indexOf(t.id)<0&&this._lastDisplayData.push(t.id)},e.prototype._createOrUpdateItem2=function(t){var e,i=this.content.children[t];i?this._forceUpdate&&this.renderEvent&&(i._listId=t,e&&(e.listId=t),this.renderEvent&&cc.Component.EventHandler.emitEvents([this.renderEvent],i,t%this._actualNumItems)):((i=cc.instantiate(this._itemTmp))._listId=t,this.content.addChild(i),e=i.getComponent(y.default),i.listItem=e,e&&(e.listId=t,e.list=this,e._registerEvent()),this.renderEvent&&cc.Component.EventHandler.emitEvents([this.renderEvent],i,t%this._actualNumItems)),this._updateListItem(e),this._lastDisplayData.indexOf(t)<0&&this._lastDisplayData.push(t)},e.prototype._updateListItem=function(t){if(t&&this.selectedMode>c.NONE){var e=t.node;switch(this.selectedMode){case c.SINGLE:t.selected=this.selectedId==e._listId;break;case c.MULT:t.selected=this.multSelected.indexOf(e._listId)>=0}}},e.prototype._resetItemSize=function(){},e.prototype._updateItemPos=function(t){var e=isNaN(t)?t:this.getItemByListId(t),i=this.getItemPos(e._listId);e.setPosition(i.x,i.y)},e.prototype.setMultSelected=function(t,e){var i=this;if(i.checkInited()){if(Array.isArray(t)||(t=[t]),null==e)i.multSelected=t;else{var o=void 0,s=void 0;if(e)for(var a=t.length-1;a>=0;a--)o=t[a],(s=i.multSelected.indexOf(o))<0&&i.multSelected.push(o);else for(a=t.length-1;a>=0;a--)o=t[a],(s=i.multSelected.indexOf(o))>=0&&i.multSelected.splice(s,1)}i._forceUpdate=!0,i._onScrolling()}},e.prototype.getMultSelected=function(){return this.multSelected},e.prototype.hasMultSelected=function(t){return this.multSelected&&this.multSelected.indexOf(t)>=0},e.prototype.updateItem=function(t){if(this.checkInited()){Array.isArray(t)||(t=[t]);for(var e=0,i=t.length;e<i;e++){var o=t[e],s=this.getItemByListId(o);s&&cc.Component.EventHandler.emitEvents([this.renderEvent],s,o%this._actualNumItems)}}},e.prototype.updateAll=function(){this.checkInited()&&(this.numItems=this.numItems)},e.prototype.getItemByListId=function(t){if(this.content)for(var e=this.content.childrenCount-1;e>=0;e--){var i=this.content.children[e];if(i._listId==t)return i}},e.prototype._getOutsideItem=function(){for(var t,e=[],i=this.content.childrenCount-1;i>=0;i--)t=this.content.children[i],this.displayData.find(function(e){return e.id==t._listId})||e.push(t);return e},e.prototype._delRedundantItem=function(){if(this._virtual)for(var t=this._getOutsideItem(),e=t.length-1;e>=0;e--){var i=t[e];if(!this._scrollItem||i._listId!=this._scrollItem._listId){i.isCached=!0,this._pool.put(i);for(var o=this._lastDisplayData.length-1;o>=0;o--)if(this._lastDisplayData[o]==i._listId){this._lastDisplayData.splice(o,1);break}}}else for(;this.content.childrenCount>this._numItems;)this._delSingleItem(this.content.children[this.content.childrenCount-1])},e.prototype._delSingleItem=function(t){t.removeFromParent(),t.destroy&&t.destroy(),t=null},e.prototype.aniDelItem=function(t,e,i){var o=this;if(!o.checkInited()||o.cyclic||!o._virtual)return cc.error("This function is not allowed to be called!");if(!e)return cc.error("CallFunc are not allowed to be NULL, You need to delete the corresponding index in the data array in the CallFunc!");if(o._aniDelRuning)return cc.warn("Please wait for the current deletion to finish!");var s,a=o.getItemByListId(t);if(a){s=a.getComponent(y.default),o._aniDelRuning=!0,o._aniDelCB=e,o._aniDelItem=a,o._aniDelBeforePos=a.position,o._aniDelBeforeScale=a.scale;var n=o.displayData[o.displayData.length-1].id,r=s.selected;s.showAni(i,function(){var i,s,l;if(n<o._numItems-2&&(i=n+1),null!=i){var h=o._calcItemPos(i);o.displayData.push(h),o._virtual?o._createOrUpdateItem(h):o._createOrUpdateItem2(i)}else o._numItems--;if(o.selectedMode==c.SINGLE)r?o._selectedId=-1:o._selectedId-1>=0&&o._selectedId--;else if(o.selectedMode==c.MULT&&o.multSelected.length){var p=o.multSelected.indexOf(t);p>=0&&o.multSelected.splice(p,1);for(var u=o.multSelected.length-1;u>=0;u--)(m=o.multSelected[u])>=t&&o.multSelected[u]--}if(o._customSize){o._customSize[t]&&delete o._customSize[t];var d={},_=void 0;for(var m in o._customSize){_=o._customSize[m];var y=parseInt(m);d[y-(y>=t?1:0)]=_}o._customSize=d}for(u=null!=i?i:n;u>=t+1;u--)if(a=o.getItemByListId(u)){var f=o._calcItemPos(u-1);s=cc.tween(a).to(.2333,{position:cc.v2(f.x,f.y)}),u<=t+1&&(l=!0,s.call(function(){o._aniDelRuning=!1,e(t),delete o._aniDelCB})),s.start()}l||(o._aniDelRuning=!1,e(t),o._aniDelCB=null)},!0)}else e(t)},e.prototype.scrollTo=function(t,e,i,o){void 0===e&&(e=.5),void 0===i&&(i=null),void 0===o&&(o=!1);var s=this;if(s.checkInited(!1)){null==e?e=.5:e<0&&(e=0),t<0?t=0:t>=s._numItems&&(t=s._numItems-1),!s._virtual&&s._layout&&s._layout.enabled&&s._layout.updateLayout();var a,n,r=s.getItemPos(t);if(!r)return!1;switch(s._alignCalcType){case 1:a=r.left,a-=null!=i?s.node.width*i:s._leftGap,r=cc.v2(a,0);break;case 2:a=r.right-s.node.width,a+=null!=i?s.node.width*i:s._rightGap,r=cc.v2(a+s.content.width,0);break;case 3:n=r.top,n+=null!=i?s.node.height*i:s._topGap,r=cc.v2(0,-n);break;case 4:n=r.bottom+s.node.height,n-=null!=i?s.node.height*i:s._bottomGap,r=cc.v2(0,-n+s.content.height)}var c=s.content.getPosition();c=Math.abs(s._sizeType?c.y:c.x);var l=s._sizeType?r.y:r.x;Math.abs((null!=s._scrollPos?s._scrollPos:c)-l)>.5&&(s._scrollView.scrollToOffset(r,e),s._scrollToListId=t,s._scrollToEndTime=(new Date).getTime()/1e3+e,s._scrollToSo=s.scheduleOnce(function(){if(s._adheringBarrier||(s.adhering=s._adheringBarrier=!1),s._scrollPos=s._scrollToListId=s._scrollToEndTime=s._scrollToSo=null,o){var e=s.getItemByListId(t);e&&cc.tween(e).to(.1,{scale:1.05}).to(.1,{scale:1}).start()}},e+.1),e<=0&&s._onScrolling())}},e.prototype._calcNearestItem=function(){var t,e,i,o,s,a,n=this;n.nearestListId=null,n._virtual&&n._calcViewPos(),i=n.viewTop,o=n.viewRight,s=n.viewBottom,a=n.viewLeft;for(var r=!1,c=0;c<n.content.childrenCount&&!r;c+=n._colLineNum)if(t=n._virtual?n.displayData[c]:n._calcExistItemPos(c))switch(e=n._sizeType?(t.top+t.bottom)/2:e=(t.left+t.right)/2,n._alignCalcType){case 1:t.right>=a&&(n.nearestListId=t.id,a>e&&(n.nearestListId+=n._colLineNum),r=!0);break;case 2:t.left<=o&&(n.nearestListId=t.id,o<e&&(n.nearestListId+=n._colLineNum),r=!0);break;case 3:t.bottom<=i&&(n.nearestListId=t.id,i<e&&(n.nearestListId+=n._colLineNum),r=!0);break;case 4:t.top>=s&&(n.nearestListId=t.id,s>e&&(n.nearestListId+=n._colLineNum),r=!0)}if((t=n._virtual?n.displayData[n.displayItemNum-1]:n._calcExistItemPos(n._numItems-1))&&t.id==n._numItems-1)switch(e=n._sizeType?(t.top+t.bottom)/2:e=(t.left+t.right)/2,n._alignCalcType){case 1:o>e&&(n.nearestListId=t.id);break;case 2:a<e&&(n.nearestListId=t.id);break;case 3:s<e&&(n.nearestListId=t.id);break;case 4:i>e&&(n.nearestListId=t.id)}},e.prototype.prePage=function(t){void 0===t&&(t=.5),this.checkInited()&&this.skipPage(this.curPageNum-1,t)},e.prototype.nextPage=function(t){void 0===t&&(t=.5),this.checkInited()&&this.skipPage(this.curPageNum+1,t)},e.prototype.skipPage=function(t,e){var i=this;if(i.checkInited())return i._slideMode!=r.PAGE?cc.error("This function is not allowed to be called, Must SlideMode = PAGE!"):void(t<0||t>=i._numItems||i.curPageNum!=t&&(i.curPageNum=t,i.pageChangeEvent&&cc.Component.EventHandler.emitEvents([i.pageChangeEvent],t),i.scrollTo(t,e)))},e.prototype.calcCustomSize=function(t){var e=this;if(e.checkInited()){if(!e._itemTmp)return cc.error("Unset template item!");if(!e.renderEvent)return cc.error("Unset Render-Event!");e._customSize={};var i=cc.instantiate(e._itemTmp);e.content.addChild(i);for(var o=0;o<t;o++)cc.Component.EventHandler.emitEvents([e.renderEvent],i,o),i.height==e._itemSize.height&&i.width==e._itemSize.width||(e._customSize[o]=e._sizeType?i.height:i.width);return Object.keys(e._customSize).length||(e._customSize=null),i.removeFromParent(),i.destroy&&i.destroy(),e._customSize}},a([p({type:cc.Enum(n),tooltip:!1})],e.prototype,"templateType",void 0),a([p({type:cc.Node,tooltip:!1,visible:function(){return this.templateType==n.NODE}})],e.prototype,"tmpNode",void 0),a([p({type:cc.Prefab,tooltip:!1,visible:function(){return this.templateType==n.PREFAB}})],e.prototype,"tmpPrefab",void 0),a([p()],e.prototype,"_slideMode",void 0),a([p({type:cc.Enum(r),tooltip:!1})],e.prototype,"slideMode",null),a([p({type:cc.Float,range:[0,1,.1],tooltip:!1,slide:!0,visible:function(){return this._slideMode==r.PAGE}})],e.prototype,"pageDistance",void 0),a([p({type:cc.Component.EventHandler,tooltip:!1,visible:function(){return this._slideMode==r.PAGE}})],e.prototype,"pageChangeEvent",void 0),a([p()],e.prototype,"_virtual",void 0),a([p({type:cc.Boolean,tooltip:!1})],e.prototype,"virtual",null),a([p({tooltip:!1,visible:function(){var t=this.slideMode==r.NORMAL;return t||(this.cyclic=!1),t}})],e.prototype,"cyclic",void 0),a([p({tooltip:!1,visible:function(){return this.virtual}})],e.prototype,"lackCenter",void 0),a([p({tooltip:!1,visible:function(){var t=this.virtual&&!this.lackCenter;return t||(this.lackSlide=!1),t}})],e.prototype,"lackSlide",void 0),a([p({type:cc.Integer})],e.prototype,"_updateRate",void 0),a([p({type:cc.Integer,range:[0,6,1],tooltip:!1,slide:!0})],e.prototype,"updateRate",null),a([p({type:cc.Integer,range:[0,12,1],tooltip:!1,slide:!0})],e.prototype,"frameByFrameRenderNum",void 0),a([p({type:cc.Component.EventHandler,tooltip:!1})],e.prototype,"renderEvent",void 0),a([p({type:cc.Enum(c),tooltip:!1})],e.prototype,"selectedMode",void 0),a([p({tooltip:!1,visible:function(){return this.selectedMode==c.SINGLE}})],e.prototype,"repeatEventSingle",void 0),a([p({type:cc.Component.EventHandler,tooltip:!1,visible:function(){return this.selectedMode>c.NONE}})],e.prototype,"selectedEvent",void 0),a([p({serializable:!1})],e.prototype,"_numItems",void 0),a([h,u(),d("\u81ea\u5b9a\u4e49\u7ec4\u4ef6/List"),m(cc.ScrollView),_(-5e3)],e)}(cc.Component);i.default=f,cc._RF.pop()},{"./ListItem":"ListItem"}],main:[function(require,module,exports){"use strict";cc._RF.push(module,"db7f3UTw4xJQp71kREj4D1F","main");var __extends=this&&this.__extends||(extendStatics=function(t,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),extendStatics,__decorate=this&&this.__decorate||function(t,e,i,o){var s,a=arguments.length,n=a<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(t,e,i,o);else for(var r=t.length-1;r>=0;r--)(s=t[r])&&(n=(a<3?s(n):a>3?s(e,i,n):s(e,i))||n);return a>3&&n&&Object.defineProperty(e,i,n),n};Object.defineProperty(exports,"__esModule",{value:!0});var List_1=require("./List"),_a=cc._decorator,ccclass=_a.ccclass,property=_a.property,IntVec2=function(t,e){this.x=0,this.y=0,this.x=t,this.y=e},NumberCube=function(){function t(){this.row=0,this.col=0,this.num=0}return t.prototype.getRowCol=function(){return new IntVec2(this.row,this.col)},t}(),deepArray=function(t){return t.map(deepClone)},deepObject=function(t){var e=Object.keys(t),i={};return e.forEach(function(e){i[e]=deepClone(t[e])}),i},deepClone=function(t){if(null===t||!t)return t;if("[object Object]"===Object.prototype.toString.call(t)){var e={};return Object.keys(t).forEach(function(i){t[i]&&"object"==typeof t[i]?e[i]=deepClone(t[i]):e[i]=t[i]}),e}if(Array.isArray(t)){var i=[];return t.forEach(function(t,e){i[e]=t&&"object"==typeof t?deepClone(t):t}),i}},CubeData=function(){this.leftNum_1=0,this.leftNum_2=0,this.prcessCubes_1=[],this.prcessCubes_2=[]},NewClass=function(_super){function NewClass(){var t=null!==_super&&_super.apply(this,arguments)||this;return t.mapBg=null,t.inputNumber=null,t.inputCount=null,t.inputLink=null,t.inputAdd=null,t.btnDone=null,t.btnCopy=null,t.cubeNode=null,t.mTipsDialog=null,t.listV=null,t.labelLeft_1=null,t.labelLeft_2=null,t.mRows=3,t.MAP_ROW=96,t.MAP_COL=9,t.mNeedLink=!1,t.mLinkPercent=0,t.mAddCount=0,t.mTargetNumber=1,t.mTargetCount=10,t.mNowShowIdx=0,t.mNowShowStep=0,t}return __extends(NewClass,_super),NewClass.prototype.start=function(){this.mDataList=[]},NewClass.prototype.clearMapData=function(){this.mMapData=new Array(this.MAP_ROW);for(var t=0;t<this.MAP_ROW;++t){this.mMapData[t]=new Array(this.MAP_COL);for(var e=0;e<this.MAP_COL;++e)this.mMapData[t][e]=null}},NewClass.prototype.onBtnDoneClicked=function(){var t=Number(this.inputNumber.string);if(isNaN(t)||t<=0||t>10)alert("\u76ee\u6807\u5408\u6210\u4e2a\u6570\u53ea\u80fd\u4e3a\uff1a1-10\uff01");else{var e=Number(this.inputCount.string);if(isNaN(e)||e<=0)alert("\u9700\u8981\u6570\u636e\u603b\u91cf\u5fc5\u987b\u5927\u4e8e0\uff01");else{var i=Number(this.inputLink.string);isNaN(i)||i<0||i>100?alert("\u8fde\u6d88\u6982\u7387\u8303\u56f4\u5fc5\u987b\u57280-100\uff01"):t<2&&i>0?alert("1\u5bf9\u6570\u5b57\u4e0d\u80fd\u8bbe\u7f6e\u8fde\u6d88\uff01"):(this.clearMap(),this.mTargetNumber=t,this.mTargetCount=e,this.mLinkPercent=i,this.mLinkPercent>0&&(this.mNeedLink=!0),this.createMap(),this.initScrollView(),alert("\u751f\u6210\u9635\u578b\u6210\u529f, \u5171\u751f\u6210"+this.mDataList.length+"\u7ec4\u6570\u636e\uff01"))}}},NewClass.prototype.onBtnCopyClicked=function(){if(this.mDataList.length<=0)alert("\u5bf9\u4e0d\u8d77\uff0c\u672a\u627e\u5230\u53ef\u590d\u5236\u9635\u578b\uff01");else{for(var t="\u53ef\u5408\u5e76\u4e2a\u6570\t\u9635\u578b\u914d\u7f6e\n",e=0;e<this.mDataList.length;++e){for(var i=this.mDataList[e].mergeList.length+" \t[",o=this.mDataList[e].cubes,s=0;s<this.mRows;++s){for(var a=0;a<o[s].length;++a)i+=o[s][a].num,a<o[s].length-1&&(i+=",");s<this.mRows-1&&(i+=",")}t+=i+="]\n"}navigator.clipboard.writeText(t),this.showToast("\u590d\u5236\u5230\u526a\u5207\u677f\u6210\u529f\uff01")}},NewClass.prototype.onBtnLoad=function(event,customEventData){var _this=this,addNum=Number(this.inputAdd.string);isNaN(addNum)||addNum<0||addNum>10?alert("\u4f7f\u7528+\u8303\u56f4\u5fc5\u987b\u57280-10\uff01"):(this.mAddCount=addNum,this.mDataList=[],this.clearMapData(),this.clearMap(),navigator.clipboard.readText().then(function(text){for(var str=text.toString(),data=str.split("\n"),i=0;i<data.length;++i){var arr=data[i];arr=eval(arr);var cData=new CubeData;cData.cubes=[],cData.mergeList=[];for(var j=0;j<arr.length;++j){var row=Math.floor(j/_this.MAP_COL),col=j%_this.MAP_COL;cData.cubes[row]||(cData.cubes[row]=[]);var cube=new NumberCube;cube.row=row,cube.col=col,cube.num=Number(arr[j]),cData.cubes[row][col]=cube}_this.mDataList.push(cData)}_this.initScrollView(),alert("\u4e0a\u4f20\u6570\u636e"+_this.mDataList.length+"\u6761")}).catch(function(t){console.error("Failed to read clipboard contents: ",t),_this.showToast("\u4e0a\u4f20\u6570\u636e\u51fa\u9519\uff01")}))},NewClass.prototype.onBtnCalc=function(){if(!this.mDataList||this.mDataList.length<=0)alert("\u6570\u636e\u9519\u8bef\uff01");else try{this.calcAllCubeDatas(!1),this.calcAllCubeDatas(!0),this.showToast("\u8ba1\u7b97\u6570\u636e\u5b8c\u6bd5\uff01")}catch(t){console.log(t),alert("\u8ba1\u7b97\u6570\u636e\u51fa\u9519\uff01")}},NewClass.prototype.onBtnTips=function(t,e){this.mTipsDialog&&(this.mTipsDialog.active="1"==e)},NewClass.prototype.clearMap=function(){for(var t=this.mapBg.children,e=0;e<t.length;++e)t[e].destroy()},NewClass.prototype.onBtnItemClicked=function(t){var e=t.target._listId;this.mNowShowIdx=e,this.mNowShowStep=0;var i=this.mDataList[e].cubes,o=this.mDataList[e].mergeList,s=this.mDataList[e].leftNum_1,a=this.mDataList[e].leftNum_2;this.clearMap();for(var n=0;n<i.length;++n)for(var r=0;r<i[n].length;++r)if(i[n][r]){for(var c=!1,l=0;l<o.length;++l)(o[l][0].x==i[n][r].row&&o[l][0].y==i[n][r].col||o[l][1].x==i[n][r].row&&o[l][1].y==i[n][r].col)&&(c=!0);this.addCube(i[n][r],c)}this.labelLeft_1.string="\u5269\u4f59_1\uff1a"+s,this.labelLeft_2.string="\u5269\u4f59_2\uff1a"+a},NewClass.prototype.onBtnRecodClicked=function(t,e){if(!(this.mDataList.length<=0)){var i;i=deepClone("11"==e||"12"==e||"13"==e?this.mDataList[this.mNowShowIdx].prcessCubes_1:this.mDataList[this.mNowShowIdx].prcessCubes_2),"11"==e||"21"==e?this.mNowShowStep>0&&this.mNowShowStep--:"12"==e||"22"==e?this.mNowShowStep=0:"13"!=e&&"23"!=e||this.mNowShowStep<i.length-1&&this.mNowShowStep++,this.mNowShowStep<0&&(this.mNowShowStep=0),this.mNowShowStep>=i.length&&(this.mNowShowStep=i.length-1),this.fillMap(i[this.mNowShowStep])}},NewClass.prototype.fillMap=function(t){this.clearMap();for(var e=0;e<t.length;++e)for(var i=0;i<t[e].length;++i)t[e][i]&&this.addCube(t[e][i],!1)},NewClass.prototype.addCube=function(t,e){var i=t.row,o=t.col,s=t.num,a=cc.instantiate(this.cubeNode);a.getChildByName("bg").active=e,cc.resources.load("nums/"+s,cc.SpriteFrame,function(t,e){t&&console.log(t),a.getChildByName("num").getComponent(cc.Sprite).spriteFrame=e}),a.setPosition((o+.5)*(654/9),72.5*-(i+.5)),this.mapBg.addChild(a)},NewClass.prototype.initMapData=function(){this.clearMapData();for(var t=0,e=0;e<this.mRows;++e)for(var i=0;i<this.MAP_COL;++i){var o=new IntVec2(e,i);if(this.mMapData[e][i]=new NumberCube,this.mMapData[e][i].row=e,this.mMapData[e][i].col=i,this.mMapData[e][i].num=cc.math.randomRangeInt(1,10),this.canSingleCubeMerge(o)){var s=this.mTargetNumber;if(this.mNeedLink&&s>0&&(s=this.mTargetNumber-1),t>=s){this.mMapData[e].pop(),i--;continue}t++}}},NewClass.prototype.getAllCubes=function(){for(var t=[],e=0;e<this.MAP_ROW;++e)for(var i=0;i<this.MAP_COL;++i)if(this.mMapData[e]&&this.mMapData[e][i]){var o=new NumberCube;o.row=this.mMapData[e][i].row,o.col=this.mMapData[e][i].col,o.num=this.mMapData[e][i].num,t.push(o)}return t},NewClass.prototype.createMap=function(){console.log(Math.abs(-890)),this.mDataList=[];for(var t=0,e=0;e<this.mTargetCount&&t<1e5;++e){t++,this.initMapData();var i=new CubeData;i.cubes=deepClone(this.mMapData),i.mergeList=(new Array).fill([]),i.mergeList=[];for(var o=!1,s=this.getAllCubes(),a=0;a<s.length;++a)for(var n=0;n<s.length;++n)if(a!=n){var r=s[a].row,c=s[a].col,l=s[n].row,h=s[n].col;if(this.mMapData[r][c]&&this.mMapData[l][h]){for(var p=!1,u=0;u<i.mergeList.length;++u){var d=i.mergeList[u][0],_=i.mergeList[u][1];if(d.x==s[a].row&&d.y==s[a].col||d.x==s[n].row&&d.y==s[n].col){p=!0;break}if(_.x==s[a].row&&_.y==s[a].col||_.x==s[n].row&&_.y==s[n].col){p=!0;break}}if(!p&&this.canCubeMerge(s[a].getRowCol(),s[n].getRowCol())){if(i.mergeList.push([s[a].getRowCol(),s[n].getRowCol()]),!o){for(var m=this.getCubeRoundRC(s[a].getRowCol()),y=!1,f=0;f<m.length;++f)if(m[f].x==s[n].row&&m[f].y==s[n].col){y=!0;break}o=!y}this.mMapData[r][c]=null,this.mMapData[l][h]=null,a=0,n=0}}}if(i.mergeList.length==this.mTargetNumber){if(100*e/this.mTargetCount<this.mLinkPercent){if(!o){e--;continue}}else if(this.mNeedLink=!1,o){e--;continue}if(e%2!=0){var g=deepClone(i.cubes);for(a=0;a<this.mRows;++a)for(n=0;n<g[a].length;++n){var v=this.mRows-a-1,w=g[a].length-n-1;i.cubes[v][w]=g[a][n],i.cubes[v][w].row=v,i.cubes[v][w].col=w}for(u=0;u<i.mergeList.length;++u)i.mergeList[u][0].x=this.mRows-i.mergeList[u][0].x-1,i.mergeList[u][0].y=this.MAP_COL-i.mergeList[u][0].y-1,i.mergeList[u][1].x=this.mRows-i.mergeList[u][1].x-1,i.mergeList[u][1].y=this.MAP_COL-i.mergeList[u][1].y-1}this.mDataList.push(i)}else e--}this.mDataList.sort(function(t,e){return t.mergeList.length-e.mergeList.length})},NewClass.prototype.mergeMap=function(){for(var t=[],e=this.getAllCubes(),i=0;i<e.length;++i)for(var o=0;o<e.length;++o)if(i!=o){var s=e[i].row,a=e[i].col,n=e[o].row,r=e[o].col;if(this.mMapData[s][a]&&this.mMapData[n][r]){for(var c=!1,l=0;l<t.length;++l){var h=t[l][0],p=t[l][1];if(h.x==e[i].row&&h.y==e[i].col||h.x==e[o].row&&h.y==e[o].col){c=!0;break}if(p.x==e[i].row&&p.y==e[i].col||p.x==e[o].row&&p.y==e[o].col){c=!0;break}}c||this.canCubeMerge(e[i].getRowCol(),e[o].getRowCol())&&(t.push([e[i].getRowCol(),e[o].getRowCol()]),i=0,o=0)}}return t},NewClass.prototype.getOptimalIndex=function(t,e){var i=-1;if(!t||t.length<=0)return i;i=cc.math.randomRangeInt(0,t.length);var o=!1;if(e)for(var s=0;s<t.length;++s){var a=t[s][0],n=t[s][1];if(2==a.x||3==a.x||2==n.x||3==n.x){o=!0,i=s;break}}if(!o)for(s=0;s<t.length;++s){if(a=t[s][0],n=t[s][1],a.x==n.x&&2==this.getRowCubes(a.x)){o=!0,i=s;break}if(1==this.getRowCubes(a.x)||1==this.getRowCubes(n.x)){o=!0,i=s;break}}return i},NewClass.prototype.getRowCubes=function(t){for(var e=0,i=0;i<this.MAP_COL;++i){var o=new IntVec2(t,i);this.isValidRowCol(o)&&e++}return e},NewClass.prototype.getCubeRoundRC=function(t){var e=new Array;if(!this.isValidRowCol(t))return e;var i=new IntVec2(t.x-1,t.y-1);return this.isValidRowCol(i)&&e.push(i),i=new IntVec2(t.x-1,t.y),this.isValidRowCol(i)&&e.push(i),i=new IntVec2(t.x-1,t.y+1),this.isValidRowCol(i)&&e.push(i),i=new IntVec2(t.x,t.y-1),this.isValidRowCol(i)&&e.push(i),i=new IntVec2(t.x,t.y+1),this.isValidRowCol(i)&&e.push(i),i=new IntVec2(t.x+1,t.y-1),this.isValidRowCol(i)&&e.push(i),i=new IntVec2(t.x+1,t.y),this.isValidRowCol(i)&&e.push(i),i=new IntVec2(t.x+1,t.y+1),this.isValidRowCol(i)&&e.push(i),e},NewClass.prototype.initScrollView=function(){this.listV.numItems=this.mDataList.length},NewClass.prototype.isValidRowCol=function(t){return!(t.x<0||t.x>this.MAP_ROW||t.y<0||t.y>this.MAP_COL||!this.mMapData[t.x][t.y])},NewClass.prototype.isRowColEqual=function(t,e){return t.x==e.x&&t.y==e.y},NewClass.prototype.canCubeMerge=function(t,e){if(!this.isValidRowCol(t)||!this.isValidRowCol(e)||this.isRowColEqual(t,e))return!1;var i=this.mMapData[t.x][t.y],o=this.mMapData[e.x][e.y];if(!i||!o)return!1;var s=i.num+o.num==10,a=i.num==o.num;if(!s&&!a)return!1;var n=[];if(t.x==e.x)for(var r=Math.min(t.y,e.y),c=Math.max(t.y,e.y),l=r+1;l<c;++l)(d=this.mMapData[t.x][l])&&n.push(d);else if(t.y==e.y){var h=Math.min(t.x,e.x),p=Math.max(t.x,e.x);for(l=h+1;l<p;++l)(d=this.mMapData[l][t.y])&&n.push(d)}else if(t.x<e.x&&t.y<e.y&&e.x-t.x==e.y-t.y){l=t.x+1;for(var u=t.y+1;l<e.x&&u<e.y;++l,++u)(d=this.mMapData[l][u])&&n.push(d)}else if(t.x>e.x&&t.y<e.y&&t.x-e.x==e.y-t.y)for(l=t.x-1,u=t.y+1;l>e.x&&u<e.y;--l,++u)(d=this.mMapData[l][u])&&n.push(d);else if(t.x>e.x&&t.y>e.y&&t.x-e.x==t.y-e.y)for(l=t.x-1,u=t.y-1;l>e.x&&u>e.y;--l,--u)(d=this.mMapData[l][u])&&n.push(d);else if(t.x<e.x&&t.y>e.y&&e.x-t.x==t.y-e.y)for(l=t.x+1,u=t.y-1;l<e.x&&u>e.y;++l,--u)(d=this.mMapData[l][u])&&n.push(d);else if(t.x<e.x){for(u=t.y+1;u<this.MAP_COL;++u)(d=this.mMapData[t.x][u])&&n.push(d);for(l=t.x+1;l<e.x;++l)for(u=0;u<this.MAP_COL;++u)(d=this.mMapData[l][u])&&n.push(d);for(u=0;u<e.y;++u)(d=this.mMapData[e.x][u])&&n.push(d)}else if(t.x>e.x){for(u=t.y-1;u>=0;--u)(d=this.mMapData[t.x][u])&&n.push(d);for(l=t.x-1;l>e.x;--l)for(u=this.MAP_COL-1;u>=0;--u)(d=this.mMapData[l][u])&&n.push(d);for(u=this.MAP_COL-1;u>e.y;--u){var d;(d=this.mMapData[e.x][u])&&n.push(d)}}return 0==n.length},NewClass.prototype.canSingleCubeMerge=function(t){for(var e=this.getAllCubes(),i=0;i<e.length;++i)if(this.canCubeMerge(t,e[i].getRowCol()))return!0;return!1},NewClass.prototype.onListVRender=function(t,e){for(var i=this.mDataList[e],o=cc.find("bg/labelData",t),s=e+1+"---[",a=i.cubes,n=0;n<this.mRows;++n){for(var r=0;r<a[n].length;++r)s+=a[n][r].num,r<a[n].length-1&&(s+=",");n<this.mRows-1?s+=",":s+="]"}o.getComponent(cc.Label).string=s},NewClass.prototype.calcAllCubeDatas=function(t){if(!this.mDataList||this.mDataList.length<=0)alert("\u6570\u636e\u51fa\u9519\uff0c\u8bf7\u91cd\u65b0\u4e0a\u4f20\uff01");else for(var e=0;e<this.mDataList.length;++e){var i=this.mDataList[e];this.clearMapData(),this.mMapData=deepClone(i.cubes),this.addMapRecord(t,e),this.mLastRC=new IntVec2(2,this.MAP_COL-1);var o=this.mAddCount;t&&o>0&&(this.addNewNumbers(),o-=1,this.addMapRecord(t,e));for(var s=this.mergeMap();s.length>0;){var a=this.getOptimalIndex(s,t&&o==this.mAddCount-1),n=s[a][0],r=s[a][1];if(this.mMapData[n.x][n.y]=null,this.mMapData[r.x][r.y]=null,this.getRowCubes(n.x)<=0&&(n.x==this.mLastRC.x&&(this.mLastRC.y=this.MAP_COL-1),this.mLastRC.x-=1),n.x!=r.x&&this.getRowCubes(r.x)<=0&&(r.x==this.mLastRC.x&&(this.mLastRC.y=this.MAP_COL-1),this.mLastRC.x-=1),this.checkEmptyLine(),this.addMapRecord(t,e),this.getAllCubes().length<=0)break;for(s=this.mergeMap();s.length<=0&&o>0;)this.addNewNumbers(),this.addMapRecord(t,e),o-=1,s=this.mergeMap()}var c=this.getAllCubes();t?this.mDataList[e].leftNum_2=c.length:this.mDataList[e].leftNum_1=c.length}},NewClass.prototype.addMapRecord=function(t,e){t?this.mDataList[e].prcessCubes_2.push(deepClone(this.mMapData)):this.mDataList[e].prcessCubes_1.push(deepClone(this.mMapData))},NewClass.prototype.checkEmptyLine=function(){for(var t=1;t<this.MAP_ROW;++t){for(var e=!0,i=0;i<this.MAP_COL;++i)if(this.mMapData[t]&&this.mMapData[t][i]){e=!1;break}if(!e){for(var o=0,s=t-1;s>=0;--s){var a=!0;for(i=0;i<this.MAP_COL;++i)if(this.mMapData[s][i]){a=!1;break}if(!a)break;o++}if(o>0){for(var n=t;n<this.MAP_ROW;++n)for(i=0;i<this.MAP_COL;++i)if(this.mMapData[n]){var r=n-o;this.mMapData[r][i]=this.mMapData[n][i],this.mMapData[n][i]=null,this.mMapData[r][i]&&(this.mMapData[r][i].row=r)}t-=o}}}},NewClass.prototype.addNewNumbers=function(){for(var t=this.getAllCubes(),e=0,i=this.mLastRC,o=this.mLastRC.x;o<this.MAP_ROW;++o)for(var s=o==this.mLastRC.x?this.mLastRC.y+1:0;s<this.MAP_COL;++s){this.mMapData[o]||(this.mMapData[o]=[]);var a=t[e++],n=new NumberCube;n.row=o,n.col=s,n.num=a.num,this.mMapData[o][s]=n,i.x=o,i.y=s,e>=t.length&&(o=this.MAP_ROW,s=this.MAP_COL)}this.mLastRC=i},NewClass.prototype.showToast=function(t){var e=document.createElement("div");e.innerHTML=t,e.style.cssText="width:40%; min-width:180px; background:#000; opacity:0.8; height:auto;min-height: 50px; color:#fff; line-height:200px; font-size:60; text-align:center; border-radius:4px; position:fixed; top:60%; left:30%; z-index:999999;",document.body.appendChild(e),setTimeout(function(){e.style.webkitTransition="-webkit-transform 0.5s ease-in, opacity 0.5s ease-in",e.style.opacity="0",setTimeout(function(){document.body.removeChild(e)},500)},3e3)},__decorate([property({type:cc.Node})],NewClass.prototype,"mapBg",void 0),__decorate([property({type:cc.EditBox})],NewClass.prototype,"inputNumber",void 0),__decorate([property({type:cc.EditBox})],NewClass.prototype,"inputCount",void 0),__decorate([property({type:cc.EditBox})],NewClass.prototype,"inputLink",void 0),__decorate([property({type:cc.EditBox})],NewClass.prototype,"inputAdd",void 0),__decorate([property({type:cc.Button})],NewClass.prototype,"btnDone",void 0),__decorate([property({type:cc.Button})],NewClass.prototype,"btnCopy",void 0),__decorate([property({type:cc.Node})],NewClass.prototype,"cubeNode",void 0),__decorate([property({type:cc.Node})],NewClass.prototype,"mTipsDialog",void 0),__decorate([property({type:List_1.default})],NewClass.prototype,"listV",void 0),__decorate([property({type:cc.Label})],NewClass.prototype,"labelLeft_1",void 0),__decorate([property({type:cc.Label})],NewClass.prototype,"labelLeft_2",void 0),NewClass=__decorate([ccclass],NewClass),NewClass}(cc.Component);exports.default=NewClass,cc._RF.pop()},{"./List":"List"}]},{},["List","ListItem","main"]);