window.__require=function t(e,a,i){function s(r,n){if(!a[r]){if(!e[r]){var l=r.split("/");if(l=l[l.length-1],!e[l]){var h="function"==typeof __require&&__require;if(!n&&h)return h(l,!0);if(o)return o(l,!0);throw new Error("Cannot find module '"+r+"'")}r=l}var c=a[r]={exports:{}};e[r][0].call(c.exports,function(t){return s(e[r][1][t]||t)},c,c.exports,t,e,a,i)}return a[r].exports}for(var o="function"==typeof __require&&__require,r=0;r<i.length;r++)s(i[r]);return s}({CalcWorker:[function(t,e){"use strict";cc._RF.push(e,"b9ea2MBo9pIgqRemzPXkaqQ","CalcWorker"),cc._RF.pop()},{}],ListItem:[function(t,e,a){"use strict";cc._RF.push(e,"582d0m2jOtPf6Wqj3ZoSn94","ListItem");var i,s=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),o=this&&this.__decorate||function(t,e,a,i){var s,o=arguments.length,r=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,a):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,i);else for(var n=t.length-1;n>=0;n--)(s=t[n])&&(r=(o<3?s(r):o>3?s(e,a,r):s(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(a,"__esModule",{value:!0});var r,n=cc._decorator,l=n.ccclass,h=n.property,c=n.disallowMultiple,m=n.menu,p=n.executionOrder;(function(t){t[t.NONE=0]="NONE",t[t.TOGGLE=1]="TOGGLE",t[t.SWITCH=2]="SWITCH"})(r||(r={}));var u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.icon=null,e.title=null,e.selectedMode=r.NONE,e.selectedFlag=null,e.selectedSpriteFrame=null,e._unselectedSpriteFrame=null,e.adaptiveSize=!1,e._selected=!1,e._eventReg=!1,e}return s(e,t),Object.defineProperty(e.prototype,"selected",{get:function(){return this._selected},set:function(t){if(this._selected=t,this.selectedFlag)switch(this.selectedMode){case r.TOGGLE:this.selectedFlag.active=t;break;case r.SWITCH:var e=this.selectedFlag.getComponent(cc.Sprite);e&&(e.spriteFrame=t?this.selectedSpriteFrame:this._unselectedSpriteFrame)}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"btnCom",{get:function(){return this._btnCom||(this._btnCom=this.node.getComponent(cc.Button)),this._btnCom},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){if(this.selectedMode==r.SWITCH){var t=this.selectedFlag.getComponent(cc.Sprite);this._unselectedSpriteFrame=t.spriteFrame}},e.prototype.onDestroy=function(){this.node.off(cc.Node.EventType.SIZE_CHANGED,this._onSizeChange,this)},e.prototype._registerEvent=function(){this._eventReg||(this.btnCom&&this.list.selectedMode>0&&this.btnCom.clickEvents.unshift(this.createEvt(this,"onClickThis")),this.adaptiveSize&&this.node.on(cc.Node.EventType.SIZE_CHANGED,this._onSizeChange,this),this._eventReg=!0)},e.prototype._onSizeChange=function(){this.list._onItemAdaptive(this.node)},e.prototype.createEvt=function(t,e,a){if(void 0===a&&(a=null),t.isValid){t.comName=t.comName||t.name.match(/\<(.*?)\>/g).pop().replace(/\<|>/g,"");var i=new cc.Component.EventHandler;return i.target=a||t.node,i.component=t.comName,i.handler=e,i}},e.prototype.showAni=function(t,e,a){var i,s=this;switch(t){case 0:i=cc.tween(s.node).to(.2,{scale:.7}).by(.3,{y:2*s.node.height});break;case 1:i=cc.tween(s.node).to(.2,{scale:.7}).by(.3,{x:2*s.node.width});break;case 2:i=cc.tween(s.node).to(.2,{scale:.7}).by(.3,{y:-2*s.node.height});break;case 3:i=cc.tween(s.node).to(.2,{scale:.7}).by(.3,{x:-2*s.node.width});break;default:i=cc.tween(s.node).to(.3,{scale:.1})}(e||a)&&i.call(function(){if(a){s.list._delSingleItem(s.node);for(var t=s.list.displayData.length-1;t>=0;t--)if(s.list.displayData[t].id==s.listId){s.list.displayData.splice(t,1);break}}e()}),i.start()},e.prototype.onClickThis=function(){this.list.selectedId=this.listId},o([h({type:cc.Sprite,tooltip:!1})],e.prototype,"icon",void 0),o([h({type:cc.Node,tooltip:!1})],e.prototype,"title",void 0),o([h({type:cc.Enum(r),tooltip:!1})],e.prototype,"selectedMode",void 0),o([h({type:cc.Node,tooltip:!1,visible:function(){return this.selectedMode>r.NONE}})],e.prototype,"selectedFlag",void 0),o([h({type:cc.SpriteFrame,tooltip:!1,visible:function(){return this.selectedMode==r.SWITCH}})],e.prototype,"selectedSpriteFrame",void 0),o([h({tooltip:!1})],e.prototype,"adaptiveSize",void 0),o([l,c(),m("\u81ea\u5b9a\u4e49\u7ec4\u4ef6/List Item"),p(-5001)],e)}(cc.Component);a.default=u,cc._RF.pop()},{}],List:[function(t,e,a){"use strict";cc._RF.push(e,"1ea82d5JjZHn5508iS5VKPn","List");var i,s=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),o=this&&this.__decorate||function(t,e,a,i){var s,o=arguments.length,r=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,a):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,i);else for(var n=t.length-1;n>=0;n--)(s=t[n])&&(r=(o<3?s(r):o>3?s(e,a,r):s(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(a,"__esModule",{value:!0});var r,n,l,h=cc._decorator,c=h.ccclass,m=h.property,p=h.disallowMultiple,u=h.menu,d=h.executionOrder,_=h.requireComponent,f=t("./ListItem");(function(t){t[t.NODE=1]="NODE",t[t.PREFAB=2]="PREFAB"})(r||(r={})),function(t){t[t.NORMAL=1]="NORMAL",t[t.ADHERING=2]="ADHERING",t[t.PAGE=3]="PAGE"}(n||(n={})),function(t){t[t.NONE=0]="NONE",t[t.SINGLE=1]="SINGLE",t[t.MULT=2]="MULT"}(l||(l={}));var y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.templateType=r.NODE,e.tmpNode=null,e.tmpPrefab=null,e._slideMode=n.NORMAL,e.pageDistance=.3,e.pageChangeEvent=new cc.Component.EventHandler,e._virtual=!0,e.cyclic=!1,e.lackCenter=!1,e.lackSlide=!1,e._updateRate=0,e.frameByFrameRenderNum=0,e.renderEvent=new cc.Component.EventHandler,e.selectedMode=l.NONE,e.repeatEventSingle=!1,e.selectedEvent=new cc.Component.EventHandler,e._selectedId=-1,e._forceUpdate=!1,e._updateDone=!0,e._numItems=0,e._inited=!1,e._needUpdateWidget=!1,e._aniDelRuning=!1,e._doneAfterUpdate=!1,e.adhering=!1,e._adheringBarrier=!1,e.curPageNum=0,e}return s(e,t),Object.defineProperty(e.prototype,"slideMode",{get:function(){return this._slideMode},set:function(t){this._slideMode=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"virtual",{get:function(){return this._virtual},set:function(t){null!=t&&(this._virtual=t),0!=this._numItems&&this._onScrolling()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"updateRate",{get:function(){return this._updateRate},set:function(t){t>=0&&t<=6&&(this._updateRate=t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"selectedId",{get:function(){return this._selectedId},set:function(t){var e,a=this;switch(a.selectedMode){case l.SINGLE:if(!a.repeatEventSingle&&t==a._selectedId)return;e=a.getItemByListId(t);var i=void 0;if(a._selectedId>=0?a._lastSelectedId=a._selectedId:a._lastSelectedId=null,a._selectedId=t,e&&((i=e.getComponent(f.default)).selected=!0),a._lastSelectedId>=0&&a._lastSelectedId!=a._selectedId){var s=a.getItemByListId(a._lastSelectedId);s&&(s.getComponent(f.default).selected=!1)}a.selectedEvent&&cc.Component.EventHandler.emitEvents([a.selectedEvent],e,t%this._actualNumItems,null==a._lastSelectedId?null:a._lastSelectedId%this._actualNumItems);break;case l.MULT:if(!(e=a.getItemByListId(t)))return;i=e.getComponent(f.default),a._selectedId>=0&&(a._lastSelectedId=a._selectedId),a._selectedId=t;var o=!i.selected;i.selected=o;var r=a.multSelected.indexOf(t);o&&r<0?a.multSelected.push(t):!o&&r>=0&&a.multSelected.splice(r,1),a.selectedEvent&&cc.Component.EventHandler.emitEvents([a.selectedEvent],e,t%this._actualNumItems,null==a._lastSelectedId?null:a._lastSelectedId%this._actualNumItems,o)}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"numItems",{get:function(){return this._actualNumItems},set:function(t){var e=this;if(e.checkInited(!1))if(null==t||t<0)cc.error("numItems set the wrong::",t);else if(e._actualNumItems=e._numItems=t,e._forceUpdate=!0,e._virtual)e._resizeContent(),e.cyclic&&(e._numItems=e._cyclicNum*e._numItems),e._onScrolling(),e.frameByFrameRenderNum||e.slideMode!=n.PAGE||(e.curPageNum=e.nearestListId);else{e.cyclic&&(e._resizeContent(),e._numItems=e._cyclicNum*e._numItems);var a=e.content.getComponent(cc.Layout);if(a&&(a.enabled=!0),e._delRedundantItem(),e.firstListId=0,e.frameByFrameRenderNum>0){for(var i=e.frameByFrameRenderNum>e._numItems?e._numItems:e.frameByFrameRenderNum,s=0;s<i;s++)e._createOrUpdateItem2(s);e.frameByFrameRenderNum<e._numItems&&(e._updateCounter=e.frameByFrameRenderNum,e._updateDone=!1)}else{for(s=0;s<e._numItems;s++)e._createOrUpdateItem2(s);e.displayItemNum=e._numItems}}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scrollView",{get:function(){return this._scrollView},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){this._init()},e.prototype.onDestroy=function(){var t=this;cc.isValid(t._itemTmp)&&t._itemTmp.destroy(),cc.isValid(t.tmpNode)&&t.tmpNode.destroy(),t._pool&&t._pool.clear()},e.prototype.onEnable=function(){this._registerEvent(),this._init(),this._aniDelRuning&&(this._aniDelRuning=!1,this._aniDelItem&&(this._aniDelBeforePos&&(this._aniDelItem.position=this._aniDelBeforePos,delete this._aniDelBeforePos),this._aniDelBeforeScale&&(this._aniDelItem.scale=this._aniDelBeforeScale,delete this._aniDelBeforeScale),delete this._aniDelItem),this._aniDelCB&&(this._aniDelCB(),delete this._aniDelCB))},e.prototype.onDisable=function(){this._unregisterEvent()},e.prototype._registerEvent=function(){var t=this;t.node.on(cc.Node.EventType.TOUCH_START,t._onTouchStart,t,!0),t.node.on("touch-up",t._onTouchUp,t),t.node.on(cc.Node.EventType.TOUCH_CANCEL,t._onTouchCancelled,t,!0),t.node.on("scroll-began",t._onScrollBegan,t,!0),t.node.on("scroll-ended",t._onScrollEnded,t,!0),t.node.on("scrolling",t._onScrolling,t,!0),t.node.on(cc.Node.EventType.SIZE_CHANGED,t._onSizeChanged,t)},e.prototype._unregisterEvent=function(){var t=this;t.node.off(cc.Node.EventType.TOUCH_START,t._onTouchStart,t,!0),t.node.off("touch-up",t._onTouchUp,t),t.node.off(cc.Node.EventType.TOUCH_CANCEL,t._onTouchCancelled,t,!0),t.node.off("scroll-began",t._onScrollBegan,t,!0),t.node.off("scroll-ended",t._onScrollEnded,t,!0),t.node.off("scrolling",t._onScrolling,t,!0),t.node.off(cc.Node.EventType.SIZE_CHANGED,t._onSizeChanged,t)},e.prototype._init=function(){var t=this;if(!t._inited)if(t._scrollView=t.node.getComponent(cc.ScrollView),t.content=t._scrollView.content,t.content){switch(t._layout=t.content.getComponent(cc.Layout),t._align=t._layout.type,t._resizeMode=t._layout.resizeMode,t._startAxis=t._layout.startAxis,t._topGap=t._layout.paddingTop,t._rightGap=t._layout.paddingRight,t._bottomGap=t._layout.paddingBottom,t._leftGap=t._layout.paddingLeft,t._columnGap=t._layout.spacingX,t._lineGap=t._layout.spacingY,t._colLineNum,t._verticalDir=t._layout.verticalDirection,t._horizontalDir=t._layout.horizontalDirection,t.setTemplateItem(cc.instantiate(t.templateType==r.PREFAB?t.tmpPrefab:t.tmpNode)),t._slideMode!=n.ADHERING&&t._slideMode!=n.PAGE||(t._scrollView.inertia=!1,t._scrollView._onMouseWheel=function(){}),t.virtual||(t.lackCenter=!1),t._lastDisplayData=[],t.displayData=[],t._pool=new cc.NodePool,t._forceUpdate=!1,t._updateCounter=0,t._updateDone=!0,t.curPageNum=0,t.cyclic&&(t._scrollView._processAutoScrolling=this._processAutoScrolling.bind(t),t._scrollView._startBounceBackIfNeeded=function(){return!1}),t._align){case cc.Layout.Type.HORIZONTAL:switch(t._horizontalDir){case cc.Layout.HorizontalDirection.LEFT_TO_RIGHT:t._alignCalcType=1;break;case cc.Layout.HorizontalDirection.RIGHT_TO_LEFT:t._alignCalcType=2}break;case cc.Layout.Type.VERTICAL:switch(t._verticalDir){case cc.Layout.VerticalDirection.TOP_TO_BOTTOM:t._alignCalcType=3;break;case cc.Layout.VerticalDirection.BOTTOM_TO_TOP:t._alignCalcType=4}break;case cc.Layout.Type.GRID:switch(t._startAxis){case cc.Layout.AxisDirection.HORIZONTAL:switch(t._verticalDir){case cc.Layout.VerticalDirection.TOP_TO_BOTTOM:t._alignCalcType=3;break;case cc.Layout.VerticalDirection.BOTTOM_TO_TOP:t._alignCalcType=4}break;case cc.Layout.AxisDirection.VERTICAL:switch(t._horizontalDir){case cc.Layout.HorizontalDirection.LEFT_TO_RIGHT:t._alignCalcType=1;break;case cc.Layout.HorizontalDirection.RIGHT_TO_LEFT:t._alignCalcType=2}}}t.content.removeAllChildren(),t._inited=!0}else cc.error(t.node.name+"'s cc.ScrollView unset content!")},e.prototype._processAutoScrolling=function(t){this._scrollView._autoScrollAccumulatedTime+=1*t;var e=Math.min(1,this._scrollView._autoScrollAccumulatedTime/this._scrollView._autoScrollTotalTime);if(this._scrollView._autoScrollAttenuate){var a=e-1;e=a*a*a*a*a+1}var i=this._scrollView._autoScrollStartPosition.add(this._scrollView._autoScrollTargetDelta.mul(e)),s=this._scrollView.getScrollEndedEventTiming(),o=Math.abs(e-1)<=s;Math.abs(e-1)<=this._scrollView.getScrollEndedEventTiming()&&!this._scrollView._isScrollEndedWithThresholdEventFired&&(this._scrollView._dispatchEvent("scroll-ended-with-threshold"),this._scrollView._isScrollEndedWithThresholdEventFired=!0),o&&(this._scrollView._autoScrolling=!1);var r=i.sub(this._scrollView.getContentPosition());this._scrollView._moveContent(this._scrollView._clampDelta(r),o),this._scrollView._dispatchEvent("scrolling"),this._scrollView._autoScrolling||(this._scrollView._isBouncing=!1,this._scrollView._scrolling=!1,this._scrollView._dispatchEvent("scroll-ended"))},e.prototype.setTemplateItem=function(t){if(t){var e=this;e._itemTmp=t,e._resizeMode==cc.Layout.ResizeMode.CHILDREN?e._itemSize=e._layout.cellSize:e._itemSize=cc.size(t.width,t.height);var a=t.getComponent(f.default),i=!1;switch(a||(i=!0),i&&(e.selectedMode=l.NONE),(a=t.getComponent(cc.Widget))&&a.enabled&&(e._needUpdateWidget=!0),e.selectedMode==l.MULT&&(e.multSelected=[]),e._align){case cc.Layout.Type.HORIZONTAL:e._colLineNum=1,e._sizeType=!1;break;case cc.Layout.Type.VERTICAL:e._colLineNum=1,e._sizeType=!0;break;case cc.Layout.Type.GRID:switch(e._startAxis){case cc.Layout.AxisDirection.HORIZONTAL:var s=e.content.width-e._leftGap-e._rightGap;e._colLineNum=Math.floor((s+e._columnGap)/(e._itemSize.width+e._columnGap)),e._sizeType=!0;break;case cc.Layout.AxisDirection.VERTICAL:var o=e.content.height-e._topGap-e._bottomGap;e._colLineNum=Math.floor((o+e._lineGap)/(e._itemSize.height+e._lineGap)),e._sizeType=!1}}}},e.prototype.checkInited=function(t){return void 0===t&&(t=!0),!!this._inited||(t&&cc.error("List initialization not completed!"),!1)},e.prototype._resizeContent=function(){var t,e=this;switch(e._align){case cc.Layout.Type.HORIZONTAL:if(e._customSize){var a=e._getFixedSize(null);t=e._leftGap+a.val+e._itemSize.width*(e._numItems-a.count)+e._columnGap*(e._numItems-1)+e._rightGap}else t=e._leftGap+e._itemSize.width*e._numItems+e._columnGap*(e._numItems-1)+e._rightGap;break;case cc.Layout.Type.VERTICAL:e._customSize?(a=e._getFixedSize(null),t=e._topGap+a.val+e._itemSize.height*(e._numItems-a.count)+e._lineGap*(e._numItems-1)+e._bottomGap):t=e._topGap+e._itemSize.height*e._numItems+e._lineGap*(e._numItems-1)+e._bottomGap;break;case cc.Layout.Type.GRID:switch(e.lackCenter&&(e.lackCenter=!1),e._startAxis){case cc.Layout.AxisDirection.HORIZONTAL:var i=Math.ceil(e._numItems/e._colLineNum);t=e._topGap+e._itemSize.height*i+e._lineGap*(i-1)+e._bottomGap;break;case cc.Layout.AxisDirection.VERTICAL:var s=Math.ceil(e._numItems/e._colLineNum);t=e._leftGap+e._itemSize.width*s+e._columnGap*(s-1)+e._rightGap}}var o=e.content.getComponent(cc.Layout);if(o&&(o.enabled=!1),e._allItemSize=t,e._allItemSizeNoEdge=e._allItemSize-(e._sizeType?e._topGap+e._bottomGap:e._leftGap+e._rightGap),e.cyclic){var r=e._sizeType?e.node.height:e.node.width;e._cyclicPos1=0,r-=e._cyclicPos1,e._cyclicNum=Math.ceil(r/e._allItemSizeNoEdge)+1;var n=e._sizeType?e._lineGap:e._columnGap;e._cyclicPos2=e._cyclicPos1+e._allItemSizeNoEdge+n,e._cyclicAllItemSize=e._allItemSize+e._allItemSizeNoEdge*(e._cyclicNum-1)+n*(e._cyclicNum-1),e._cycilcAllItemSizeNoEdge=e._allItemSizeNoEdge*e._cyclicNum,e._cycilcAllItemSizeNoEdge+=n*(e._cyclicNum-1)}e._lack=!e.cyclic&&e._allItemSize<(e._sizeType?e.node.height:e.node.width);var l=e._lack&&e.lackCenter||!e.lackSlide?.1:0,h=e._lack?(e._sizeType?e.node.height:e.node.width)-l:e.cyclic?e._cyclicAllItemSize:e._allItemSize;h<0&&(h=0),e._sizeType?e.content.height=h:e.content.width=h},e.prototype._onScrolling=function(t){if(void 0===t&&(t=null),null==this.frameCount&&(this.frameCount=this._updateRate),!this._forceUpdate&&t&&"scroll-ended"!=t.type&&this.frameCount>0)this.frameCount--;else if(this.frameCount=this._updateRate,!this._aniDelRuning){if(this.cyclic){var e=this.content.getPosition();e=this._sizeType?e.y:e.x;var a=this._allItemSizeNoEdge+(this._sizeType?this._lineGap:this._columnGap),i=this._sizeType?cc.v2(0,a):cc.v2(a,0);switch(this._alignCalcType){case 1:e>-this._cyclicPos1?(this.content.x=-this._cyclicPos2,this._scrollView.isAutoScrolling()&&(this._scrollView._autoScrollStartPosition=this._scrollView._autoScrollStartPosition.sub(i))):e<-this._cyclicPos2&&(this.content.x=-this._cyclicPos1,this._scrollView.isAutoScrolling()&&(this._scrollView._autoScrollStartPosition=this._scrollView._autoScrollStartPosition.add(i)));break;case 2:e<this._cyclicPos1?(this.content.x=this._cyclicPos2,this._scrollView.isAutoScrolling()&&(this._scrollView._autoScrollStartPosition=this._scrollView._autoScrollStartPosition.add(i))):e>this._cyclicPos2&&(this.content.x=this._cyclicPos1,this._scrollView.isAutoScrolling()&&(this._scrollView._autoScrollStartPosition=this._scrollView._autoScrollStartPosition.sub(i)));break;case 3:e<this._cyclicPos1?(this.content.y=this._cyclicPos2,this._scrollView.isAutoScrolling()&&(this._scrollView._autoScrollStartPosition=this._scrollView._autoScrollStartPosition.add(i))):e>this._cyclicPos2&&(this.content.y=this._cyclicPos1,this._scrollView.isAutoScrolling()&&(this._scrollView._autoScrollStartPosition=this._scrollView._autoScrollStartPosition.sub(i)));break;case 4:e>-this._cyclicPos1?(this.content.y=-this._cyclicPos2,this._scrollView.isAutoScrolling()&&(this._scrollView._autoScrollStartPosition=this._scrollView._autoScrollStartPosition.sub(i))):e<-this._cyclicPos2&&(this.content.y=-this._cyclicPos1,this._scrollView.isAutoScrolling()&&(this._scrollView._autoScrollStartPosition=this._scrollView._autoScrollStartPosition.add(i)))}}var s,o,r,n;if(this._calcViewPos(),this._sizeType?(s=this.viewTop,r=this.viewBottom):(o=this.viewRight,n=this.viewLeft),this._virtual){this.displayData=[];var l=void 0,h=0,c=this._numItems-1;if(this._customSize)for(var m=!1;h<=c&&!m;h++)switch(l=this._calcItemPos(h),this._align){case cc.Layout.Type.HORIZONTAL:l.right>=n&&l.left<=o?this.displayData.push(l):0!=h&&this.displayData.length>0&&(m=!0);break;case cc.Layout.Type.VERTICAL:l.bottom<=s&&l.top>=r?this.displayData.push(l):0!=h&&this.displayData.length>0&&(m=!0);break;case cc.Layout.Type.GRID:switch(this._startAxis){case cc.Layout.AxisDirection.HORIZONTAL:l.bottom<=s&&l.top>=r?this.displayData.push(l):0!=h&&this.displayData.length>0&&(m=!0);break;case cc.Layout.AxisDirection.VERTICAL:l.right>=n&&l.left<=o?this.displayData.push(l):0!=h&&this.displayData.length>0&&(m=!0)}}else{var p=this._itemSize.width+this._columnGap,u=this._itemSize.height+this._lineGap;switch(this._alignCalcType){case 1:h=(n-this._leftGap)/p,c=(o-this._leftGap)/p;break;case 2:h=(-o-this._rightGap)/p,c=(-n-this._rightGap)/p;break;case 3:h=(-s-this._topGap)/u,c=(-r-this._topGap)/u;break;case 4:h=(r-this._bottomGap)/u,c=(s-this._bottomGap)/u}for(h=Math.floor(h)*this._colLineNum,c=Math.ceil(c)*this._colLineNum,h<0&&(h=0),--c>=this._numItems&&(c=this._numItems-1);h<=c;h++)this.displayData.push(this._calcItemPos(h))}if(this._delRedundantItem(),this.displayData.length<=0||!this._numItems)return void(this._lastDisplayData=[]);this.firstListId=this.displayData[0].id,this.displayItemNum=this.displayData.length;var d=this._lastDisplayData.length,_=this.displayItemNum!=d;if(_&&(this.frameByFrameRenderNum>0&&this._lastDisplayData.sort(function(t,e){return t-e}),_=this.firstListId!=this._lastDisplayData[0]||this.displayData[this.displayItemNum-1].id!=this._lastDisplayData[d-1]),this._forceUpdate||_)if(this.frameByFrameRenderNum>0)this._numItems>0?(this._updateDone?this._updateCounter=0:this._doneAfterUpdate=!0,this._updateDone=!1):(this._updateCounter=0,this._updateDone=!0);else{this._lastDisplayData=[];for(var f=0;f<this.displayItemNum;f++)this._createOrUpdateItem(this.displayData[f]);this._forceUpdate=!1}this._calcNearestItem()}}},e.prototype._calcViewPos=function(){var t=this.content.getPosition();switch(this._alignCalcType){case 1:this.elasticLeft=t.x>0?t.x:0,this.viewLeft=(t.x<0?-t.x:0)-this.elasticLeft,this.viewRight=this.viewLeft+this.node.width,this.elasticRight=this.viewRight>this.content.width?Math.abs(this.viewRight-this.content.width):0,this.viewRight+=this.elasticRight;break;case 2:this.elasticRight=t.x<0?-t.x:0,this.viewRight=(t.x>0?-t.x:0)+this.elasticRight,this.viewLeft=this.viewRight-this.node.width,this.elasticLeft=this.viewLeft<-this.content.width?Math.abs(this.viewLeft+this.content.width):0,this.viewLeft-=this.elasticLeft;break;case 3:this.elasticTop=t.y<0?Math.abs(t.y):0,this.viewTop=(t.y>0?-t.y:0)+this.elasticTop,this.viewBottom=this.viewTop-this.node.height,this.elasticBottom=this.viewBottom<-this.content.height?Math.abs(this.viewBottom+this.content.height):0,this.viewBottom+=this.elasticBottom;break;case 4:this.elasticBottom=t.y>0?Math.abs(t.y):0,this.viewBottom=(t.y<0?-t.y:0)-this.elasticBottom,this.viewTop=this.viewBottom+this.node.height,this.elasticTop=this.viewTop>this.content.height?Math.abs(this.viewTop-this.content.height):0,this.viewTop-=this.elasticTop}},e.prototype._calcItemPos=function(t){var e,a,i,s,o,r,n,l;switch(this._align){case cc.Layout.Type.HORIZONTAL:switch(this._horizontalDir){case cc.Layout.HorizontalDirection.LEFT_TO_RIGHT:if(this._customSize){var h=this._getFixedSize(t);o=this._leftGap+(this._itemSize.width+this._columnGap)*(t-h.count)+(h.val+this._columnGap*h.count),e=(c=this._customSize[t])>0?c:this._itemSize.width}else o=this._leftGap+(this._itemSize.width+this._columnGap)*t,e=this._itemSize.width;return this.lackCenter&&(o-=this._leftGap,o+=this.content.width/2-this._allItemSizeNoEdge/2),{id:t,left:o,right:r=o+e,x:o+this._itemTmp.anchorX*e,y:this._itemTmp.y};case cc.Layout.HorizontalDirection.RIGHT_TO_LEFT:return this._customSize?(h=this._getFixedSize(t),r=-this._rightGap-(this._itemSize.width+this._columnGap)*(t-h.count)-(h.val+this._columnGap*h.count),e=(c=this._customSize[t])>0?c:this._itemSize.width):(r=-this._rightGap-(this._itemSize.width+this._columnGap)*t,e=this._itemSize.width),this.lackCenter&&(r+=this._rightGap,r-=this.content.width/2-this._allItemSizeNoEdge/2),{id:t,right:r,left:o=r-e,x:o+this._itemTmp.anchorX*e,y:this._itemTmp.y}}break;case cc.Layout.Type.VERTICAL:switch(this._verticalDir){case cc.Layout.VerticalDirection.TOP_TO_BOTTOM:return this._customSize?(h=this._getFixedSize(t),i=-this._topGap-(this._itemSize.height+this._lineGap)*(t-h.count)-(h.val+this._lineGap*h.count),a=(c=this._customSize[t])>0?c:this._itemSize.height):(i=-this._topGap-(this._itemSize.height+this._lineGap)*t,a=this._itemSize.height),this.lackCenter&&(i+=this._topGap,i-=this.content.height/2-this._allItemSizeNoEdge/2),{id:t,top:i,bottom:s=i-a,x:this._itemTmp.x,y:s+this._itemTmp.anchorY*a};case cc.Layout.VerticalDirection.BOTTOM_TO_TOP:var c;if(this._customSize)h=this._getFixedSize(t),s=this._bottomGap+(this._itemSize.height+this._lineGap)*(t-h.count)+(h.val+this._lineGap*h.count),a=(c=this._customSize[t])>0?c:this._itemSize.height;else s=this._bottomGap+(this._itemSize.height+this._lineGap)*t,a=this._itemSize.height;return this.lackCenter&&(s-=this._bottomGap,s+=this.content.height/2-this._allItemSizeNoEdge/2),{id:t,top:i=s+a,bottom:s,x:this._itemTmp.x,y:s+this._itemTmp.anchorY*a}}case cc.Layout.Type.GRID:var m=Math.floor(t/this._colLineNum);switch(this._startAxis){case cc.Layout.AxisDirection.HORIZONTAL:switch(this._verticalDir){case cc.Layout.VerticalDirection.TOP_TO_BOTTOM:l=(s=(i=-this._topGap-(this._itemSize.height+this._lineGap)*m)-this._itemSize.height)+this._itemTmp.anchorY*this._itemSize.height;break;case cc.Layout.VerticalDirection.BOTTOM_TO_TOP:i=(s=this._bottomGap+(this._itemSize.height+this._lineGap)*m)+this._itemSize.height,l=s+this._itemTmp.anchorY*this._itemSize.height}switch(n=this._leftGap+t%this._colLineNum*(this._itemSize.width+this._columnGap),this._horizontalDir){case cc.Layout.HorizontalDirection.LEFT_TO_RIGHT:n+=this._itemTmp.anchorX*this._itemSize.width,n-=this.content.anchorX*this.content.width;break;case cc.Layout.HorizontalDirection.RIGHT_TO_LEFT:n+=(1-this._itemTmp.anchorX)*this._itemSize.width,n-=(1-this.content.anchorX)*this.content.width,n*=-1}return{id:t,top:i,bottom:s,x:n,y:l};case cc.Layout.AxisDirection.VERTICAL:switch(this._horizontalDir){case cc.Layout.HorizontalDirection.LEFT_TO_RIGHT:r=(o=this._leftGap+(this._itemSize.width+this._columnGap)*m)+this._itemSize.width,n=o+this._itemTmp.anchorX*this._itemSize.width,n-=this.content.anchorX*this.content.width;break;case cc.Layout.HorizontalDirection.RIGHT_TO_LEFT:n=(o=(r=-this._rightGap-(this._itemSize.width+this._columnGap)*m)-this._itemSize.width)+this._itemTmp.anchorX*this._itemSize.width,n+=(1-this.content.anchorX)*this.content.width}switch(l=-this._topGap-t%this._colLineNum*(this._itemSize.height+this._lineGap),this._verticalDir){case cc.Layout.VerticalDirection.TOP_TO_BOTTOM:l-=(1-this._itemTmp.anchorY)*this._itemSize.height,l+=(1-this.content.anchorY)*this.content.height;break;case cc.Layout.VerticalDirection.BOTTOM_TO_TOP:l-=this._itemTmp.anchorY*this._itemSize.height,l+=this.content.anchorY*this.content.height,l*=-1}return{id:t,left:o,right:r,x:n,y:l}}}},e.prototype._calcExistItemPos=function(t){var e=this.getItemByListId(t);if(!e)return null;var a={id:t,x:e.x,y:e.y};return this._sizeType?(a.top=e.y+e.height*(1-e.anchorY),a.bottom=e.y-e.height*e.anchorY):(a.left=e.x-e.width*e.anchorX,a.right=e.x+e.width*(1-e.anchorX)),a},e.prototype.getItemPos=function(t){return this._virtual?this._calcItemPos(t):this.frameByFrameRenderNum?this._calcItemPos(t):this._calcExistItemPos(t)},e.prototype._getFixedSize=function(t){if(!this._customSize)return null;null==t&&(t=this._numItems);var e=0,a=0;for(var i in this._customSize)parseInt(i)<t&&(e+=this._customSize[i],a++);return{val:e,count:a}},e.prototype._onScrollBegan=function(){this._beganPos=this._sizeType?this.viewTop:this.viewLeft},e.prototype._onScrollEnded=function(){var t=this;if(t.curScrollIsTouch=!1,null!=t.scrollToListId){var e=t.getItemByListId(t.scrollToListId);t.scrollToListId=null,e&&cc.tween(e).to(.1,{scale:1.06}).to(.1,{scale:1}).start()}t._onScrolling(),t._slideMode!=n.ADHERING||t.adhering?t._slideMode==n.PAGE&&(null!=t._beganPos&&t.curScrollIsTouch?this._pageAdhere():t.adhere()):t.adhere()},e.prototype._onTouchStart=function(t,e){if(!this._scrollView.hasNestedViewGroup(t,e)&&(this.curScrollIsTouch=!0,t.eventPhase!==cc.Event.AT_TARGET||t.target!==this.node)){for(var a=t.target;null==a._listId&&a.parent;)a=a.parent;this._scrollItem=null!=a._listId?a:t.target}},e.prototype._onTouchUp=function(){var t=this;t._scrollPos=null,t._slideMode==n.ADHERING?(this.adhering&&(this._adheringBarrier=!0),t.adhere()):t._slideMode==n.PAGE&&(null!=t._beganPos?this._pageAdhere():t.adhere()),this._scrollItem=null},e.prototype._onTouchCancelled=function(t,e){var a=this;a._scrollView.hasNestedViewGroup(t,e)||t.simulate||(a._scrollPos=null,a._slideMode==n.ADHERING?(a.adhering&&(a._adheringBarrier=!0),a.adhere()):a._slideMode==n.PAGE&&(null!=a._beganPos?a._pageAdhere():a.adhere()),this._scrollItem=null)},e.prototype._onSizeChanged=function(){this.checkInited(!1)&&this._onScrolling()},e.prototype._onItemAdaptive=function(t){if(!this._sizeType&&t.width!=this._itemSize.width||this._sizeType&&t.height!=this._itemSize.height){this._customSize||(this._customSize={});var e=this._sizeType?t.height:t.width;this._customSize[t._listId]!=e&&(this._customSize[t._listId]=e,this._resizeContent(),this.updateAll(),null!=this._scrollToListId&&(this._scrollPos=null,this.unschedule(this._scrollToSo),this.scrollTo(this._scrollToListId,Math.max(0,this._scrollToEndTime-(new Date).getTime()/1e3))))}},e.prototype._pageAdhere=function(){var t=this;if(t.cyclic||!(t.elasticTop>0||t.elasticRight>0||t.elasticBottom>0||t.elasticLeft>0)){var e=t._sizeType?t.viewTop:t.viewLeft,a=(t._sizeType?t.node.height:t.node.width)*t.pageDistance;if(Math.abs(t._beganPos-e)>a)switch(t._alignCalcType){case 1:case 4:t._beganPos>e?t.prePage(.5):t.nextPage(.5);break;case 2:case 3:t._beganPos<e?t.prePage(.5):t.nextPage(.5)}else t.elasticTop<=0&&t.elasticRight<=0&&t.elasticBottom<=0&&t.elasticLeft<=0&&t.adhere();t._beganPos=null}},e.prototype.adhere=function(){var t=this;if(t.checkInited()&&!(t.elasticTop>0||t.elasticRight>0||t.elasticBottom>0||t.elasticLeft>0)){t.adhering=!0,t._calcNearestItem();var e=(t._sizeType?t._topGap:t._leftGap)/(t._sizeType?t.node.height:t.node.width);t.scrollTo(t.nearestListId,.7,e)}},e.prototype.update=function(){if(!(this.frameByFrameRenderNum<=0||this._updateDone))if(this._virtual){for(var t=this._updateCounter+this.frameByFrameRenderNum>this.displayItemNum?this.displayItemNum:this._updateCounter+this.frameByFrameRenderNum,e=this._updateCounter;e<t;e++){var a=this.displayData[e];a&&this._createOrUpdateItem(a)}this._updateCounter>=this.displayItemNum-1?this._doneAfterUpdate?(this._updateCounter=0,this._updateDone=!1,this._doneAfterUpdate=!1):(this._updateDone=!0,this._delRedundantItem(),this._forceUpdate=!1,this._calcNearestItem(),this.slideMode==n.PAGE&&(this.curPageNum=this.nearestListId)):this._updateCounter+=this.frameByFrameRenderNum}else if(this._updateCounter<this._numItems){for(t=this._updateCounter+this.frameByFrameRenderNum>this._numItems?this._numItems:this._updateCounter+this.frameByFrameRenderNum,e=this._updateCounter;e<t;e++)this._createOrUpdateItem2(e);this._updateCounter+=this.frameByFrameRenderNum}else this._updateDone=!0,this._calcNearestItem(),this.slideMode==n.PAGE&&(this.curPageNum=this.nearestListId)},e.prototype._createOrUpdateItem=function(t){var e=this.getItemByListId(t.id);if(e)this._forceUpdate&&this.renderEvent&&(e.setPosition(cc.v2(t.x,t.y)),this._resetItemSize(e),this.renderEvent&&cc.Component.EventHandler.emitEvents([this.renderEvent],e,t.id%this._actualNumItems));else{var a=this._pool.size()>0;if(e=a?this._pool.get():cc.instantiate(this._itemTmp),a&&cc.isValid(e)||(e=cc.instantiate(this._itemTmp),a=!1),e._listId!=t.id&&(e._listId=t.id,e.setContentSize(this._itemSize)),e.setPosition(cc.v2(t.x,t.y)),this._resetItemSize(e),this.content.addChild(e),a&&this._needUpdateWidget){var i=e.getComponent(cc.Widget);i&&i.updateAlignment()}e.setSiblingIndex(this.content.childrenCount-1);var s=e.getComponent(f.default);e.listItem=s,s&&(s.listId=t.id,s.list=this,s._registerEvent()),this.renderEvent&&cc.Component.EventHandler.emitEvents([this.renderEvent],e,t.id%this._actualNumItems)}this._resetItemSize(e),this._updateListItem(e.listItem),this._lastDisplayData.indexOf(t.id)<0&&this._lastDisplayData.push(t.id)},e.prototype._createOrUpdateItem2=function(t){var e,a=this.content.children[t];a?this._forceUpdate&&this.renderEvent&&(a._listId=t,e&&(e.listId=t),this.renderEvent&&cc.Component.EventHandler.emitEvents([this.renderEvent],a,t%this._actualNumItems)):((a=cc.instantiate(this._itemTmp))._listId=t,this.content.addChild(a),e=a.getComponent(f.default),a.listItem=e,e&&(e.listId=t,e.list=this,e._registerEvent()),this.renderEvent&&cc.Component.EventHandler.emitEvents([this.renderEvent],a,t%this._actualNumItems)),this._updateListItem(e),this._lastDisplayData.indexOf(t)<0&&this._lastDisplayData.push(t)},e.prototype._updateListItem=function(t){if(t&&this.selectedMode>l.NONE){var e=t.node;switch(this.selectedMode){case l.SINGLE:t.selected=this.selectedId==e._listId;break;case l.MULT:t.selected=this.multSelected.indexOf(e._listId)>=0}}},e.prototype._resetItemSize=function(){},e.prototype._updateItemPos=function(t){var e=isNaN(t)?t:this.getItemByListId(t),a=this.getItemPos(e._listId);e.setPosition(a.x,a.y)},e.prototype.setMultSelected=function(t,e){var a=this;if(a.checkInited()){if(Array.isArray(t)||(t=[t]),null==e)a.multSelected=t;else{var i=void 0,s=void 0;if(e)for(var o=t.length-1;o>=0;o--)i=t[o],(s=a.multSelected.indexOf(i))<0&&a.multSelected.push(i);else for(o=t.length-1;o>=0;o--)i=t[o],(s=a.multSelected.indexOf(i))>=0&&a.multSelected.splice(s,1)}a._forceUpdate=!0,a._onScrolling()}},e.prototype.getMultSelected=function(){return this.multSelected},e.prototype.hasMultSelected=function(t){return this.multSelected&&this.multSelected.indexOf(t)>=0},e.prototype.updateItem=function(t){if(this.checkInited()){Array.isArray(t)||(t=[t]);for(var e=0,a=t.length;e<a;e++){var i=t[e],s=this.getItemByListId(i);s&&cc.Component.EventHandler.emitEvents([this.renderEvent],s,i%this._actualNumItems)}}},e.prototype.updateAll=function(){this.checkInited()&&(this.numItems=this.numItems)},e.prototype.getItemByListId=function(t){if(this.content)for(var e=this.content.childrenCount-1;e>=0;e--){var a=this.content.children[e];if(a._listId==t)return a}},e.prototype._getOutsideItem=function(){for(var t,e=[],a=this.content.childrenCount-1;a>=0;a--)t=this.content.children[a],this.displayData.find(function(e){return e.id==t._listId})||e.push(t);return e},e.prototype._delRedundantItem=function(){if(this._virtual)for(var t=this._getOutsideItem(),e=t.length-1;e>=0;e--){var a=t[e];if(!this._scrollItem||a._listId!=this._scrollItem._listId){a.isCached=!0,this._pool.put(a);for(var i=this._lastDisplayData.length-1;i>=0;i--)if(this._lastDisplayData[i]==a._listId){this._lastDisplayData.splice(i,1);break}}}else for(;this.content.childrenCount>this._numItems;)this._delSingleItem(this.content.children[this.content.childrenCount-1])},e.prototype._delSingleItem=function(t){t.removeFromParent(),t.destroy&&t.destroy(),t=null},e.prototype.aniDelItem=function(t,e,a){var i=this;if(!i.checkInited()||i.cyclic||!i._virtual)return cc.error("This function is not allowed to be called!");if(!e)return cc.error("CallFunc are not allowed to be NULL, You need to delete the corresponding index in the data array in the CallFunc!");if(i._aniDelRuning)return cc.warn("Please wait for the current deletion to finish!");var s,o=i.getItemByListId(t);if(o){s=o.getComponent(f.default),i._aniDelRuning=!0,i._aniDelCB=e,i._aniDelItem=o,i._aniDelBeforePos=o.position,i._aniDelBeforeScale=o.scale;var r=i.displayData[i.displayData.length-1].id,n=s.selected;s.showAni(a,function(){var a,s,h;if(r<i._numItems-2&&(a=r+1),null!=a){var c=i._calcItemPos(a);i.displayData.push(c),i._virtual?i._createOrUpdateItem(c):i._createOrUpdateItem2(a)}else i._numItems--;if(i.selectedMode==l.SINGLE)n?i._selectedId=-1:i._selectedId-1>=0&&i._selectedId--;else if(i.selectedMode==l.MULT&&i.multSelected.length){var m=i.multSelected.indexOf(t);m>=0&&i.multSelected.splice(m,1);for(var p=i.multSelected.length-1;p>=0;p--)(_=i.multSelected[p])>=t&&i.multSelected[p]--}if(i._customSize){i._customSize[t]&&delete i._customSize[t];var u={},d=void 0;for(var _ in i._customSize){d=i._customSize[_];var f=parseInt(_);u[f-(f>=t?1:0)]=d}i._customSize=u}for(p=null!=a?a:r;p>=t+1;p--)if(o=i.getItemByListId(p)){var y=i._calcItemPos(p-1);s=cc.tween(o).to(.2333,{position:cc.v2(y.x,y.y)}),p<=t+1&&(h=!0,s.call(function(){i._aniDelRuning=!1,e(t),delete i._aniDelCB})),s.start()}h||(i._aniDelRuning=!1,e(t),i._aniDelCB=null)},!0)}else e(t)},e.prototype.scrollTo=function(t,e,a,i){void 0===e&&(e=.5),void 0===a&&(a=null),void 0===i&&(i=!1);var s=this;if(s.checkInited(!1)){null==e?e=.5:e<0&&(e=0),t<0?t=0:t>=s._numItems&&(t=s._numItems-1),!s._virtual&&s._layout&&s._layout.enabled&&s._layout.updateLayout();var o,r,n=s.getItemPos(t);if(!n)return!1;switch(s._alignCalcType){case 1:o=n.left,o-=null!=a?s.node.width*a:s._leftGap,n=cc.v2(o,0);break;case 2:o=n.right-s.node.width,o+=null!=a?s.node.width*a:s._rightGap,n=cc.v2(o+s.content.width,0);break;case 3:r=n.top,r+=null!=a?s.node.height*a:s._topGap,n=cc.v2(0,-r);break;case 4:r=n.bottom+s.node.height,r-=null!=a?s.node.height*a:s._bottomGap,n=cc.v2(0,-r+s.content.height)}var l=s.content.getPosition();l=Math.abs(s._sizeType?l.y:l.x);var h=s._sizeType?n.y:n.x;Math.abs((null!=s._scrollPos?s._scrollPos:l)-h)>.5&&(s._scrollView.scrollToOffset(n,e),s._scrollToListId=t,s._scrollToEndTime=(new Date).getTime()/1e3+e,s._scrollToSo=s.scheduleOnce(function(){if(s._adheringBarrier||(s.adhering=s._adheringBarrier=!1),s._scrollPos=s._scrollToListId=s._scrollToEndTime=s._scrollToSo=null,i){var e=s.getItemByListId(t);e&&cc.tween(e).to(.1,{scale:1.05}).to(.1,{scale:1}).start()}},e+.1),e<=0&&s._onScrolling())}},e.prototype._calcNearestItem=function(){var t,e,a,i,s,o,r=this;r.nearestListId=null,r._virtual&&r._calcViewPos(),a=r.viewTop,i=r.viewRight,s=r.viewBottom,o=r.viewLeft;for(var n=!1,l=0;l<r.content.childrenCount&&!n;l+=r._colLineNum)if(t=r._virtual?r.displayData[l]:r._calcExistItemPos(l))switch(e=r._sizeType?(t.top+t.bottom)/2:e=(t.left+t.right)/2,r._alignCalcType){case 1:t.right>=o&&(r.nearestListId=t.id,o>e&&(r.nearestListId+=r._colLineNum),n=!0);break;case 2:t.left<=i&&(r.nearestListId=t.id,i<e&&(r.nearestListId+=r._colLineNum),n=!0);break;case 3:t.bottom<=a&&(r.nearestListId=t.id,a<e&&(r.nearestListId+=r._colLineNum),n=!0);break;case 4:t.top>=s&&(r.nearestListId=t.id,s>e&&(r.nearestListId+=r._colLineNum),n=!0)}if((t=r._virtual?r.displayData[r.displayItemNum-1]:r._calcExistItemPos(r._numItems-1))&&t.id==r._numItems-1)switch(e=r._sizeType?(t.top+t.bottom)/2:e=(t.left+t.right)/2,r._alignCalcType){case 1:i>e&&(r.nearestListId=t.id);break;case 2:o<e&&(r.nearestListId=t.id);break;case 3:s<e&&(r.nearestListId=t.id);break;case 4:a>e&&(r.nearestListId=t.id)}},e.prototype.prePage=function(t){void 0===t&&(t=.5),this.checkInited()&&this.skipPage(this.curPageNum-1,t)},e.prototype.nextPage=function(t){void 0===t&&(t=.5),this.checkInited()&&this.skipPage(this.curPageNum+1,t)},e.prototype.skipPage=function(t,e){var a=this;if(a.checkInited())return a._slideMode!=n.PAGE?cc.error("This function is not allowed to be called, Must SlideMode = PAGE!"):void(t<0||t>=a._numItems||a.curPageNum!=t&&(a.curPageNum=t,a.pageChangeEvent&&cc.Component.EventHandler.emitEvents([a.pageChangeEvent],t),a.scrollTo(t,e)))},e.prototype.calcCustomSize=function(t){var e=this;if(e.checkInited()){if(!e._itemTmp)return cc.error("Unset template item!");if(!e.renderEvent)return cc.error("Unset Render-Event!");e._customSize={};var a=cc.instantiate(e._itemTmp);e.content.addChild(a);for(var i=0;i<t;i++)cc.Component.EventHandler.emitEvents([e.renderEvent],a,i),a.height==e._itemSize.height&&a.width==e._itemSize.width||(e._customSize[i]=e._sizeType?a.height:a.width);return Object.keys(e._customSize).length||(e._customSize=null),a.removeFromParent(),a.destroy&&a.destroy(),e._customSize}},o([m({type:cc.Enum(r),tooltip:!1})],e.prototype,"templateType",void 0),o([m({type:cc.Node,tooltip:!1,visible:function(){return this.templateType==r.NODE}})],e.prototype,"tmpNode",void 0),o([m({type:cc.Prefab,tooltip:!1,visible:function(){return this.templateType==r.PREFAB}})],e.prototype,"tmpPrefab",void 0),o([m()],e.prototype,"_slideMode",void 0),o([m({type:cc.Enum(n),tooltip:!1})],e.prototype,"slideMode",null),o([m({type:cc.Float,range:[0,1,.1],tooltip:!1,slide:!0,visible:function(){return this._slideMode==n.PAGE}})],e.prototype,"pageDistance",void 0),o([m({type:cc.Component.EventHandler,tooltip:!1,visible:function(){return this._slideMode==n.PAGE}})],e.prototype,"pageChangeEvent",void 0),o([m()],e.prototype,"_virtual",void 0),o([m({type:cc.Boolean,tooltip:!1})],e.prototype,"virtual",null),o([m({tooltip:!1,visible:function(){var t=this.slideMode==n.NORMAL;return t||(this.cyclic=!1),t}})],e.prototype,"cyclic",void 0),o([m({tooltip:!1,visible:function(){return this.virtual}})],e.prototype,"lackCenter",void 0),o([m({tooltip:!1,visible:function(){var t=this.virtual&&!this.lackCenter;return t||(this.lackSlide=!1),t}})],e.prototype,"lackSlide",void 0),o([m({type:cc.Integer})],e.prototype,"_updateRate",void 0),o([m({type:cc.Integer,range:[0,6,1],tooltip:!1,slide:!0})],e.prototype,"updateRate",null),o([m({type:cc.Integer,range:[0,12,1],tooltip:!1,slide:!0})],e.prototype,"frameByFrameRenderNum",void 0),o([m({type:cc.Component.EventHandler,tooltip:!1})],e.prototype,"renderEvent",void 0),o([m({type:cc.Enum(l),tooltip:!1})],e.prototype,"selectedMode",void 0),o([m({tooltip:!1,visible:function(){return this.selectedMode==l.SINGLE}})],e.prototype,"repeatEventSingle",void 0),o([m({type:cc.Component.EventHandler,tooltip:!1,visible:function(){return this.selectedMode>l.NONE}})],e.prototype,"selectedEvent",void 0),o([m({serializable:!1})],e.prototype,"_numItems",void 0),o([c,p(),u("\u81ea\u5b9a\u4e49\u7ec4\u4ef6/List"),_(cc.ScrollView),d(-5e3)],e)}(cc.Component);a.default=y,cc._RF.pop()},{"./ListItem":"ListItem"}],Start:[function(t,e,a){"use strict";cc._RF.push(e,"d4fd3jdk2ZD8qgCqQpK7s1n","Start");var i,s=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),o=this&&this.__decorate||function(t,e,a,i){var s,o=arguments.length,r=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,a):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,i);else for(var n=t.length-1;n>=0;n--)(s=t[n])&&(r=(o<3?s(r):o>3?s(e,a,r):s(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(a,"__esModule",{value:!0});var r=cc._decorator,n=r.ccclass,l=r.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.label=null,e.text="hello",e}return s(e,t),e.prototype.start=function(){cc.game.setFrameRate(240),window.Worker||alert("\u5bf9\u4e0d\u8d77\uff0c\u60a8\u7684\u6d4f\u89c8\u5668\u4e0d\u652f\u6301\u672c\u5e94\u7528\uff01\u63a8\u8350\u4f7f\u7528Chrom\u6d4f\u89c8\u5668\u3002")},e.prototype.onBtn3=function(){cc.director.loadScene("map3")},e.prototype.onBtn4=function(){cc.director.loadScene("map4")},e.prototype.onBtn5=function(){cc.director.loadScene("map5")},o([l(cc.Label)],e.prototype,"label",void 0),o([l],e.prototype,"text",void 0),o([n],e)}(cc.Component);a.default=h,cc._RF.pop()},{}],main:[function(require,module,exports){"use strict";cc._RF.push(module,"db7f3UTw4xJQp71kREj4D1F","main");var __extends=this&&this.__extends||(extendStatics=function(t,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),extendStatics,__decorate=this&&this.__decorate||function(t,e,a,i){var s,o=arguments.length,r=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,a):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,i);else for(var n=t.length-1;n>=0;n--)(s=t[n])&&(r=(o<3?s(r):o>3?s(e,a,r):s(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(exports,"__esModule",{value:!0});var List_1=require("./List"),_a=cc._decorator,ccclass=_a.ccclass,property=_a.property,IntVec2=function(t,e){this.x=0,this.y=0,this.x=t,this.y=e},NumberCube=function(){function t(){this.row=0,this.col=0,this.num=0}return t.prototype.getRowCol=function(){return new IntVec2(this.row,this.col)},t}(),deepArray=function(t){return t.map(deepClone)},deepObject=function(t){var e=Object.keys(t),a={};return e.forEach(function(e){a[e]=deepClone(t[e])}),a},deepClone=function(t){if(null===t||!t)return t;if("[object Object]"===Object.prototype.toString.call(t)){var e={};return Object.keys(t).forEach(function(a){t[a]&&"object"==typeof t[a]?e[a]=deepClone(t[a]):e[a]=t[a]}),e}if(Array.isArray(t)){var a=[];return t.forEach(function(t,e){a[e]=t&&"object"==typeof t?deepClone(t):t}),a}},CubeData=function(){this.leftNum_1=0,this.leftNum_2=0,this.prcessCubes_1=[],this.prcessCubes_2=[],this.copyTimes_1=0,this.copyTimes_2=0,this.passPercent_1=-1,this.passPercent_2=-1},NewClass=function(_super){function NewClass(){var t=null!==_super&&_super.apply(this,arguments)||this;return t.mapBg=null,t.inputNumber=null,t.inputCount=null,t.inputLink=null,t.inputAdd=null,t.btnDone=null,t.btnCopy=null,t.cubeNode=null,t.mTipsDialog=null,t.mPercentDialog=null,t.mLabelPercent=null,t.inputSpecialLeft=null,t.inputSpeciaTotal=null,t.listV=null,t.labelLeft_1=null,t.labelLeft_2=null,t.mRows=3,t.MAP_ROW=96,t.MAP_COL=9,t.mNeedLink=!1,t.mLinkPercent=0,t.mAddCount=0,t.mTargetNumber=1,t.mTargetCount=10,t.mNowShowIdx=0,t.mNowShowStep=0,t.mSetLeftNum=0,t.mSpecialCount=10,t}return __extends(NewClass,_super),NewClass.prototype.start=function(){this.mDataList=[]},NewClass.prototype.clearMapData=function(){this.mMapData=new Array(this.MAP_ROW);for(var t=0;t<this.MAP_ROW;++t){this.mMapData[t]=new Array(this.MAP_COL);for(var e=0;e<this.MAP_COL;++e)this.mMapData[t][e]=null}},NewClass.prototype.onBtnDoneClicked=function(){var t=Number(this.inputNumber.string);if(isNaN(t)||t<=0||t>10)alert("\u76ee\u6807\u5408\u6210\u4e2a\u6570\u53ea\u80fd\u4e3a\uff1a1-10\uff01");else{var e=Number(this.inputCount.string);if(isNaN(e)||e<=0)alert("\u9700\u8981\u6570\u636e\u603b\u91cf\u5fc5\u987b\u5927\u4e8e0\uff01");else{var a=Number(this.inputLink.string);isNaN(a)||a<0||a>100?alert("\u8fde\u6d88\u6982\u7387\u8303\u56f4\u5fc5\u987b\u57280-100\uff01"):t<2&&a>0?alert("1\u5bf9\u6570\u5b57\u4e0d\u80fd\u8bbe\u7f6e\u8fde\u6d88\uff01"):(this.clearMap(),this.mTargetNumber=t,this.mTargetCount=e,this.mLinkPercent=a,this.mLinkPercent>0&&(this.mNeedLink=!0),this.createMap(),this.initScrollView(),alert("\u751f\u6210\u9635\u578b\u6210\u529f, \u5171\u751f\u6210"+this.mDataList.length+"\u7ec4\u6570\u636e\uff01"))}}},NewClass.prototype.onBtnCopyClicked=function(){if(this.mDataList.length<=0)alert("\u5bf9\u4e0d\u8d77\uff0c\u672a\u627e\u5230\u53ef\u590d\u5236\u9635\u578b\uff01");else{for(var t="\u53ef\u5408\u5e76\u4e2a\u6570\t\u9635\u578b\u914d\u7f6e\n",e=0;e<this.mDataList.length;++e){for(var a=this.mDataList[e].mergeList.length+" \t[",i=this.mDataList[e].cubes,s=0;s<this.mRows;++s){for(var o=0;o<i[s].length;++o)a+=i[s][o].num,o<i[s].length-1&&(a+=",");s<this.mRows-1&&(a+=",")}t+=a+="]\n"}navigator.clipboard.writeText(t),this.showToast("\u590d\u5236\u5230\u526a\u5207\u677f\u6210\u529f\uff01")}},NewClass.prototype.onBtnLoad=function(event,customEventData){var _this=this,addNum=Number(this.inputAdd.string);isNaN(addNum)||addNum<0||addNum>10?alert("\u4f7f\u7528+\u8303\u56f4\u5fc5\u987b\u57280-10\uff01"):(this.mAddCount=addNum,this.mDataList=[],this.clearMapData(),this.clearMap(),navigator.clipboard.readText().then(function(text){for(var str=text.toString(),data=str.split("\n"),i=0;i<data.length;++i){var arr=data[i];arr=eval(arr);var cData=new CubeData;cData.cubes=[],cData.mergeList=[];for(var j=0;j<arr.length;++j){var row=Math.floor(j/_this.MAP_COL),col=j%_this.MAP_COL;cData.cubes[row]||(cData.cubes[row]=[]);var cube=new NumberCube;cube.row=row,cube.col=col,cube.num=Number(arr[j]),cData.cubes[row][col]=cube}_this.clearMapData(),_this.mMapData=deepClone(cData.cubes);var merListTmp=_this.mergeMap(!0);_this.clearMapData(),merListTmp&&merListTmp.length>0&&(cData.mergeList=deepClone(merListTmp)),_this.mDataList.push(cData)}_this.initScrollView(),alert("\u4e0a\u4f20\u6570\u636e"+_this.mDataList.length+"\u6761")}).catch(function(t){console.error("Failed to read clipboard contents: ",t),_this.showToast("\u4e0a\u4f20\u6570\u636e\u51fa\u9519\uff01")}))},NewClass.prototype.onBtnCalc=function(){if(!this.mDataList||this.mDataList.length<=0)alert("\u6570\u636e\u9519\u8bef\uff01");else try{this.calcAllCubeDatas(!1),this.calcAllCubeDatas(!0),this.clearPassPercent(),alert("\u8ba1\u7b97\u6570\u636e\u5b8c\u6bd5\uff01")}catch(t){console.log(t),alert("\u8ba1\u7b97\u6570\u636e\u51fa\u9519\uff01")}},NewClass.prototype.onBtnCalcPass=function(){var t=this;if(!this.mDataList||this.mDataList.length<=0)alert("\u6570\u636e\u9519\u8bef\uff01");else try{this.clearPassPercent(),this.mPercentDialog.active=!0,this.mLabelPercent.string="\u8ba1\u7b97\u8fdb\u5ea6\uff1a0%";var e=0,a=setInterval(function(){if(e>=50)return clearInterval(a),t.mPercentDialog.active=!1,void alert("\u8ba1\u7b97\u901a\u5173\u7387\u5b8c\u6bd5\uff01");for(var i=0;i<t.mDataList.length;++i)t.mDataList[i].prcessCubes_1=[],t.mDataList[i].prcessCubes_2=[];t.calcAllCubeDatas(!1),t.calcAllCubeDatas(!0),t.mLabelPercent.string="\u8ba1\u7b97\u8fdb\u5ea6\uff1a"+2*(e+1)+"%",e++},10)}catch(i){console.log(i),this.mPercentDialog.active=!1,alert("\u8ba1\u7b97\u6570\u636e\u51fa\u9519\uff01")}},NewClass.prototype.clearPassPercent=function(){if(this.mDataList&&!(this.mDataList.length<=0))for(var t=0;t<this.mDataList.length;++t)this.mDataList[t].passPercent_1=-1,this.mDataList[t].passPercent_2=-1},NewClass.prototype.onBtnTips=function(t,e){this.mTipsDialog&&(this.mTipsDialog.active="1"==e)},NewClass.prototype.clearMap=function(){for(var t=this.mapBg.children,e=0;e<t.length;++e)t[e].destroy()},NewClass.prototype.onBtnItemClicked=function(t){var e=t.target._listId;this.mNowShowIdx=e,this.mNowShowStep=0;var a=this.mDataList[e].cubes,i=this.mDataList[e].mergeList,s=this.mDataList[e].leftNum_1,o=this.mDataList[e].leftNum_2;this.clearMap();for(var r=0;r<a.length;++r)for(var n=0;n<a[r].length;++n)if(a[r][n]){for(var l=!1,h=0;h<i.length;++h)(i[h][0].x==a[r][n].row&&i[h][0].y==a[r][n].col||i[h][1].x==a[r][n].row&&i[h][1].y==a[r][n].col)&&(l=!0);this.addCube(a[r][n],l)}this.labelLeft_1.string="\u5269\u4f59_1\uff1a"+s,this.labelLeft_2.string="\u5269\u4f59_2\uff1a"+o},NewClass.prototype.onBtnRecodClicked=function(t,e){if(!(this.mDataList.length<=0)){var a;!(a=deepClone("11"==e||"12"==e||"13"==e?this.mDataList[this.mNowShowIdx].prcessCubes_1:this.mDataList[this.mNowShowIdx].prcessCubes_2))||a.length<=0||("11"==e||"21"==e?this.mNowShowStep>0&&this.mNowShowStep--:"12"==e||"22"==e?this.mNowShowStep=0:"13"!=e&&"23"!=e||this.mNowShowStep<a.length-1&&this.mNowShowStep++,this.mNowShowStep<0&&(this.mNowShowStep=0),this.mNowShowStep>=a.length&&(this.mNowShowStep=a.length-1),this.fillMap(a[this.mNowShowStep]))}},NewClass.prototype.fillMap=function(t){this.clearMap();for(var e=0;e<t.length;++e)for(var a=0;a<t[e].length;++a)t[e][a]&&this.addCube(t[e][a],!1)},NewClass.prototype.addCube=function(t,e){var a=t.row,i=t.col,s=t.num,o=cc.instantiate(this.cubeNode);o.getChildByName("bg").active=e,cc.resources.load("nums/"+s,cc.SpriteFrame,function(t,e){t&&console.log(t),o.getChildByName("num").getComponent(cc.Sprite).spriteFrame=e}),o.setPosition((i+.5)*(654/9),72.5*-(a+.5)),this.mapBg.addChild(o)},NewClass.prototype.onBtnOldVersionClicked=function(t,e){"1"==e?cc.director.loadScene("main"):"2"==e?cc.director.loadScene("map2"):cc.director.loadScene("map3")},NewClass.prototype.onBtnDownLoad=function(){if(!this.mDataList||this.mDataList.length<=0)alert("\u5bf9\u4e0d\u8d77\uff0c\u6570\u636e\u9519\u8bef\uff01");else{for(var t="\u53ef\u5408\u5e76\u4e2a\u6570\t\u9635\u578b\u914d\u7f6e\t\u590d\u5236\u6b21\u6570_1\t\u4f59\u6570_1\t\u901a\u5173\u7387_1\t\u590d\u5236\u6b21\u6570_2\t\u4f59\u6570_2\t\u901a\u5173\u7387_2\n",e=0;e<this.mDataList.length;++e){for(var a=this.mDataList[e].mergeList.length+" \t[",i=this.mDataList[e].cubes,s=0;s<this.mRows;++s){for(var o=0;o<i[s].length;++o)a+=i[s][o].num,o<i[s].length-1&&(a+=",");s<this.mRows-1&&(a+=",")}a+="]\t",a+=this.mDataList[e].copyTimes_1+"\t",a+=this.mDataList[e].leftNum_1+"\t",a+=2*this.mDataList[e].passPercent_1+"\t",a+=this.mDataList[e].copyTimes_2+"\t",a+=this.mDataList[e].leftNum_2+"\t",t+=a+=2*this.mDataList[e].passPercent_2+"\n"}navigator.clipboard.writeText(t),this.showToast("\u590d\u5236\u5230\u526a\u5207\u677f\u6210\u529f\uff01")}},NewClass.prototype.initMapData=function(){this.clearMapData();for(var t=0,e=0;e<this.mRows;++e)for(var a=0;a<this.MAP_COL;++a){var i=new IntVec2(e,a);if(this.mMapData[e][a]=new NumberCube,this.mMapData[e][a].row=e,this.mMapData[e][a].col=a,this.mMapData[e][a].num=cc.math.randomRangeInt(1,10),this.canSingleCubeMerge(i)){var s=this.mTargetNumber;if(this.mNeedLink&&s>0&&(s=this.mTargetNumber-1),t>=s){this.mMapData[e].pop(),a--;continue}t++}}},NewClass.prototype.getAllCubes=function(){for(var t=[],e=0;e<this.MAP_ROW;++e)for(var a=0;a<this.MAP_COL;++a)if(this.mMapData[e]&&this.mMapData[e][a]){var i=new NumberCube;i.row=this.mMapData[e][a].row,i.col=this.mMapData[e][a].col,i.num=this.mMapData[e][a].num,t.push(i)}return t},NewClass.prototype.createMap=function(){console.log(Math.abs(-890)),this.mDataList=[];for(var t=0,e=0;e<this.mTargetCount&&t<1e5;++e){t++,this.initMapData();var a=new CubeData;a.cubes=deepClone(this.mMapData),a.mergeList=(new Array).fill([]),a.mergeList=[];for(var i=!1,s=this.getAllCubes(),o=0;o<s.length;++o)for(var r=0;r<s.length;++r)if(o!=r){var n=s[o].row,l=s[o].col,h=s[r].row,c=s[r].col;if(this.mMapData[n][l]&&this.mMapData[h][c]){for(var m=!1,p=0;p<a.mergeList.length;++p){var u=a.mergeList[p][0],d=a.mergeList[p][1];if(u.x==s[o].row&&u.y==s[o].col||u.x==s[r].row&&u.y==s[r].col){m=!0;break}if(d.x==s[o].row&&d.y==s[o].col||d.x==s[r].row&&d.y==s[r].col){m=!0;break}}if(!m&&this.canCubeMerge(s[o].getRowCol(),s[r].getRowCol())){if(a.mergeList.push([s[o].getRowCol(),s[r].getRowCol()]),!i){for(var _=this.getCubeRoundRC(s[o].getRowCol()),f=!1,y=0;y<_.length;++y)if(_[y].x==s[r].row&&_[y].y==s[r].col){f=!0;break}i=!f}this.mMapData[n][l]=null,this.mMapData[h][c]=null,o=0,r=0}}}if(a.mergeList.length==this.mTargetNumber){if(100*e/this.mTargetCount<this.mLinkPercent){if(!i){e--;continue}}else if(this.mNeedLink=!1,i){e--;continue}if(e%2!=0){var C=deepClone(a.cubes);for(o=0;o<this.mRows;++o)for(r=0;r<C[o].length;++r){var g=this.mRows-o-1,D=C[o].length-r-1;a.cubes[g][D]=C[o][r],a.cubes[g][D].row=g,a.cubes[g][D].col=D}for(p=0;p<a.mergeList.length;++p)a.mergeList[p][0].x=this.mRows-a.mergeList[p][0].x-1,a.mergeList[p][0].y=this.MAP_COL-a.mergeList[p][0].y-1,a.mergeList[p][1].x=this.mRows-a.mergeList[p][1].x-1,a.mergeList[p][1].y=this.MAP_COL-a.mergeList[p][1].y-1;this.clearMapData(),this.mMapData=deepClone(a.cubes);var w=this.mergeMap(!0);if(!w||w.length!=this.mTargetNumber){e--;continue}}this.mDataList.push(a)}else e--}this.mDataList.sort(function(t,e){return t.mergeList.length-e.mergeList.length})},NewClass.prototype.mergeMap=function(t){for(var e=[],a=this.getAllCubes(),i=0;i<a.length;++i)for(var s=0;s<a.length;++s)if(i!=s){var o=a[i].row,r=a[i].col,n=a[s].row,l=a[s].col;if(this.mMapData[o][r]&&this.mMapData[n][l]){for(var h=!1,c=0;c<e.length;++c){var m=e[c][0],p=e[c][1];if(m.x==a[i].row&&m.y==a[i].col||m.x==a[s].row&&m.y==a[s].col){h=!0;break}if(p.x==a[i].row&&p.y==a[i].col||p.x==a[s].row&&p.y==a[s].col){h=!0;break}}h||this.canCubeMerge(a[i].getRowCol(),a[s].getRowCol())&&(e.push([a[i].getRowCol(),a[s].getRowCol()]),t&&(this.mMapData[o][r]=null,this.mMapData[n][l]=null),i=0,s=0)}}return e},NewClass.prototype.getOptimalIndex=function(t,e){var a=-1;if(!t||t.length<=0)return a;a=cc.math.randomRangeInt(0,t.length);var i=!1;if(e)for(var s=0;s<t.length;++s){var o=t[s][0],r=t[s][1];if(2==o.x||3==o.x||2==r.x||3==r.x){i=!0,a=s;break}}if(!i)for(s=0;s<t.length;++s){if(o=t[s][0],r=t[s][1],o.x==r.x&&2==this.getRowCubes(o.x)){i=!0,a=s;break}if(1==this.getRowCubes(o.x)||1==this.getRowCubes(r.x)){i=!0,a=s;break}}return a},NewClass.prototype.getRowCubes=function(t){for(var e=0,a=0;a<this.MAP_COL;++a){var i=new IntVec2(t,a);this.isValidRowCol(i)&&e++}return e},NewClass.prototype.getCubeRoundRC=function(t){var e=new Array;if(!this.isValidRowCol(t))return e;var a=new IntVec2(t.x-1,t.y-1);return this.isValidRowCol(a)&&e.push(a),a=new IntVec2(t.x-1,t.y),this.isValidRowCol(a)&&e.push(a),a=new IntVec2(t.x-1,t.y+1),this.isValidRowCol(a)&&e.push(a),a=new IntVec2(t.x,t.y-1),this.isValidRowCol(a)&&e.push(a),a=new IntVec2(t.x,t.y+1),this.isValidRowCol(a)&&e.push(a),a=new IntVec2(t.x+1,t.y-1),this.isValidRowCol(a)&&e.push(a),a=new IntVec2(t.x+1,t.y),this.isValidRowCol(a)&&e.push(a),a=new IntVec2(t.x+1,t.y+1),this.isValidRowCol(a)&&e.push(a),e},NewClass.prototype.initScrollView=function(){this.listV.numItems=this.mDataList.length},NewClass.prototype.isValidRowCol=function(t){return!(t.x<0||t.x>this.MAP_ROW||t.y<0||t.y>this.MAP_COL||!this.mMapData[t.x][t.y])},NewClass.prototype.isRowColEqual=function(t,e){return t.x==e.x&&t.y==e.y},NewClass.prototype.canCubeMerge=function(t,e){if(!this.isValidRowCol(t)||!this.isValidRowCol(e)||this.isRowColEqual(t,e))return!1;var a=this.mMapData[t.x][t.y],i=this.mMapData[e.x][e.y];if(!a||!i)return!1;var s=a.num+i.num==10,o=a.num==i.num;if(!s&&!o)return!1;var r=[];if(t.x==e.x)for(var n=Math.min(t.y,e.y),l=Math.max(t.y,e.y),h=n+1;h<l;++h)(u=this.mMapData[t.x][h])&&r.push(u);else if(t.y==e.y){var c=Math.min(t.x,e.x),m=Math.max(t.x,e.x);for(h=c+1;h<m;++h)(u=this.mMapData[h][t.y])&&r.push(u)}else if(t.x<e.x&&t.y<e.y&&e.x-t.x==e.y-t.y){h=t.x+1;for(var p=t.y+1;h<e.x&&p<e.y;++h,++p)(u=this.mMapData[h][p])&&r.push(u)}else if(t.x>e.x&&t.y<e.y&&t.x-e.x==e.y-t.y)for(h=t.x-1,p=t.y+1;h>e.x&&p<e.y;--h,++p)(u=this.mMapData[h][p])&&r.push(u);else if(t.x>e.x&&t.y>e.y&&t.x-e.x==t.y-e.y)for(h=t.x-1,p=t.y-1;h>e.x&&p>e.y;--h,--p)(u=this.mMapData[h][p])&&r.push(u);else if(t.x<e.x&&t.y>e.y&&e.x-t.x==t.y-e.y)for(h=t.x+1,p=t.y-1;h<e.x&&p>e.y;++h,--p)(u=this.mMapData[h][p])&&r.push(u);else if(t.x<e.x){for(p=t.y+1;p<this.MAP_COL;++p)(u=this.mMapData[t.x][p])&&r.push(u);for(h=t.x+1;h<e.x;++h)for(p=0;p<this.MAP_COL;++p)(u=this.mMapData[h][p])&&r.push(u);for(p=0;p<e.y;++p)(u=this.mMapData[e.x][p])&&r.push(u)}else if(t.x>e.x){for(p=t.y-1;p>=0;--p)(u=this.mMapData[t.x][p])&&r.push(u);for(h=t.x-1;h>e.x;--h)for(p=this.MAP_COL-1;p>=0;--p)(u=this.mMapData[h][p])&&r.push(u);for(p=this.MAP_COL-1;p>e.y;--p){var u;(u=this.mMapData[e.x][p])&&r.push(u)}}return 0==r.length},NewClass.prototype.canSingleCubeMerge=function(t){for(var e=this.getAllCubes(),a=0;a<e.length;++a)if(this.canCubeMerge(t,e[a].getRowCol()))return!0;return!1},NewClass.prototype.onListVRender=function(t,e){for(var a=this.mDataList[e],i=cc.find("bg/labelData",t),s=e+1+"-"+a.mergeList.length+"--[",o=a.cubes,r=0;r<this.mRows;++r){for(var n=0;n<o[r].length;++n)s+=o[r][n].num,n<o[r].length-1&&(s+=",");r<this.mRows-1?s+=",":s+="]"}i.getComponent(cc.Label).string=s},NewClass.prototype.calcAllCubeDatas=function(t){if(!this.mDataList||this.mDataList.length<=0)alert("\u6570\u636e\u51fa\u9519\uff0c\u8bf7\u91cd\u65b0\u4e0a\u4f20\uff01");else for(var e=0;e<this.mDataList.length;++e){var a=this.mDataList[e];this.clearMapData(),this.mMapData=deepClone(a.cubes),this.addMapRecord(t,e),this.mLastRC=new IntVec2(2,this.MAP_COL-1);var i=this.mAddCount;t&&i>0&&(this.addNewNumbers(),i-=1,this.addMapRecord(t,e));for(var s=this.mergeMap(!1);s.length>0;){var o=this.getOptimalIndex(s,t&&i==this.mAddCount-1),r=s[o][0],n=s[o][1];if(this.mMapData[r.x][r.y]=null,this.mMapData[n.x][n.y]=null,this.getRowCubes(r.x)<=0&&(r.x==this.mLastRC.x&&(this.mLastRC.y=this.MAP_COL-1),this.mLastRC.x-=1),r.x!=n.x&&this.getRowCubes(n.x)<=0&&(n.x==this.mLastRC.x&&(this.mLastRC.y=this.MAP_COL-1),this.mLastRC.x-=1),this.checkEmptyLine(),this.addMapRecord(t,e),this.getAllCubes().length<=0)break;for(s=this.mergeMap(!1);s.length<=0&&i>0;)this.addNewNumbers(),this.addMapRecord(t,e),i-=1,s=this.mergeMap(!1)}var l=this.getAllCubes();t?(this.mDataList[e].leftNum_2=l.length,this.mDataList[e].copyTimes_2=this.mAddCount-i,this.mDataList[e].passPercent_2<=0&&(this.mDataList[e].passPercent_2=0),this.mDataList[e].passPercent_2+=0==l.length?1:0):(this.mDataList[e].leftNum_1=l.length,this.mDataList[e].copyTimes_1=this.mAddCount-i,this.mDataList[e].passPercent_1<=0&&(this.mDataList[e].passPercent_1=0),this.mDataList[e].passPercent_1+=0==l.length?1:0)}},NewClass.prototype.addMapRecord=function(t,e){t?this.mDataList[e].prcessCubes_2.push(deepClone(this.mMapData)):this.mDataList[e].prcessCubes_1.push(deepClone(this.mMapData))},NewClass.prototype.checkEmptyLine=function(){for(var t=1;t<this.MAP_ROW;++t){for(var e=!0,a=0;a<this.MAP_COL;++a)if(this.mMapData[t]&&this.mMapData[t][a]){e=!1;break}if(!e){for(var i=0,s=t-1;s>=0;--s){var o=!0;for(a=0;a<this.MAP_COL;++a)if(this.mMapData[s][a]){o=!1;break}if(!o)break;i++}if(i>0){for(var r=t;r<this.MAP_ROW;++r)for(a=0;a<this.MAP_COL;++a)if(this.mMapData[r]){var n=r-i;this.mMapData[n][a]=this.mMapData[r][a],this.mMapData[r][a]=null,this.mMapData[n][a]&&(this.mMapData[n][a].row=n)}t-=i}}}},NewClass.prototype.addNewNumbers=function(){for(var t=this.getAllCubes(),e=0,a=this.mLastRC,i=this.mLastRC.x;i<this.MAP_ROW;++i)for(var s=i==this.mLastRC.x?this.mLastRC.y+1:0;s<this.MAP_COL;++s){this.mMapData[i]||(this.mMapData[i]=[]);var o=t[e++],r=new NumberCube;r.row=i,r.col=s,r.num=o.num,this.mMapData[i][s]=r,a.x=i,a.y=s,e>=t.length&&(i=this.MAP_ROW,s=this.MAP_COL)}this.mLastRC=a},NewClass.prototype.showToast=function(t){var e=document.createElement("div");e.innerHTML=t,e.style.cssText="width:40%; min-width:180px; background:#000; opacity:0.8; height:auto;min-height: 50px; color:#fff; line-height:200px; font-size:60; text-align:center; border-radius:4px; position:fixed; top:60%; left:30%; z-index:999999;",document.body.appendChild(e),setTimeout(function(){e.style.webkitTransition="-webkit-transform 0.5s ease-in, opacity 0.5s ease-in",e.style.opacity="0",setTimeout(function(){document.body.removeChild(e)},500)},3e3)},NewClass.prototype.onBtnSpecialClicked=function(){var t=Number(this.inputSpecialLeft.string);if(isNaN(t)||t<=0||t>7||t%2==0)alert("\u5269\u4f59\u6570\u91cf\u53ea\u80fd\u53d6 1\u30013\u30015\u30017");else{var e=Number(this.inputSpeciaTotal.string);isNaN(e)||e<=0?alert("\u53c2\u6570\u975e\u6cd5"):(this.mSetLeftNum=t,this.mSpecialCount=e,this.clearMap(),this.createMap2(),this.initScrollView(),alert("\u751f\u6210\u9635\u578b\u6210\u529f, \u5171\u751f\u6210"+this.mDataList.length+"\u7ec4\u6570\u636e\uff01"))}},NewClass.prototype.challengeMapCreate=function(){for(var t=new Array,e=1;e<=9;++e)t.push(e),0==cc.math.randomRangeInt(0,2)?t.push(e):t.push(10-e);var a=9-this.mSetLeftNum;for(a/=2;a>0;){a--;var i=cc.math.randomRangeInt(1,10),s=i;0==cc.math.randomRangeInt(0,2)&&(s=10-i),t.push(i),t.push(s)}for(e=0;e<this.mSetLeftNum;++e)t.push(cc.math.randomRangeInt(1,10));for(t.sort(function(){return.5-Math.random()}),this.mMapData=[],e=0;e<t.length;++e){var o=Math.floor(e/this.MAP_COL),r=e%this.MAP_COL;this.mMapData[o]||(this.mMapData[o]=[]);var n=new NumberCube;n.row=o,n.col=r,n.num=t[e],this.mMapData[o].push(n)}},NewClass.prototype.createMap2=function(){this.mDataList=[];for(var t=0,e=0;e<this.mSpecialCount&&t<1e5;++e){t++,this.challengeMapCreate();var a=new CubeData;a.cubes=deepClone(this.mMapData),a.mergeList=(new Array).fill([]),a.mergeList=[];for(var i=this.getAllCubes(),s=0;s<i.length;++s)for(var o=0;o<i.length;++o)if(s!=o){var r=i[s].row,n=i[s].col,l=i[o].row,h=i[o].col;if(this.mMapData[r][n]&&this.mMapData[l][h])for(var c=0;c<a.mergeList.length;++c){var m=a.mergeList[c][0],p=a.mergeList[c][1];if(m.x==i[s].row&&m.y==i[s].col||m.x==i[o].row&&m.y==i[o].col)break;if(p.x==i[s].row&&p.y==i[s].col||p.x==i[o].row&&p.y==i[o].col)break}}if(e%2!=0){var u=deepClone(a.cubes);for(s=0;s<this.mRows;++s)for(o=0;o<u[s].length;++o){var d=this.mRows-s-1,_=u[s].length-o-1;a.cubes[d][_]=u[s][o],a.cubes[d][_].row=d,a.cubes[d][_].col=_}for(c=0;c<a.mergeList.length;++c)a.mergeList[c][0].x=this.mRows-a.mergeList[c][0].x-1,a.mergeList[c][0].y=this.MAP_COL-a.mergeList[c][0].y-1,a.mergeList[c][1].x=this.mRows-a.mergeList[c][1].x-1,a.mergeList[c][1].y=this.MAP_COL-a.mergeList[c][1].y-1}this.mDataList.push(a)}this.mDataList.sort(function(t,e){return t.mergeList.length-e.mergeList.length})},NewClass.prototype.onBtnNewVersionClicked=function(){cc.director.loadScene("map2")},__decorate([property({type:cc.Node})],NewClass.prototype,"mapBg",void 0),__decorate([property({type:cc.EditBox})],NewClass.prototype,"inputNumber",void 0),__decorate([property({type:cc.EditBox})],NewClass.prototype,"inputCount",void 0),__decorate([property({type:cc.EditBox})],NewClass.prototype,"inputLink",void 0),__decorate([property({type:cc.EditBox})],NewClass.prototype,"inputAdd",void 0),__decorate([property({type:cc.Button})],NewClass.prototype,"btnDone",void 0),__decorate([property({type:cc.Button})],NewClass.prototype,"btnCopy",void 0),__decorate([property({type:cc.Node})],NewClass.prototype,"cubeNode",void 0),__decorate([property({type:cc.Node})],NewClass.prototype,"mTipsDialog",void 0),__decorate([property({type:cc.Node})],NewClass.prototype,"mPercentDialog",void 0),__decorate([property({type:cc.Label})],NewClass.prototype,"mLabelPercent",void 0),__decorate([property({type:cc.EditBox})],NewClass.prototype,"inputSpecialLeft",void 0),__decorate([property({type:cc.EditBox})],NewClass.prototype,"inputSpeciaTotal",void 0),__decorate([property({type:List_1.default})],NewClass.prototype,"listV",void 0),__decorate([property({type:cc.Label})],NewClass.prototype,"labelLeft_1",void 0),__decorate([property({type:cc.Label})],NewClass.prototype,"labelLeft_2",void 0),NewClass=__decorate([ccclass],NewClass),NewClass}(cc.Component);exports.default=NewClass,cc._RF.pop()},{"./List":"List"}],map2:[function(require,module,exports){"use strict";cc._RF.push(module,"1358fQ7WI5PDISjXW2/y6xv","map2");var __extends=this&&this.__extends||(extendStatics=function(t,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),extendStatics,__decorate=this&&this.__decorate||function(t,e,a,i){var s,o=arguments.length,r=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,a):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,i);else for(var n=t.length-1;n>=0;n--)(s=t[n])&&(r=(o<3?s(r):o>3?s(e,a,r):s(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(exports,"__esModule",{value:!0});var List_1=require("./List"),_a=cc._decorator,ccclass=_a.ccclass,property=_a.property,IntVec2=function(t,e){this.x=0,this.y=0,this.x=t,this.y=e},NumberCube=function(){function t(){this.row=0,this.col=0,this.num=0}return t.prototype.getRowCol=function(){return new IntVec2(this.row,this.col)},t}(),deepArray=function(t){return t.map(deepClone)},deepObject=function(t){var e=Object.keys(t),a={};return e.forEach(function(e){a[e]=deepClone(t[e])}),a},deepClone=function(t){if(null===t||!t)return t;if("[object Object]"===Object.prototype.toString.call(t)){var e={};return Object.keys(t).forEach(function(a){t[a]&&"object"==typeof t[a]?e[a]=deepClone(t[a]):e[a]=t[a]}),e}if(Array.isArray(t)){var a=[];return t.forEach(function(t,e){a[e]=t&&"object"==typeof t?deepClone(t):t}),a}},CubeData=function(){this.prcessCubes_1=[],this.prcessCubes_2=[],this.mergeLvl1=0,this.mergeLvl2=0,this.mergeLvl3=0,this.comboNum=0,this.comboTimes=0,this.maxCombo=0,this.passPercent=-1,this.copyTimeAvg=0,this.headTailNum=0,this.mergeLvl1_2=0,this.mergeLvl2_2=0,this.mergeLvl3_2=0,this.comboNum_2=0,this.comboTimes_2=0,this.maxCombo_2=0,this.passPercent_2=-1,this.copyTimeAvg_2=0,this.headTailNum_2=0},NewClass=function(_super){function NewClass(){var t=null!==_super&&_super.apply(this,arguments)||this;return t.mapBg=null,t.input_Line_1=null,t.input_Line_2=null,t.input_Line_3=null,t.input_Total_Count=null,t.input_calc_count=null,t.btnDone=null,t.btnCopy=null,t.cubeNode=null,t.mPercentDialog=null,t.mLabelPercent=null,t.listV=null,t.labelLeft_1=null,t.labelLeft_2=null,t.mRows=3,t.MAP_ROW=96,t.MAP_COL=9,t.mFistLineNum=0,t.mSecLineNum=0,t.mThirdLineNum=0,t.mNumberPool=[],t.mNeedLink=!1,t.mLinkPercent=0,t.mAddCount=0,t.mTargetNumber=1,t.mTargetCount=10,t.mCalcCount=5,t.mNowShowIdx=0,t.mNowShowStep=0,t.mSetLeftNum=0,t.mSpecialCount=10,t}return __extends(NewClass,_super),NewClass.prototype.start=function(){this.mDataList=[]},NewClass.prototype.clearMapData=function(){this.mMapData=new Array(this.MAP_ROW);for(var t=0;t<this.MAP_ROW;++t){this.mMapData[t]=new Array(this.MAP_COL);for(var e=0;e<this.MAP_COL;++e)this.mMapData[t][e]=null}},NewClass.prototype.onBtnDoneClicked=function(){var t=Number(this.input_Line_1.string);if(isNaN(t)||t<=0||t>4)alert("\u7b2c\u4e00\u884c\u5bf9\u6570\u53ea\u80fd\u4e3a\uff1a1-4\uff01");else{var e=Number(this.input_Line_2.string);if(isNaN(e)||e<=0||e>4)alert("\u7b2c\u4e8c\u884c\u5bf9\u6570\u53ea\u80fd\u4e3a\uff1a1-4\uff01");else{var a=Number(this.input_Line_3.string);if(isNaN(a)||a<=0||a>2*t)alert("\u7b2c\u4e09\u884c\u914d\u5bf9\u6570\u4e0d\u80fd\u5927\u4e8e\u7b2c\u4e00\u884c\u5bf9\u6570x2!");else{var i=Number(this.input_Total_Count.string);isNaN(i)||i<=0||i>1e4?alert("\u6570\u636e\u603b\u91cf\u53ea\u80fd\u4e3a\uff1a1-10000\uff01"):(this.mFistLineNum=t,this.mSecLineNum=e,this.mThirdLineNum=a,this.clearMap(),this.mTargetNumber=0,this.mTargetCount=i,this.mLinkPercent=0,this.mLinkPercent>0&&(this.mNeedLink=!0),this.createMap(),this.initScrollView(),alert("\u751f\u6210\u9635\u578b\u6210\u529f, \u5171\u751f\u6210"+this.mDataList.length+"\u7ec4\u6570\u636e\uff01"))}}}},NewClass.prototype.onBtnCopyClicked=function(){if(this.mDataList.length<=0)alert("\u5bf9\u4e0d\u8d77\uff0c\u672a\u627e\u5230\u53ef\u590d\u5236\u9635\u578b\uff01");else{for(var t="\u53ef\u5408\u5e76\u4e2a\u6570\t\u9635\u578b\u914d\u7f6e\n",e=0;e<this.mDataList.length;++e){for(var a=this.mDataList[e].mergeList.length+" \t[",i=this.mDataList[e].cubes,s=0;s<this.mRows;++s){for(var o=0;o<i[s].length;++o)a+=i[s][o].num,o<i[s].length-1&&(a+=",");s<this.mRows-1&&(a+=",")}t+=a+="]\n"}navigator.clipboard.writeText(t),this.showToast("\u590d\u5236\u5230\u526a\u5207\u677f\u6210\u529f\uff01")}},NewClass.prototype.onBtnLoad=function(event,customEventData){var _this=this,addNum=5;this.mAddCount=addNum,this.mDataList=[],this.clearMapData(),this.clearMap(),navigator.clipboard.readText().then(function(text){for(var str=text.toString(),data=str.split("\n"),i=0;i<data.length;++i){var arr=data[i];arr=eval(arr);var cData=new CubeData;cData.cubes=[],cData.mergeList=[];for(var j=0;j<arr.length;++j){var row=Math.floor(j/_this.MAP_COL),col=j%_this.MAP_COL;cData.cubes[row]||(cData.cubes[row]=[]);var cube=new NumberCube;cube.row=row,cube.col=col,cube.num=Number(arr[j]),cData.cubes[row][col]=cube}_this.clearMapData(),_this.mMapData=deepClone(cData.cubes);var merListTmp=_this.mergeMap(!0);_this.clearMapData(),merListTmp&&merListTmp.length>0&&(cData.mergeList=deepClone(merListTmp)),_this.mDataList.push(cData)}_this.initScrollView(),alert("\u4e0a\u4f20\u6570\u636e"+_this.mDataList.length+"\u6761")}).catch(function(t){console.error("Failed to read clipboard contents: ",t),_this.showToast("\u4e0a\u4f20\u6570\u636e\u51fa\u9519\uff01")})},NewClass.prototype.onBtnCalc=function(){if(!this.mDataList||this.mDataList.length<=0)alert("\u6570\u636e\u9519\u8bef\uff01");else try{this.calcAllCubeDatas(!1),this.calcAllCubeDatas(!0),this.clearPassPercent(),alert("\u8ba1\u7b97\u6570\u636e\u5b8c\u6bd5\uff01")}catch(t){console.log(t),alert("\u8ba1\u7b97\u6570\u636e\u51fa\u9519\uff01")}},NewClass.prototype.onBtnCalcPass=function(){var t=this;if(!this.mDataList||this.mDataList.length<=0)alert("\u6570\u636e\u9519\u8bef\uff01");else{var e=Number(this.input_calc_count.string);if(isNaN(e)||e<=0||e>1e3)alert("\u8ba1\u7b97\u6b21\u6570\u53c2\u6570\u53ea\u80fd\u4e3a\uff1a1-1000\uff01");else{this.mCalcCount=e;try{this.clearPassPercent(),this.mPercentDialog.active=!0,this.mLabelPercent.string="\u8ba1\u7b97\u8fdb\u5ea6\uff1a0%";var a=0,i=setInterval(function(){if(a>=t.mCalcCount)return clearInterval(i),t.mPercentDialog.active=!1,void alert("\u8ba1\u7b97\u901a\u5173\u7387\u5b8c\u6bd5\uff01");for(var e=0;e<t.mDataList.length;++e)t.mDataList[e].prcessCubes_1=[],t.mDataList[e].prcessCubes_2=[];t.calcAllCubeDatas(!1),t.calcAllCubeDatas(!0),t.mLabelPercent.string="\u8ba1\u7b97\u8fdb\u5ea6\uff1a"+(a+1)*(100/t.mCalcCount)+"%",a++},10)}catch(s){console.log(s),this.mPercentDialog.active=!1,alert("\u8ba1\u7b97\u6570\u636e\u51fa\u9519\uff01")}}}},NewClass.prototype.clearPassPercent=function(){if(this.mDataList&&!(this.mDataList.length<=0))for(var t=0;t<this.mDataList.length;++t)this.mDataList[t].passPercent=-1,this.mDataList[t].passPercent_2=-1},NewClass.prototype.clearMap=function(){for(var t=this.mapBg.children,e=0;e<t.length;++e)t[e].destroy()},NewClass.prototype.onBtnItemClicked=function(t){var e=t.target._listId;this.mNowShowIdx=e,this.mNowShowStep=0;var a=this.mDataList[e].cubes,i=this.mDataList[e].mergeList;this.clearMap();for(var s=0;s<a.length;++s)for(var o=0;o<a[s].length;++o)if(a[s][o]){for(var r=!1,n=0;n<i.length;++n)(i[n][0].x==a[s][o].row&&i[n][0].y==a[s][o].col||i[n][1].x==a[s][o].row&&i[n][1].y==a[s][o].col)&&(r=!0);this.addCube(a[s][o],r)}},NewClass.prototype.onBtnRecodClicked=function(t,e){if(!(this.mDataList.length<=0)){var a;!(a=deepClone("11"==e||"12"==e||"13"==e?this.mDataList[this.mNowShowIdx].prcessCubes_1:this.mDataList[this.mNowShowIdx].prcessCubes_2))||a.length<=0||("11"==e||"21"==e?this.mNowShowStep>0&&this.mNowShowStep--:"12"==e||"22"==e?this.mNowShowStep=0:"13"!=e&&"23"!=e||this.mNowShowStep<a.length-1&&this.mNowShowStep++,this.mNowShowStep<0&&(this.mNowShowStep=0),this.mNowShowStep>=a.length&&(this.mNowShowStep=a.length-1),this.fillMap(a[this.mNowShowStep]))}},NewClass.prototype.fillMap=function(t){this.clearMap();for(var e=0;e<t.length;++e)for(var a=0;a<t[e].length;++a)t[e][a]&&this.addCube(t[e][a],!1)},NewClass.prototype.addCube=function(t,e){var a=t.row,i=t.col,s=t.num,o=cc.instantiate(this.cubeNode);o.getChildByName("bg").active=e,cc.resources.load("nums/"+s,cc.SpriteFrame,function(t,e){t&&console.log(t),o.getChildByName("num").getComponent(cc.Sprite).spriteFrame=e}),o.setPosition((i+.5)*(654/9),72.5*-(a+.5)),this.mapBg.addChild(o)},NewClass.prototype.onBtnDownLoad=function(){if(!this.mDataList||this.mDataList.length<=0)alert("\u5bf9\u4e0d\u8d77\uff0c\u6570\u636e\u9519\u8bef\uff01");else{for(var t="\u4e00\u7ea7\u6d88\u9664\t\u4e8c\u7ea7\u6d88\u9664\t\u4e09\u7ea7\u6d88\u9664\tcombo\u89e6\u53d1\u5e73\u5747\u6b21\u6570\t\u6700\u5927combo\u6b21\u6570\t\u901a\u5173\u7387\t\u5e73\u5c40\u590d\u5236\u6b21\u6570\t\u9996\u5c3e\u89e6\u53d1\u6b21\u6570\t\u4e00\u7ea7\u6d88\u9664_2\t\u4e8c\u7ea7\u6d88\u9664_2\t\u4e09\u7ea7\u6d88\u9664_2\tcombo\u89e6\u53d1\u5e73\u5747\u6b21\u6570_2\t\u6700\u5927combo\u6b21\u6570_2\t\u901a\u5173\u7387_2\t\u5e73\u5c40\u590d\u5236\u6b21\u6570_2\t\u9996\u5c3e\u89e6\u53d1\u6b21\u6570_2\n",e=0;e<this.mDataList.length;++e){var a="";a+=this.mDataList[e].mergeLvl1/this.mCalcCount+"\t",a+=this.mDataList[e].mergeLvl2/this.mCalcCount+"\t",a+=this.mDataList[e].mergeLvl3/this.mCalcCount+"\t",console.log("comboNum = "+this.mDataList[e].comboNum),console.log("comboTimes = "+this.mDataList[e].comboTimes),console.log("maxCombo = "+this.mDataList[e].maxCombo),console.log("comboNum_2 = "+this.mDataList[e].comboNum_2),console.log("comboTimes_2 = "+this.mDataList[e].comboTimes_2),console.log("maxCombo_2 = "+this.mDataList[e].maxCombo_2),this.mDataList[e].comboTimes>0?a+=this.mDataList[e].comboNum/this.mDataList[e].comboTimes+"\t":a+="0\t",a+=this.mDataList[e].maxCombo+"\t",a+=this.mDataList[e].passPercent*(100/this.mCalcCount)+"\t",a+=this.mDataList[e].copyTimeAvg/this.mCalcCount+"\t",a+=this.mDataList[e].headTailNum/this.mCalcCount+"\t",a+=this.mDataList[e].mergeLvl1_2/this.mCalcCount+"\t",a+=this.mDataList[e].mergeLvl2_2/this.mCalcCount+"\t",a+=this.mDataList[e].mergeLvl3_2/this.mCalcCount+"\t",this.mDataList[e].comboTimes_2>0?a+=this.mDataList[e].comboNum_2/this.mDataList[e].comboTimes_2+"\t":a+="0\t",a+=this.mDataList[e].maxCombo_2+"\t",a+=this.mDataList[e].passPercent_2*(100/this.mCalcCount)+"\t",a+=this.mDataList[e].copyTimeAvg_2/this.mCalcCount+"\t",t+=a+=this.mDataList[e].headTailNum_2/this.mCalcCount+"\n"}navigator.clipboard.writeText(t),this.showToast("\u590d\u5236\u5230\u526a\u5207\u677f\u6210\u529f\uff01")}},NewClass.prototype.initNumberPool=function(){if(this.mNumberPool.length<=0)for(var t=0;t<this.MAP_COL;++t)this.mNumberPool.push(t+1)},NewClass.prototype.initMapData=function(){this.clearMapData();for(var t=[],e=0;e<this.MAP_COL;e++)t.push(e);t.sort(function(){return.5-Math.random()}),this.mNumberPool=[];var a=0;for(e=0;e<this.MAP_COL&&a<this.mFistLineNum;++e){var i=0,s=t[e];if(!this.mMapData[i][s]){a++,this.initNumberPool();var o=cc.math.randomRangeInt(0,this.mNumberPool.length),r=this.mNumberPool[o];this.mNumberPool.splice(o,1),this.mMapData[i][s]=new NumberCube,this.mMapData[i][s].row=i,this.mMapData[i][s].col=s,this.mMapData[i][s].num=r;for(var n=[],l=s+2;l<this.MAP_COL;++l)this.mMapData[i][l]||n.push(l);for(l=s-2;l>=0;--l)this.mMapData[i][l]||n.push(l);n.length>0&&(l=cc.math.randomRangeInt(0,n.length),this.mMapData[i][l]=new NumberCube,this.mMapData[i][l].row=i,this.mMapData[i][l].col=l,this.mMapData[i][l].num=r,1==cc.math.randomRangeInt(0,2)&&(this.mMapData[i][l].num=10-r))}}for(t.sort(function(){return.5-Math.random()}),a=0,e=0;e<this.MAP_COL&&a<this.mSecLineNum;++e)if(i=1,s=t[e],!this.mMapData[i][s]){for(a++,this.initNumberPool(),o=cc.math.randomRangeInt(0,this.mNumberPool.length),r=this.mNumberPool[o],this.mNumberPool.splice(o,1),this.mMapData[i][s]=new NumberCube,this.mMapData[i][s].row=i,this.mMapData[i][s].col=s,this.mMapData[i][s].num=r,n=[],l=s+2;l<this.MAP_COL;++l)this.mMapData[i][l]||n.push(l);for(l=s-2;l>=0;--l)this.mMapData[i][l]||n.push(l);n.length>0&&(l=cc.math.randomRangeInt(0,n.length),this.mMapData[i][l]=new NumberCube,this.mMapData[i][l].row=i,this.mMapData[i][l].col=l,this.mMapData[i][l].num=r,1==cc.math.randomRangeInt(0,2)&&(this.mMapData[i][l].num=10-r))}for(t=[],e=0;e<this.MAP_COL&&t.length<=this.mThirdLineNum;e++)if(e%2==0){var h=0;this.mMapData[0][e]&&h++,this.mMapData[0][e+1]&&h++,e+1<this.MAP_COL&&h>0&&(t.push(.2-Math.random()>0?e:e+1),.2-Math.random()>0?(t.push(e+1),h>1&&t.push(e)):(t.push(e),h>1&&t.push(e+1)))}var c=0;for(e=0;e<this.MAP_COL&&c<t.length;++e)i=2,this.mMapData[0][e]&&(s=t[c],this.mMapData[i][s]=new NumberCube,this.mMapData[i][s].row=i,this.mMapData[i][s].col=s,this.mMapData[i][s].num=this.mMapData[0][e].num,c++);var m=[];for(e=0;e<3;++e)for(var p=0;p<this.MAP_COL;++p)this.mMapData[e][p]||m.push(new IntVec2(e,p));for(var u=0,d=0;m.length>0;){var _=m[0];this.mMapData[_.x][_.y]=new NumberCube,this.mMapData[_.x][_.y].row=_.x,this.mMapData[_.x][_.y].col=_.y,this.mMapData[_.x][_.y].num=cc.math.randomRangeInt(1,10),this.initNumberPool(),o=cc.math.randomRangeInt(0,this.mNumberPool.length);var f=.5>Math.random()?d:10-d;if(this.mMapData[_.x][_.y].num=u%2==1?f:this.mNumberPool[o],this.canSingleCubeMerge(_))for(o=-1,e=0;e<this.mNumberPool.length&&(o=e,this.mMapData[_.x][_.y].num=this.mNumberPool[e],this.canSingleCubeMerge(_));++e);var y=!1;if(o<0)for(e=1;e<10;++e)if(this.mMapData[_.x][_.y].num=e,!this.canSingleCubeMerge(_)){y=!0;break}o<0&&!y&&(u%2==1?(this.mMapData[_.x][_.y].num=f,o=-1):(o=cc.math.randomRangeInt(0,this.mNumberPool.length),this.mMapData[_.x][_.y].num=this.mNumberPool[o])),o>=0&&this.mNumberPool.splice(o,1),d=this.mMapData[_.x][_.y].num,m.splice(0,1),u++}},NewClass.prototype.getAllCubes=function(){for(var t=[],e=0;e<this.MAP_ROW;++e)for(var a=0;a<this.MAP_COL;++a)if(this.mMapData[e]&&this.mMapData[e][a]){var i=new NumberCube;i.row=this.mMapData[e][a].row,i.col=this.mMapData[e][a].col,i.num=this.mMapData[e][a].num,t.push(i)}return t},NewClass.prototype.createMap=function(){this.mDataList=[];for(var t=0,e=0;e<this.mTargetCount&&t<1e5;++e){t++,this.initMapData();var a=new CubeData;a.cubes=deepClone(this.mMapData),a.mergeList=(new Array).fill([]),a.mergeList=[],this.mDataList.push(a)}},NewClass.prototype.mergeMap=function(t){for(var e=[],a=this.getAllCubes(),i=0;i<a.length;++i)for(var s=0;s<a.length;++s)if(i!=s){var o=a[i].row,r=a[i].col,n=a[s].row,l=a[s].col;if(null!=this.mMapData[o][r]&&null!=this.mMapData[n][l]){for(var h=!1,c=0;c<e.length;++c){var m=e[c][0],p=e[c][1];if(m.x==a[i].row&&m.y==a[i].col||m.x==a[s].row&&m.y==a[s].col){h=!0;break}if(p.x==a[i].row&&p.y==a[i].col||p.x==a[s].row&&p.y==a[s].col){h=!0;break}}h||this.canCubeMerge(a[i].getRowCol(),a[s].getRowCol())&&(e.push([a[i].getRowCol(),a[s].getRowCol()]),t&&(this.mMapData[o][r]=null,this.mMapData[n][l]=null),i=0,s=0)}}return e},NewClass.prototype.getOptimalIndex=function(t,e){var a=-1;if(!t||t.length<=0)return a;a=cc.math.randomRangeInt(0,t.length);var i=!1;if(e)for(var s=0;s<t.length;++s){var o=t[s][0],r=t[s][1];if(2==o.x||3==o.x||2==r.x||3==r.x){i=!0,a=s;break}}if(!i)for(s=0;s<t.length;++s){if(o=t[s][0],r=t[s][1],o.x==r.x&&2==this.getRowCubes(o.x)){i=!0,a=s;break}if(1==this.getRowCubes(o.x)||1==this.getRowCubes(r.x)){i=!0,a=s;break}}return a},NewClass.prototype.getRowCubes=function(t){for(var e=0,a=0;a<this.MAP_COL;++a){var i=new IntVec2(t,a);this.isValidRowCol(i)&&e++}return e},NewClass.prototype.getCubeRoundRC=function(t){var e=new Array;if(!this.isValidRowCol(t))return e;var a=new IntVec2(t.x-1,t.y-1);return this.isValidRowCol(a)&&e.push(a),a=new IntVec2(t.x-1,t.y),this.isValidRowCol(a)&&e.push(a),a=new IntVec2(t.x-1,t.y+1),this.isValidRowCol(a)&&e.push(a),a=new IntVec2(t.x,t.y-1),this.isValidRowCol(a)&&e.push(a),a=new IntVec2(t.x,t.y+1),this.isValidRowCol(a)&&e.push(a),a=new IntVec2(t.x+1,t.y-1),this.isValidRowCol(a)&&e.push(a),a=new IntVec2(t.x+1,t.y),this.isValidRowCol(a)&&e.push(a),a=new IntVec2(t.x+1,t.y+1),this.isValidRowCol(a)&&e.push(a),e},NewClass.prototype.initScrollView=function(){this.listV.numItems=this.mDataList.length},NewClass.prototype.isValidRowCol=function(t){return!(t.x<0||t.x>=this.MAP_ROW||t.y<0||t.y>=this.MAP_COL||!this.mMapData[t.x][t.y])},NewClass.prototype.isRowColEqual=function(t,e){return t.x==e.x&&t.y==e.y},NewClass.prototype.canCubeMerge=function(t,e){if(!this.isValidRowCol(t)||!this.isValidRowCol(e)||this.isRowColEqual(t,e))return!1;var a=this.mMapData[t.x][t.y],i=this.mMapData[e.x][e.y];if(!a||!i)return!1;var s=a.num+i.num==10,o=a.num==i.num;if(!s&&!o)return!1;var r=[];if(t.x==e.x)for(var n=Math.min(t.y,e.y),l=Math.max(t.y,e.y),h=n+1;h<l;++h)(u=this.mMapData[t.x][h])&&r.push(u);else if(t.y==e.y){var c=Math.min(t.x,e.x),m=Math.max(t.x,e.x);for(h=c+1;h<m;++h)(u=this.mMapData[h][t.y])&&r.push(u)}else if(t.x<e.x&&t.y<e.y&&e.x-t.x==e.y-t.y){h=t.x+1;for(var p=t.y+1;h<e.x&&p<e.y;++h,++p)(u=this.mMapData[h][p])&&r.push(u)}else if(t.x>e.x&&t.y<e.y&&t.x-e.x==e.y-t.y)for(h=t.x-1,p=t.y+1;h>e.x&&p<e.y;--h,++p)(u=this.mMapData[h][p])&&r.push(u);else if(t.x>e.x&&t.y>e.y&&t.x-e.x==t.y-e.y)for(h=t.x-1,p=t.y-1;h>e.x&&p>e.y;--h,--p)(u=this.mMapData[h][p])&&r.push(u);else if(t.x<e.x&&t.y>e.y&&e.x-t.x==t.y-e.y)for(h=t.x+1,p=t.y-1;h<e.x&&p>e.y;++h,--p)(u=this.mMapData[h][p])&&r.push(u);else if(t.x<e.x){for(p=t.y+1;p<this.MAP_COL;++p)(u=this.mMapData[t.x][p])&&r.push(u);for(h=t.x+1;h<e.x;++h)for(p=0;p<this.MAP_COL;++p)(u=this.mMapData[h][p])&&r.push(u);for(p=0;p<e.y;++p)(u=this.mMapData[e.x][p])&&r.push(u)}else if(t.x>e.x){for(p=t.y-1;p>=0;--p)(u=this.mMapData[t.x][p])&&r.push(u);for(h=t.x-1;h>e.x;--h)for(p=this.MAP_COL-1;p>=0;--p)(u=this.mMapData[h][p])&&r.push(u);for(p=this.MAP_COL-1;p>e.y;--p){var u;(u=this.mMapData[e.x][p])&&r.push(u)}}return 0==r.length},NewClass.prototype.canSingleCubeMerge=function(t){for(var e=this.getAllCubes(),a=0;a<e.length;++a)if(this.canCubeMerge(t,e[a].getRowCol()))return!0;return!1},NewClass.prototype.onListVRender=function(t,e){for(var a=this.mDataList[e],i=cc.find("bg/labelData",t),s=e+1+"-"+a.mergeList.length+"--[",o=a.cubes,r=0;r<this.mRows;++r){for(var n=0;n<o[r].length;++n)s+=o[r][n].num,n<o[r].length-1&&(s+=",");r<this.mRows-1?s+=",":s+="]"}i.getComponent(cc.Label).string=s},NewClass.prototype.calcAllCubeDatas=function(t){if(!this.mDataList||this.mDataList.length<=0)alert("\u6570\u636e\u51fa\u9519\uff0c\u8bf7\u91cd\u65b0\u4e0a\u4f20\uff01");else for(var e=0;e<this.mDataList.length;++e){var a=this.mDataList[e];this.clearMapData(),this.mMapData=deepClone(a.cubes),this.mLastRC=new IntVec2(2,this.MAP_COL-1),t&&this.addNewNumbers(),this.calcMergeLevel(e,t),this.clearMapData(),this.mMapData=deepClone(a.cubes),this.addMapRecord(t,e),this.mLastRC=new IntVec2(2,this.MAP_COL-1);var i=this.mAddCount;t&&i>0&&(this.addNewNumbers(),this.mDataList[e].copyTimeAvg_2+=1,i-=1,this.addMapRecord(t,e));for(var s=0,o=0,r=this.mergeMap(!1);r.length>0;){var n=this.getOptimalIndex(r,t&&i==this.mAddCount-1),l=r[n][0],h=r[n][1];this.isHeadTails(l,h)&&(t?this.mDataList[e].headTailNum_2+=1:this.mDataList[e].headTailNum+=1),this.mMapData[l.x][l.y]=null,this.mMapData[h.x][h.y]=null;var c=!1;if(this.getRowCubes(l.x)<=0&&(l.x==this.mLastRC.x&&(this.mLastRC.y=this.MAP_COL-1),this.mLastRC.x-=1,c=!0),l.x!=h.x&&this.getRowCubes(h.x)<=0&&(h.x==this.mLastRC.x&&(this.mLastRC.y=this.MAP_COL-1),this.mLastRC.x-=1,c=!0),c?s+=1:s=0,s>1&&o++,this.checkEmptyLine(),this.addMapRecord(t,e),this.getAllCubes().length<=0)break;for(r=this.mergeMap(!1);r.length<=0&&i>0;)this.addNewNumbers(),t?this.mDataList[e].copyTimeAvg_2+=1:this.mDataList[e].copyTimeAvg+=1,this.addMapRecord(t,e),i-=1,r=this.mergeMap(!1)}var m=this.getAllCubes();t?(this.mDataList[e].passPercent_2<=0&&(this.mDataList[e].passPercent_2=0),this.mDataList[e].passPercent_2+=0==m.length?1:0):(this.mDataList[e].passPercent<=0&&(this.mDataList[e].passPercent=0),this.mDataList[e].passPercent+=0==m.length?1:0),t?0==m.length&&(this.mDataList[e].comboNum_2+=o,this.mDataList[e].maxCombo_2=Math.max(this.mDataList[e].maxCombo_2,o),this.mDataList[e].comboTimes_2+=1):0==m.length&&(this.mDataList[e].comboNum+=o,this.mDataList[e].maxCombo=Math.max(this.mDataList[e].maxCombo,o),this.mDataList[e].comboTimes+=1)}},NewClass.prototype.calcMergeLevel=function(t,e){var a=this.mergeMap(!1);e?this.mDataList[t].mergeLvl1_2+=a.length:this.mDataList[t].mergeLvl1+=a.length;for(var i=0;i<a.length;++i){var s=(r=a[i])[0],o=r[1];this.mMapData[s.x][s.y]=null,this.mMapData[o.x][o.y]=null}for(a=this.mergeMap(!1),e?this.mDataList[t].mergeLvl2_2+=a.length:this.mDataList[t].mergeLvl2+=a.length,i=0;i<a.length;++i){var r;s=(r=a[i])[0],o=r[1],this.mMapData[s.x][s.y]=null,this.mMapData[o.x][o.y]=null}a=this.mergeMap(!1),e?this.mDataList[t].mergeLvl3_2+=a.length:this.mDataList[t].mergeLvl3+=a.length},NewClass.prototype.addMapRecord=function(t,e){t?this.mDataList[e].prcessCubes_2.push(deepClone(this.mMapData)):this.mDataList[e].prcessCubes_1.push(deepClone(this.mMapData))},NewClass.prototype.checkEmptyLine=function(){for(var t=1;t<this.MAP_ROW;++t){for(var e=!0,a=0;a<this.MAP_COL;++a)if(this.mMapData[t]&&this.mMapData[t][a]){e=!1;break}if(!e){for(var i=0,s=t-1;s>=0;--s){var o=!0;for(a=0;a<this.MAP_COL;++a)if(this.mMapData[s][a]){o=!1;break}if(!o)break;i++}if(i>0){for(var r=t;r<this.MAP_ROW;++r)for(a=0;a<this.MAP_COL;++a)if(this.mMapData[r]){var n=r-i;this.mMapData[n][a]=this.mMapData[r][a],this.mMapData[r][a]=null,this.mMapData[n][a]&&(this.mMapData[n][a].row=n)}t-=i}}}},NewClass.prototype.addNewNumbers=function(){for(var t=this.getAllCubes(),e=0,a=this.mLastRC,i=this.mLastRC.x;i<this.MAP_ROW;++i)for(var s=i==this.mLastRC.x?this.mLastRC.y+1:0;s<this.MAP_COL;++s){this.mMapData[i]||(this.mMapData[i]=[]);var o=t[e++],r=new NumberCube;r.row=i,r.col=s,r.num=o.num,this.mMapData[i][s]=r,a.x=i,a.y=s,e>=t.length&&(i=this.MAP_ROW,s=this.MAP_COL)}this.mLastRC=a},NewClass.prototype.isHeadTails=function(t,e){var a=!1,i=0;if(t.x<e.x){for(var s=t.y+1;s<this.MAP_COL;++s)null!=this.mMapData[t.x][s]&&i++;for(var o=t.x+1;o<e.x;++o)for(s=0;s<this.MAP_COL;++s)null!=this.mMapData[o][s]&&i++;for(s=0;s<e.y;++s)null!=this.mMapData[e.x][s]&&i++;0==i&&(a=!0)}else if(t.x>e.x){for(s=t.y-1;s>=0;--s)null!=this.mMapData[t.x][s]&&i++;for(o=t.x-1;o>e.x;--o)for(s=this.MAP_COL-1;s>=0;--s)null!=this.mMapData[o][s]&&i++;for(s=this.MAP_COL-1;s>e.y;--s)null!=this.mMapData[e.x][s]&&i++;0==i&&(a=!0)}return a},NewClass.prototype.onBtnOldVersionClicked=function(t,e){"1"==e?cc.director.loadScene("main"):"2"==e?cc.director.loadScene("map2"):cc.director.loadScene("map3")},NewClass.prototype.showToast=function(t){var e=document.createElement("div");e.innerHTML=t,e.style.cssText="width:40%; min-width:180px; background:#000; opacity:0.8; height:auto;min-height: 50px; color:#fff; line-height:200px; font-size:60; text-align:center; border-radius:4px; position:fixed; top:60%; left:30%; z-index:999999;",document.body.appendChild(e),setTimeout(function(){e.style.webkitTransition="-webkit-transform 0.5s ease-in, opacity 0.5s ease-in",e.style.opacity="0",setTimeout(function(){document.body.removeChild(e)},500)},3e3)},__decorate([property({type:cc.Node})],NewClass.prototype,"mapBg",void 0),__decorate([property({type:cc.EditBox})],NewClass.prototype,"input_Line_1",void 0),__decorate([property({type:cc.EditBox})],NewClass.prototype,"input_Line_2",void 0),__decorate([property({type:cc.EditBox})],NewClass.prototype,"input_Line_3",void 0),__decorate([property({type:cc.EditBox})],NewClass.prototype,"input_Total_Count",void 0),__decorate([property({type:cc.EditBox})],NewClass.prototype,"input_calc_count",void 0),__decorate([property({type:cc.Button})],NewClass.prototype,"btnDone",void 0),__decorate([property({type:cc.Button})],NewClass.prototype,"btnCopy",void 0),__decorate([property({type:cc.Node})],NewClass.prototype,"cubeNode",void 0),__decorate([property({type:cc.Node})],NewClass.prototype,"mPercentDialog",void 0),__decorate([property({type:cc.Label})],NewClass.prototype,"mLabelPercent",void 0),__decorate([property({type:List_1.default})],NewClass.prototype,"listV",void 0),__decorate([property({type:cc.Label})],NewClass.prototype,"labelLeft_1",void 0),__decorate([property({type:cc.Label})],NewClass.prototype,"labelLeft_2",void 0),NewClass=__decorate([ccclass],NewClass),NewClass}(cc.Component);exports.default=NewClass,cc._RF.pop()},{"./List":"List"}],map3:[function(require,module,exports){"use strict";cc._RF.push(module,"4fd623r2HxGsL0EgFKU1ovs","map3");var __extends=this&&this.__extends||(extendStatics=function(t,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),extendStatics,__decorate=this&&this.__decorate||function(t,e,a,i){var s,o=arguments.length,r=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,a):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,i);else for(var n=t.length-1;n>=0;n--)(s=t[n])&&(r=(o<3?s(r):o>3?s(e,a,r):s(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(exports,"__esModule",{value:!0});var List_1=require("./List"),_a=cc._decorator,ccclass=_a.ccclass,property=_a.property,IntVec2=function(t,e){this.x=0,this.y=0,this.x=t,this.y=e},NumberCube=function(){function t(){this.row=0,this.col=0,this.num=0}return t.prototype.getRowCol=function(){return new IntVec2(this.row,this.col)},t}(),deepArray=function(t){return t.map(deepClone)},deepObject=function(t){var e=Object.keys(t),a={};return e.forEach(function(e){a[e]=deepClone(t[e])}),a},deepClone=function(t){if(null===t||!t)return t;if("[object Object]"===Object.prototype.toString.call(t)){var e={};return Object.keys(t).forEach(function(a){t[a]&&"object"==typeof t[a]?e[a]=deepClone(t[a]):e[a]=t[a]}),e}if(Array.isArray(t)){var a=[];return t.forEach(function(t,e){a[e]=t&&"object"==typeof t?deepClone(t):t}),a}},CubeData=function(){this.prcessCubes_1=[],this.prcessCubes_2=[],this.mergeAdjacentNum=0,this.mergeHvNum=0,this.mergeSlantNum=0,this.mergeHeadTailNum=0,this.comboNum=0,this.comboTimes=0,this.maxCombo=0,this.passPercent=-1,this.copyTimeAvg=0,this.LeftCubeNum=0,this.mergeAdjacentNum_2=0,this.mergeHvNum_2=0,this.mergeSlantNum_2=0,this.mergeHeadTailNum_2=0,this.comboNum_2=0,this.comboTimes_2=0,this.maxCombo_2=0,this.passPercent_2=-1,this.copyTimeAvg_2=0,this.LeftCubeNum_2=0},NewClass=function(_super){function NewClass(){var t=null!==_super&&_super.apply(this,arguments)||this;return t.mapBg=null,t.input_Line_1=null,t.input_Line_2=null,t.input_Line_3=null,t.input_Line_4=null,t.input_Line_4_count=null,t.input_Total_Count=null,t.input_calc_count=null,t.btnDone=null,t.btnCopy=null,t.cubeNode=null,t.mPercentDialog=null,t.mLabelPercent=null,t.mTaggleForceHeadTail=null,t.listV=null,t.labelLeft_1=null,t.labelLeft_2=null,t.mRows=4,t.MAP_ROW=96,t.MAP_COL=9,t.mFistLineNum=0,t.mSecLineNum=0,t.mThirdLineNum=0,t.mFourLineNum=0,t.mFourLineCountNum=0,t.mNumberPool=[],t.mNumberPoolBeenEmptyed=!1,t.mNeedLink=!1,t.mLinkPercent=0,t.mAddCount=0,t.mTargetNumber=1,t.mTargetCount=10,t.mCalcCount=5,t.mIsForceHeadTail=!1,t.mNowShowIdx=0,t.mNowShowStep=0,t.mSetLeftNum=0,t.mSpecialCount=10,t}return __extends(NewClass,_super),NewClass.prototype.start=function(){this.mDataList=[]},NewClass.prototype.clearMapData=function(){this.mMapData=new Array(this.MAP_ROW);for(var t=0;t<this.MAP_ROW;++t){this.mMapData[t]=new Array(this.MAP_COL);for(var e=0;e<this.MAP_COL;++e)this.mMapData[t][e]=null}},NewClass.prototype.getInputData=function(){var t=Number(this.input_Line_1.string);if(isNaN(t)||t<0||t>4)return alert("\u7b2c\u4e00\u884c\u5bf9\u6570\u53ea\u80fd\u4e3a\uff1a0-4\uff01"),!1;var e=Number(this.input_Line_2.string);if(isNaN(e)||e<0||e>4)return alert("\u7b2c\u4e8c\u884c\u5bf9\u6570\u53ea\u80fd\u4e3a\uff1a0-4\uff01"),!1;var a=Number(this.input_Line_3.string);if(isNaN(a)||a<0||a>4)return alert("\u7b2c\u4e09\u884c\u5bf9\u6570\u53ea\u80fd\u4e3a\uff1a0-4\uff01"),!1;var i=Number(this.input_Line_4.string);if(isNaN(i)||i<0||i>2*t)return alert("\u7b2c\u56db\u884c\u914d\u5bf9\u6570\u5fc5\u987b\u662f 0 \u5230 \u884c1\u5bf9\u6570x2!"),!1;var s=Number(this.input_Line_4_count.string);if(isNaN(s)||s<=0||s>this.MAP_COL)return alert("\u7b2c\u56db\u884c\u603b\u4e2a\u6570\u4e0d\u80fd\u8d85\u8fc79!"),!1;var o=Number(this.input_Total_Count.string);return isNaN(o)||o<=0||o>1e4?(alert("\u6570\u636e\u603b\u91cf\u53ea\u80fd\u4e3a\uff1a1-10000\uff01"),!1):(this.mFistLineNum=t,this.mSecLineNum=e,this.mThirdLineNum=a,this.mFourLineNum=i,this.mFourLineCountNum=s,this.mFourLineNum>this.mFourLineCountNum?(alert("\u7b2c\u56db\u884c\u914d\u5bf9\u4e2a\u6570\u4e0d\u80fd\u5927\u4e8e\u7b2c\u56db\u884c\u6700\u5927\u6570\u91cf\u9650\u5236!"),!1):(this.mTargetNumber=0,this.mTargetCount=o,this.mLinkPercent=0,this.mLinkPercent>0&&(this.mNeedLink=!0),this.mIsForceHeadTail=this.mTaggleForceHeadTail.isChecked,!0))},NewClass.prototype.onToggleHeadTail=function(){this.mIsForceHeadTail=this.mTaggleForceHeadTail.isChecked},NewClass.prototype.onBtnDoneClicked=function(){this.getInputData()&&(this.clearMap(),this.createMap(),this.initScrollView(),alert("\u751f\u6210\u9635\u578b\u6210\u529f, \u5171\u751f\u6210"+this.mDataList.length+"\u7ec4\u6570\u636e\uff01"))},NewClass.prototype.onBtnCopyClicked=function(){if(this.mDataList.length<=0)alert("\u5bf9\u4e0d\u8d77\uff0c\u672a\u627e\u5230\u53ef\u590d\u5236\u9635\u578b\uff01");else{for(var t="",e=0;e<this.mDataList.length;++e){for(var a="[",i=this.mDataList[e].cubes,s=0;s<this.mRows;++s){var o=i[s].length;3==s&&(o=this.mFourLineCountNum);for(var r=0;r<o;++r)a+=i[s][r].num,r<o-1&&(a+=",");s<this.mRows-1&&(a+=",")}t+=a+="]\n"}this.writeData(t,1)}},NewClass.prototype.onBtnLoad=function(){this.getInputData()&&(this.mAddCount=5,this.mDataList=[],this.clearMapData(),this.clearMap(),this.readData())},NewClass.prototype.onBtnCalc=function(){if(!this.mDataList||this.mDataList.length<=0)alert("\u6570\u636e\u9519\u8bef\uff01");else try{this.calcAllCubeDatas(!1,0),this.calcAllCubeDatas(!0,0),this.clearPassPercent(),alert("\u8ba1\u7b97\u6570\u636e\u5b8c\u6bd5\uff01")}catch(t){console.log(t),alert("\u8ba1\u7b97\u6570\u636e\u51fa\u9519\uff01")}},NewClass.prototype.onBtnCalcPass=function(){var t=this;if(!this.mDataList||this.mDataList.length<=0)alert("\u6570\u636e\u9519\u8bef\uff01");else{var e=Number(this.input_calc_count.string);if(isNaN(e)||e<=0||e>1e3)alert("\u8ba1\u7b97\u6b21\u6570\u53c2\u6570\u53ea\u80fd\u4e3a\uff1a1-1000\uff01");else{this.mCalcCount=e;try{this.clearPassPercent(),this.mPercentDialog.active=!0,this.mLabelPercent.string="\u8ba1\u7b97\u8fdb\u5ea6\uff1a0%";var a=0,i=setInterval(function(){if(a>=t.mCalcCount)return clearInterval(i),t.mPercentDialog.active=!1,void alert("\u8ba1\u7b97\u901a\u5173\u7387\u5b8c\u6bd5\uff01");for(var e=0;e<t.mDataList.length;++e)t.mDataList[e].prcessCubes_1=[],t.mDataList[e].prcessCubes_2=[];t.calcAllCubeDatas(!1,a),t.calcAllCubeDatas(!0,a),t.mLabelPercent.string="\u8ba1\u7b97\u8fdb\u5ea6\uff1a"+(a+1)*(100/t.mCalcCount)+"%",a++},5)}catch(s){console.log(s),this.mPercentDialog.active=!1,alert("\u8ba1\u7b97\u6570\u636e\u51fa\u9519\uff01")}}}},NewClass.prototype.clearPassPercent=function(){if(this.mDataList&&!(this.mDataList.length<=0))for(var t=0;t<this.mDataList.length;++t)this.mDataList[t].passPercent=-1,this.mDataList[t].passPercent_2=-1},NewClass.prototype.clearMap=function(){for(var t=this.mapBg.children,e=0;e<t.length;++e)t[e].destroy()},NewClass.prototype.onBtnItemClicked=function(t){var e=t.target._listId;this.mNowShowIdx=e,this.mNowShowStep=0;var a=this.mDataList[e].cubes,i=this.mDataList[e].mergeList;this.clearMap();for(var s=0;s<this.mRows;++s)for(var o=0;o<a[s].length;++o)if(a[s][o]){for(var r=!1,n=0;n<i.length;++n)(i[n][0].x==a[s][o].row&&i[n][0].y==a[s][o].col||i[n][1].x==a[s][o].row&&i[n][1].y==a[s][o].col)&&(r=!0);this.addCube(a[s][o],r)}},NewClass.prototype.onBtnRecodClicked=function(t,e){if(!(this.mDataList.length<=0)){var a;!(a=deepClone("11"==e||"12"==e||"13"==e?this.mDataList[this.mNowShowIdx].prcessCubes_1:this.mDataList[this.mNowShowIdx].prcessCubes_2))||a.length<=0||("11"==e||"21"==e?this.mNowShowStep>0&&this.mNowShowStep--:"12"==e||"22"==e?this.mNowShowStep=0:"13"!=e&&"23"!=e||this.mNowShowStep<a.length-1&&this.mNowShowStep++,this.mNowShowStep<0&&(this.mNowShowStep=0),this.mNowShowStep>=a.length&&(this.mNowShowStep=a.length-1),this.fillMap(a[this.mNowShowStep]))}},NewClass.prototype.fillMap=function(t){this.clearMap();for(var e=0;e<t.length;++e)for(var a=0;a<t[e].length;++a)t[e][a]&&this.addCube(t[e][a],!1)},NewClass.prototype.addCube=function(t,e){var a=t.row,i=t.col,s=t.num,o=cc.instantiate(this.cubeNode);o.getChildByName("bg").active=e,cc.resources.load("nums/"+s,cc.SpriteFrame,function(t,e){t&&console.log(t),o.getChildByName("num").getComponent(cc.Sprite).spriteFrame=e}),o.setPosition((i+.5)*(654/9),72.5*-(a+.5)),this.mapBg.addChild(o)},NewClass.prototype.onBtnDownLoad=function(){if(!this.mDataList||this.mDataList.length<=0)alert("\u5bf9\u4e0d\u8d77\uff0c\u6570\u636e\u9519\u8bef\uff01");else{for(var t="\u76f8\u90bb\u6d88\u9664\t\u975e\u76f8\u90bb\u6a2a\u7ad6\u6d88\u9664\t\u975e\u76f8\u90bb\u659c\u5411\u6d88\u9664\t\u9996\u5c3e\u6d88\u9664\tcombo\u89e6\u53d1\u5e73\u5747\u6b21\u6570\t\u6700\u5927combo\u6b21\u6570\t\u901a\u5173\u7387\t\u5e73\u5c40\u590d\u5236\u6b21\u6570\t\u76f8\u90bb\u6d88\u9664_2\t\u975e\u76f8\u90bb\u6a2a\u7ad6\u6d88\u9664_2\t\u975e\u76f8\u90bb\u659c\u5411\u6d88\u9664_2\t\u9996\u5c3e\u6d88\u9664_2\tcombo\u89e6\u53d1\u5e73\u5747\u6b21\u6570_2\t\u6700\u5927combo\u6b21\u6570_2\t\u901a\u5173\u7387_2\t\u5e73\u5c40\u590d\u5236\u6b21\u6570_2\t\u5e73\u5747\u5269\u4f59\u65b9\u5757\u6570(\u603b)\t\u5e73\u5747\u5269\u4f59\u65b9\u5757\u6570(\u5931\u8d25)\t\u5e73\u5747\u5269\u4f59\u65b9\u5757\u6570(\u603b)_2\t\u5e73\u5747\u5269\u4f59\u65b9\u5757\u6570(\u5931\u8d25)_2\n",e=0;e<this.mDataList.length;++e){var a="",i=this.mDataList[e].passPercent;a+=this.mDataList[e].mergeAdjacentNum/this.mCalcCount+"\t",a+=this.mDataList[e].mergeHvNum/this.mCalcCount+"\t",a+=this.mDataList[e].mergeSlantNum/this.mCalcCount+"\t",a+=this.mDataList[e].mergeHeadTailNum/this.mCalcCount+"\t",this.mDataList[e].comboTimes>0?a+=this.mDataList[e].comboNum/this.mDataList[e].comboTimes+"\t":a+="0\t",a+=this.mDataList[e].maxCombo+"\t",a+=this.mDataList[e].passPercent*(100/this.mCalcCount)+"\t",a+=this.mDataList[e].copyTimeAvg/this.mCalcCount+"\t";var s=this.mDataList[e].passPercent_2;a+=this.mDataList[e].mergeAdjacentNum_2/this.mCalcCount+"\t",a+=this.mDataList[e].mergeHvNum_2/this.mCalcCount+"\t",a+=this.mDataList[e].mergeSlantNum_2/this.mCalcCount+"\t",a+=this.mDataList[e].mergeHeadTailNum_2/this.mCalcCount+"\t",this.mDataList[e].comboTimes_2>0?a+=this.mDataList[e].comboNum_2/this.mDataList[e].comboTimes_2+"\t":a+="0\t",a+=this.mDataList[e].maxCombo_2+"\t",a+=this.mDataList[e].passPercent_2*(100/this.mCalcCount)+"\t",a+=this.mDataList[e].copyTimeAvg_2/this.mCalcCount+"\t",a+=this.mDataList[e].LeftCubeNum/this.mCalcCount+"\t",this.mCalcCount-i>0?a+=this.mDataList[e].LeftCubeNum/(this.mCalcCount-i)+"\t":a+="0\t",a+=this.mDataList[e].LeftCubeNum_2/this.mCalcCount+"\t",this.mCalcCount-s>0?a+=this.mDataList[e].LeftCubeNum_2/(this.mCalcCount-s)+"\n":a+="0\n",t+=a}this.writeData(t,2)}},NewClass.prototype.initNumberPool=function(){if(this.mNumberPool.length<=0){for(var t=0;t<this.MAP_COL;++t)this.mNumberPool.push(t+1);this.mNumberPool.sort(function(){return.5-Math.random()}),this.mNumberPoolBeenEmptyed=!0}},NewClass.prototype.initMapData=function(t){this.clearMapData();for(var e=[],a=0;a<this.MAP_COL;a++)e.push(a);e.sort(function(){return.5-Math.random()}),this.mNumberPool=[],this.initNumberPool(),this.mNumberPoolBeenEmptyed=!1;var i=!1;if(t){this.initNumberPool();var s=this.mNumberPool[0];this.mNumberPool.splice(0,1);var o=cc.math.randomRangeInt(0,3),r=this.MAP_COL-1;this.mMapData[o][r]=new NumberCube,this.mMapData[o][r].row=o,this.mMapData[o][r].col=r,this.mMapData[o][r].num=s,o+=1,r=0,this.mMapData[o][r]=new NumberCube,this.mMapData[o][r].row=o,this.mMapData[o][r].col=r,this.mMapData[o][r].num=s,1==cc.math.randomRangeInt(0,2)&&(this.mMapData[o][r].num=10-s),i=3==o}var n=0;for(a=0;a<this.MAP_COL&&n<this.mSecLineNum;++a)if(o=1,r=e[a],!this.mMapData[o][r]){n++,this.initNumberPool();var l=0,h=this.mNumberPool[l];this.mNumberPool.splice(l,1),this.mMapData[o][r]=new NumberCube,this.mMapData[o][r].row=o,this.mMapData[o][r].col=r,this.mMapData[o][r].num=h,-1==this.fillMapNumber(o,r,h,3,!0)&&this.fillMapNumber(o,r,h,3,!1)}for(e.sort(function(){return.5-Math.random()}),n=0,a=0;a<this.MAP_COL&&n<this.mThirdLineNum;++a)o=2,r=e[a],this.mMapData[o][r]||(n++,this.initNumberPool(),l=0,h=this.mNumberPool[l],this.mNumberPool.splice(l,1),this.mMapData[o][r]=new NumberCube,this.mMapData[o][r].row=o,this.mMapData[o][r].col=r,this.mMapData[o][r].num=h,-1==this.fillMapNumber(o,r,h,3,!0)&&this.fillMapNumber(o,r,h,3,!1));for(e.sort(function(){return.5-Math.random()}),n=0,a=0;a<this.MAP_COL&&n<this.mFistLineNum;++a)o=0,r=e[a],this.mMapData[o][r]||(n++,this.initNumberPool(),h=this.mNumberPool[0],-1==this.fillMapNumber(o,r,h,3,!0)&&this.fillMapNumber(o,r,h,3,!1));e.sort(function(){return.5-Math.random()});var c=[];for(a=0;a<this.MAP_COL&&c.length<this.mFistLineNum;++a){var m=e[a];this.mMapData[0][m]&&m<this.mFourLineCountNum&&c.push(m)}for(a=0;a<c.length;++a)if(m=c[a],!(this.mMapData[4][m]||i&&0==m)&&(this.mMapData[4][m]=new NumberCube,this.mMapData[4][m].row=4,this.mMapData[4][m].col=m,this.mMapData[4][m].num=this.mMapData[0][m].num,a%2==1&&.5-Math.random()>0&&(!i||0!=c[a-1]))){var p=this.mMapData[4][c[a-1]].num;this.mMapData[4][c[a-1]].num=this.mMapData[4][m].num,this.mMapData[4][m].num=p}var u=[];for(a=0;a<4;++a){var d=this.MAP_COL;3==a&&(d=this.mFourLineCountNum);for(var _=0;_<d;++_)this.mMapData[a][_]||u.push(new IntVec2(a,_))}for(var f=0,y=0;u.length>0;){this.initNumberPool();var C=-1;if(s=0,f%2==1){var g=[y,10-y];if(this.mNumberPoolBeenEmptyed){for(g=[],a=0;a<9;++a)g[a]=a+1;g.sort(function(){return.5-Math.random()})}for(l=0;l<g.length;++l){for(s=g[l],a=0;a<u.length;++a){var D=u[a];if(this.mMapData[D.x][D.y]=new NumberCube,this.mMapData[D.x][D.y].row=D.x,this.mMapData[D.x][D.y].col=D.y,this.mMapData[D.x][D.y].num=s,!this.canSingleCubeMerge(D)){C=a;break}this.mMapData[D.x][D.y]=null}if(C>=0)break}}else for(l=0;l<this.mNumberPool.length;++l){for(s=this.mNumberPool[l],a=0;a<u.length;++a){if(D=u[a],this.mMapData[D.x][D.y]=new NumberCube,this.mMapData[D.x][D.y].row=D.x,this.mMapData[D.x][D.y].col=D.y,this.mMapData[D.x][D.y].num=s,!this.canSingleCubeMerge(D)){C=a,this.mNumberPool.splice(l,1);break}this.mMapData[D.x][D.y]=null}if(C>=0)break}if(-1==C){var w=.5>Math.random()?y:10-y;f%2==1?s=w:(s=this.mNumberPool[0],this.mNumberPool.splice(0,1)),D=u[C=cc.math.randomRangeInt(0,u.length)],this.mMapData[D.x][D.y]=new NumberCube,this.mMapData[D.x][D.y].row=D.x,this.mMapData[D.x][D.y].col=D.y,this.mMapData[D.x][D.y].num=s}y=s,u.splice(C,1),f++}},NewClass.prototype.fillMapNumber=function(t,e,a,i,s){var o=-1;if(2==t||3==t){var r=new IntVec2(t+2,e-2),n=new IntVec2(t+2,e+2);2==t&&(r=new IntVec2(t-2,e-2),n=new IntVec2(t-2,e+2)),this.isValidRowCol(r)&&!this.mMapData[r.x][r.y]&&(this.mMapData[r.x][r.y]=new NumberCube,this.mMapData[r.x][r.y].row=r.x,this.mMapData[r.x][r.y].col=r.y,this.mMapData[r.x][r.y].num=a,1==cc.math.randomRangeInt(0,2)&&(this.mMapData[r.x][r.y].num=10-a),o=0,s&&this.canSingleCubeMerge(r)&&(o=-1,this.mMapData[r.x][r.y]=null)),-1==o&&this.isValidRowCol(n)&&!this.mMapData[n.x][n.y]&&(this.mMapData[n.x][n.y]=new NumberCube,this.mMapData[n.x][n.y].row=n.x,this.mMapData[n.x][n.y].col=n.y,this.mMapData[n.x][n.y].num=a,1==cc.math.randomRangeInt(0,2)&&(this.mMapData[n.x][n.y].num=10-a),o=1,s&&this.canSingleCubeMerge(n)&&(o=-1,this.mMapData[n.x][n.y]=null))}if(-1==o){for(var l=[],h=e+i;h<this.MAP_COL;++h)this.mMapData[t][h]||l.push(h);for(h=e-i;h>=0;--h)this.mMapData[t][h]||l.push(h);l.length>0&&(h=l[h=cc.math.randomRangeInt(0,l.length)],this.mMapData[t][h]=new NumberCube,this.mMapData[t][h].row=t,this.mMapData[t][h].col=h,this.mMapData[t][h].num=a,1==cc.math.randomRangeInt(0,2)&&(this.mMapData[t][h].num=10-a),o=2,s&&this.canSingleCubeMerge(new IntVec2(t,h))&&(o=-1,this.mMapData[t][h]=null))}return o},NewClass.prototype.getAllCubes=function(){for(var t=[],e=0;e<this.MAP_ROW;++e)for(var a=0;a<this.MAP_COL;++a)if(this.mMapData[e]&&this.mMapData[e][a]){var i=new NumberCube;i.row=this.mMapData[e][a].row,i.col=this.mMapData[e][a].col,i.num=this.mMapData[e][a].num,t.push(i)}return t},NewClass.prototype.createMap=function(){this.mDataList=[];for(var t=0,e=0;e<this.mTargetCount&&t<1e5;++e){t++,this.initMapData(this.mIsForceHeadTail);var a=new CubeData;a.cubes=deepClone(this.mMapData),a.mergeList=(new Array).fill([]),a.mergeList=[],this.mDataList.push(a)}},NewClass.prototype.mergeMap=function(t){for(var e=[],a=this.getAllCubes(),i=0;i<a.length;++i)for(var s=0;s<a.length;++s)if(i!=s){var o=a[i].row,r=a[i].col,n=a[s].row,l=a[s].col;if(null!=this.mMapData[o][r]&&null!=this.mMapData[n][l]){for(var h=!1,c=0;c<e.length;++c){var m=e[c][0],p=e[c][1];if(m.x==a[i].row&&m.y==a[i].col||m.x==a[s].row&&m.y==a[s].col){h=!0;break}if(p.x==a[i].row&&p.y==a[i].col||p.x==a[s].row&&p.y==a[s].col){h=!0;break}}h||this.canCubeMerge(a[i].getRowCol(),a[s].getRowCol())&&(e.push([a[i].getRowCol(),a[s].getRowCol()]),t&&(this.mMapData[o][r]=null,this.mMapData[n][l]=null),i=0,s=0)}}return e},NewClass.prototype.getOptimalIndex=function(t,e){var a=-1;if(!t||t.length<=0)return a;a=cc.math.randomRangeInt(0,t.length);var i=!1;if(e)for(var s=0;s<t.length;++s){var o=t[s][0],r=t[s][1];if(3==o.x||4==o.x||3==r.x||4==r.x){i=!0,a=s;break}}if(!i)for(s=0;s<t.length;++s){if(o=t[s][0],r=t[s][1],o.x==r.x&&2==this.getRowCubes(o.x)){i=!0,a=s;break}if(1==this.getRowCubes(o.x)||1==this.getRowCubes(r.x)){i=!0,a=s;break}}return a},NewClass.prototype.getRowCubes=function(t){for(var e=0,a=0;a<this.MAP_COL;++a){var i=new IntVec2(t,a);this.isValidRowCol(i)&&this.mMapData[i.x][i.y]&&e++}return e},NewClass.prototype.getCubeRoundRC=function(t){var e=new Array;if(!this.isValidRowCol(t))return e;var a=new IntVec2(t.x-1,t.y-1);return this.isValidRowCol(a)&&e.push(a),a=new IntVec2(t.x-1,t.y),this.isValidRowCol(a)&&e.push(a),a=new IntVec2(t.x-1,t.y+1),this.isValidRowCol(a)&&e.push(a),a=new IntVec2(t.x,t.y-1),this.isValidRowCol(a)&&e.push(a),a=new IntVec2(t.x,t.y+1),this.isValidRowCol(a)&&e.push(a),a=new IntVec2(t.x+1,t.y-1),this.isValidRowCol(a)&&e.push(a),a=new IntVec2(t.x+1,t.y),this.isValidRowCol(a)&&e.push(a),a=new IntVec2(t.x+1,t.y+1),this.isValidRowCol(a)&&e.push(a),e},NewClass.prototype.initScrollView=function(){this.listV.numItems=this.mDataList.length},NewClass.prototype.isValidRowCol=function(t){return!(t.x<0||t.x>=this.MAP_ROW||t.y<0||t.y>=this.MAP_COL||3==t.x&&t.y>=this.mFourLineCountNum)},NewClass.prototype.isRowColEqual=function(t,e){return t.x==e.x&&t.y==e.y},NewClass.prototype.canCubeMerge=function(t,e){if(!this.isValidRowCol(t)||!this.isValidRowCol(e)||this.isRowColEqual(t,e))return!1;var a=this.mMapData[t.x][t.y],i=this.mMapData[e.x][e.y];if(!a||!i)return!1;var s=a.num+i.num==10,o=a.num==i.num;if(!s&&!o)return!1;var r=[];if(t.x==e.x)for(var n=Math.min(t.y,e.y),l=Math.max(t.y,e.y),h=n+1;h<l;++h)(u=this.mMapData[t.x][h])&&r.push(u);else if(t.y==e.y){var c=Math.min(t.x,e.x),m=Math.max(t.x,e.x);for(h=c+1;h<m;++h)(u=this.mMapData[h][t.y])&&r.push(u)}else if(t.x<e.x&&t.y<e.y&&e.x-t.x==e.y-t.y){h=t.x+1;for(var p=t.y+1;h<e.x&&p<e.y;++h,++p)(u=this.mMapData[h][p])&&r.push(u)}else if(t.x>e.x&&t.y<e.y&&t.x-e.x==e.y-t.y)for(h=t.x-1,p=t.y+1;h>e.x&&p<e.y;--h,++p)(u=this.mMapData[h][p])&&r.push(u);else if(t.x>e.x&&t.y>e.y&&t.x-e.x==t.y-e.y)for(h=t.x-1,p=t.y-1;h>e.x&&p>e.y;--h,--p)(u=this.mMapData[h][p])&&r.push(u);else if(t.x<e.x&&t.y>e.y&&e.x-t.x==t.y-e.y)for(h=t.x+1,p=t.y-1;h<e.x&&p>e.y;++h,--p)(u=this.mMapData[h][p])&&r.push(u);else if(t.x<e.x){for(p=t.y+1;p<this.MAP_COL;++p)(u=this.mMapData[t.x][p])&&r.push(u);for(h=t.x+1;h<e.x;++h)for(p=0;p<this.MAP_COL;++p)(u=this.mMapData[h][p])&&r.push(u);for(p=0;p<e.y;++p)(u=this.mMapData[e.x][p])&&r.push(u)}else if(t.x>e.x){for(p=t.y-1;p>=0;--p)(u=this.mMapData[t.x][p])&&r.push(u);for(h=t.x-1;h>e.x;--h)for(p=this.MAP_COL-1;p>=0;--p)(u=this.mMapData[h][p])&&r.push(u);for(p=this.MAP_COL-1;p>e.y;--p){var u;(u=this.mMapData[e.x][p])&&r.push(u)}}return 0==r.length},NewClass.prototype.canSingleCubeMerge=function(t){for(var e=this.getAllCubes(),a=0;a<e.length;++a)if(this.canCubeMerge(t,e[a].getRowCol()))return!0;return!1},NewClass.prototype.onListVRender=function(t,e){for(var a=this.mDataList[e],i=cc.find("bg/labelData",t),s=e+1+"--[",o=a.cubes,r=0;r<this.mRows;++r){var n=o[r].length;3==r&&(n=this.mFourLineCountNum);for(var l=0;l<n;++l)s+=o[r][l].num,l<n-1&&(s+=",");r<this.mRows-1?s+=",":s+="]"}i.getComponent(cc.Label).string=s},NewClass.prototype.calcAllCubeDatas=function(t){if(!this.mDataList||this.mDataList.length<=0)alert("\u6570\u636e\u51fa\u9519\uff0c\u8bf7\u91cd\u65b0\u4e0a\u4f20\uff01");else{this.mCalcCount,this.mDataList.length,this.mDataList.length,t&&this.mDataList.length;for(var e=0;e<this.mDataList.length;++e){var a=this.mDataList[e];this.clearMapData(),this.mMapData=deepClone(a.cubes),this.addMapRecord(t,e),this.mLastRC=new IntVec2(3,this.mFourLineCountNum-1);var i=this.mAddCount;t&&i>0&&(this.addNewNumbers(),this.mDataList[e].copyTimeAvg_2+=1,i-=1,this.addMapRecord(t,e));for(var s=0,o=0,r=this.mergeMap(!1),n=!1;r.length>0;){var l=this.getOptimalIndex(r,t&&i==this.mAddCount-1),h=r[l][0],c=r[l][1];n||(this.isHeadTails(h,c)?t?this.mDataList[e].mergeHeadTailNum_2+=1:this.mDataList[e].mergeHeadTailNum+=1:h.x==c.x&&Math.abs(h.y-c.y)>1?t?this.mDataList[e].mergeHvNum_2+=1:this.mDataList[e].mergeHvNum+=1:h.y==c.y&&Math.abs(h.x-c.x)>1?t?this.mDataList[e].mergeHvNum_2+=1:this.mDataList[e].mergeHvNum+=1:Math.abs(h.x-c.x)==Math.abs(h.y-c.y)&&Math.abs(h.x-c.x)>1?t?this.mDataList[e].mergeSlantNum_2+=1:this.mDataList[e].mergeSlantNum+=1:t?this.mDataList[e].mergeAdjacentNum_2+=1:this.mDataList[e].mergeAdjacentNum+=1),this.mMapData[h.x][h.y]=null,this.mMapData[c.x][c.y]=null;var m=!1;if(this.getRowCubes(h.x)<=0&&(h.x==this.mLastRC.x&&(this.mLastRC.y=this.MAP_COL-1),this.mLastRC.x-=1,m=!0),h.x!=c.x&&this.getRowCubes(c.x)<=0&&(c.x==this.mLastRC.x&&(this.mLastRC.y=this.MAP_COL-1),this.mLastRC.x-=1,m=!0),m?s+=1:s=0,s>1&&o++,this.checkEmptyLine(),this.addMapRecord(t,e),this.getAllCubes().length<=0)break;for(r=this.mergeMap(!1);r.length<=0&&i>0;)this.addNewNumbers(),n=!0,t?this.mDataList[e].copyTimeAvg_2+=1:this.mDataList[e].copyTimeAvg+=1,this.addMapRecord(t,e),i-=1,r=this.mergeMap(!1)}var p=this.getAllCubes();t?(this.mDataList[e].passPercent_2<=0&&(this.mDataList[e].passPercent_2=0),this.mDataList[e].passPercent_2+=0==p.length?1:0):(this.mDataList[e].passPercent<=0&&(this.mDataList[e].passPercent=0),this.mDataList[e].passPercent+=0==p.length?1:0),t?this.mDataList[e].LeftCubeNum_2+=p.length:this.mDataList[e].LeftCubeNum+=p.length,t?0==p.length&&(this.mDataList[e].comboNum_2+=o,this.mDataList[e].maxCombo_2=Math.max(this.mDataList[e].maxCombo_2,o),this.mDataList[e].comboTimes_2+=1):0==p.length&&(this.mDataList[e].comboNum+=o,this.mDataList[e].maxCombo=Math.max(this.mDataList[e].maxCombo,o),this.mDataList[e].comboTimes+=1)}}},NewClass.prototype.addMapRecord=function(t,e){t?this.mDataList[e].prcessCubes_2.push(deepClone(this.mMapData)):this.mDataList[e].prcessCubes_1.push(deepClone(this.mMapData))},NewClass.prototype.checkEmptyLine=function(){for(var t=1;t<this.MAP_ROW;++t){for(var e=!0,a=0;a<this.MAP_COL;++a)if(this.mMapData[t]&&this.mMapData[t][a]){e=!1;break}if(!e){for(var i=0,s=t-1;s>=0;--s){var o=!0;for(a=0;a<this.MAP_COL;++a)if(this.mMapData[s][a]){o=!1;break}if(!o)break;i++}if(i>0){for(var r=t;r<this.MAP_ROW;++r)for(a=0;a<this.MAP_COL;++a)if(this.mMapData[r]){var n=r-i;this.mMapData[n][a]=this.mMapData[r][a],this.mMapData[r][a]=null,this.mMapData[n][a]&&(this.mMapData[n][a].row=n)}t-=i}}}},NewClass.prototype.addNewNumbers=function(){for(var t=this.getAllCubes(),e=0,a=this.mLastRC,i=this.mLastRC.x;i<this.MAP_ROW;++i)for(var s=i==this.mLastRC.x?this.mLastRC.y+1:0;s<this.MAP_COL;++s){this.mMapData[i]||(this.mMapData[i]=[]);var o=t[e++],r=new NumberCube;r.row=i,r.col=s,r.num=o.num,this.mMapData[i][s]=r,a.x=i,a.y=s,e>=t.length&&(i=this.MAP_ROW,s=this.MAP_COL)}this.mLastRC=a},NewClass.prototype.isHeadTails=function(t,e){var a=!1,i=0;if(t.x<e.x){for(var s=t.y+1;s<this.MAP_COL;++s)null!=this.mMapData[t.x][s]&&i++;for(var o=t.x+1;o<e.x;++o)for(s=0;s<this.MAP_COL;++s)null!=this.mMapData[o][s]&&i++;for(s=0;s<e.y;++s)null!=this.mMapData[e.x][s]&&i++;0==i&&(a=!0)}else if(t.x>e.x){for(s=t.y-1;s>=0;--s)null!=this.mMapData[t.x][s]&&i++;for(o=t.x-1;o>e.x;--o)for(s=this.MAP_COL-1;s>=0;--s)null!=this.mMapData[o][s]&&i++;for(s=this.MAP_COL-1;s>e.y;--s)null!=this.mMapData[e.x][s]&&i++;0==i&&(a=!0)}return a},NewClass.prototype.onBtnOldVersionClicked=function(t,e){"1"==e?cc.director.loadScene("main"):"2"==e?cc.director.loadScene("map2"):cc.director.loadScene("map3")},NewClass.prototype.showToast=function(t){var e=document.createElement("div");e.innerHTML=t,e.style.cssText="width:40%; min-width:180px; background:#000; opacity:0.8; height:auto;min-height: 50px; color:#fff; line-height:200px; font-size:60; text-align:center; border-radius:4px; position:fixed; top:60%; left:30%; z-index:999999;",document.body.appendChild(e),setTimeout(function(){e.style.webkitTransition="-webkit-transform 0.5s ease-in, opacity 0.5s ease-in",e.style.opacity="0",setTimeout(function(){document.body.removeChild(e)},500)},1e3)},NewClass.prototype.writeData=function(t,e){if(cc.sys.platform==cc.sys.WIN32){var a=jsb.fileUtils.getWritablePath();console.log("\u53ef\u5199\u8def\u5f84:",a);var i=a+(1==e?"output.xlsx":"output_calc.xlsx");jsb.fileUtils.isFileExist(i)&&jsb.fileUtils.removeFile(i),jsb.fileUtils.writeStringToFile(t,i)}else navigator.clipboard.writeText(t),this.showToast("\u590d\u5236\u5230\u526a\u5207\u677f\u6210\u529f\uff01")},NewClass.prototype.readData=function(){var _this=this;if(cc.sys.platform==cc.sys.WIN32){var writablePath=jsb.fileUtils.getWritablePath();console.log("\u53ef\u5199\u8def\u5f84:",writablePath);for(var filePath=writablePath+"output.xlsx",text=jsb.fileUtils.getStringFromFile(filePath),str=text.toString(),data=str.split("\n"),i=0;i<data.length;++i){var arr=data[i];if(arr=eval(arr),null!=arr&&""!=arr){var cData=new CubeData;cData.cubes=[],cData.mergeList=[];for(var j=0;j<arr.length;++j){var row=Math.floor(j/this.MAP_COL),col=j%this.MAP_COL;cData.cubes[row]||(cData.cubes[row]=[]);var cube=new NumberCube;cube.row=row,cube.col=col,cube.num=Number(arr[j]),cData.cubes[row][col]=cube}this.clearMapData(),this.mMapData=deepClone(cData.cubes);var merListTmp=this.mergeMap(!0);this.clearMapData(),merListTmp&&merListTmp.length>0&&(cData.mergeList=deepClone(merListTmp)),this.mDataList.push(cData)}}this.initScrollView(),alert("\u4e0a\u4f20\u6570\u636e"+this.mDataList.length+"\u6761")}else navigator.clipboard.readText().then(function(text){for(var str=text.toString(),data=str.split("\n"),i=0;i<data.length;++i){var arr=data[i];if(arr=eval(arr),null!=arr&&""!=arr){var cData=new CubeData;cData.cubes=[],cData.mergeList=[];for(var j=0;j<arr.length;++j){var row=Math.floor(j/_this.MAP_COL),col=j%_this.MAP_COL;cData.cubes[row]||(cData.cubes[row]=[]);var cube=new NumberCube;cube.row=row,cube.col=col,cube.num=Number(arr[j]),cData.cubes[row][col]=cube}_this.clearMapData(),_this.mMapData=deepClone(cData.cubes);var merListTmp=_this.mergeMap(!0);_this.clearMapData(),merListTmp&&merListTmp.length>0&&(cData.mergeList=deepClone(merListTmp)),_this.mDataList.push(cData)}}_this.initScrollView(),alert("\u4e0a\u4f20\u6570\u636e"+_this.mDataList.length+"\u6761")}).catch(function(t){console.error("Failed to read clipboard contents: ",t),_this.showToast("\u4e0a\u4f20\u6570\u636e\u51fa\u9519\uff01")})},__decorate([property({type:cc.Node})],NewClass.prototype,"mapBg",void 0),__decorate([property({type:cc.EditBox})],NewClass.prototype,"input_Line_1",void 0),__decorate([property({type:cc.EditBox})],NewClass.prototype,"input_Line_2",void 0),__decorate([property({type:cc.EditBox})],NewClass.prototype,"input_Line_3",void 0),__decorate([property({type:cc.EditBox})],NewClass.prototype,"input_Line_4",void 0),__decorate([property({type:cc.EditBox})],NewClass.prototype,"input_Line_4_count",void 0),__decorate([property({type:cc.EditBox})],NewClass.prototype,"input_Total_Count",void 0),__decorate([property({type:cc.EditBox})],NewClass.prototype,"input_calc_count",void 0),__decorate([property({type:cc.Button})],NewClass.prototype,"btnDone",void 0),__decorate([property({type:cc.Button})],NewClass.prototype,"btnCopy",void 0),__decorate([property({type:cc.Node})],NewClass.prototype,"cubeNode",void 0),__decorate([property({type:cc.Node})],NewClass.prototype,"mPercentDialog",void 0),__decorate([property({type:cc.Label})],NewClass.prototype,"mLabelPercent",void 0),__decorate([property({type:cc.Toggle})],NewClass.prototype,"mTaggleForceHeadTail",void 0),__decorate([property({type:List_1.default})],NewClass.prototype,"listV",void 0),__decorate([property({type:cc.Label})],NewClass.prototype,"labelLeft_1",void 0),__decorate([property({type:cc.Label})],NewClass.prototype,"labelLeft_2",void 0),NewClass=__decorate([ccclass],NewClass),NewClass}(cc.Component);exports.default=NewClass,cc._RF.pop()},{"./List":"List"}],map4:[function(require,module,exports){"use strict";cc._RF.push(module,"7ff90NufQlFzIAKhmJEuQAM","map4");var __extends=this&&this.__extends||(extendStatics=function(t,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),extendStatics,__decorate=this&&this.__decorate||function(t,e,a,i){var s,o=arguments.length,r=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,a):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,i);else for(var n=t.length-1;n>=0;n--)(s=t[n])&&(r=(o<3?s(r):o>3?s(e,a,r):s(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(exports,"__esModule",{value:!0});var List_1=require("./List"),_a=cc._decorator,ccclass=_a.ccclass,property=_a.property,IntVec2=function(t,e){this.x=0,this.y=0,this.x=t,this.y=e},NumberCube=function(){function t(){this.row=0,this.col=0,this.num=0}return t.prototype.getRowCol=function(){return new IntVec2(this.row,this.col)},t}(),deepArray=function(t){return t.map(deepClone)},deepObject=function(t){var e=Object.keys(t),a={};return e.forEach(function(e){a[e]=deepClone(t[e])}),a},deepClone=function(t){if(null===t||!t)return t;if("[object Object]"===Object.prototype.toString.call(t)){var e={};return Object.keys(t).forEach(function(a){t[a]&&"object"==typeof t[a]?e[a]=deepClone(t[a]):e[a]=t[a]}),e}if(Array.isArray(t)){var a=[];return t.forEach(function(t,e){a[e]=t&&"object"==typeof t?deepClone(t):t}),a}},CubeData=function(){this.prcessCubes_1=[],this.prcessCubes_2=[],this.mergeAdjacentNum=0,this.mergeHvNum=0,this.mergeSlantNum=0,this.mergeSpaceOver1=0,this.mergeHeadTailNum=0,this.comboNum=0,this.comboTimes=0,this.maxCombo=0,this.passPercent=-1,this.copyTimeAvg=0,this.LeftCubeNum=0,this.mergeAdjacentNum_2=0,this.mergeHvNum_2=0,this.mergeSlantNum_2=0,this.mergeSpaceOver1_2=0,this.mergeHeadTailNum_2=0,this.comboNum_2=0,this.comboTimes_2=0,this.maxCombo_2=0,this.passPercent_2=-1,this.copyTimeAvg_2=0,this.LeftCubeNum_2=0},NewClass=function(_super){function NewClass(){var t=null!==_super&&_super.apply(this,arguments)||this;return t.mapBg=null,t.input_Line_1=null,t.input_Line_2=null,t.input_Line_3=null,t.input_Line_4=null,t.input_Line_5=null,t.input_Line_6=null,t.input_Line_6_count=null,t.input_Total_Count=null,t.input_calc_count=null,t.btnDone=null,t.btnCopy=null,t.cubeNode=null,t.mPercentDialog=null,t.mLabelPercent=null,t.mTaggleForceHeadTail=null,t.listV=null,t.labelLeft_1=null,t.labelLeft_2=null,t.mRows=6,t.MAP_ROW=96,t.MAP_COL=9,t.mFistLineNum=0,t.mSecLineNum=0,t.mThirdLineNum=0,t.mFourLineNum=0,t.mFiveLineNum=0,t.mSixLineNum=0,t.mSixLineCountNum=0,t.mNumberPool=[],t.mNumberPoolBeenEmptyed=!1,t.mNeedLink=!1,t.mLinkPercent=0,t.mAddCount=0,t.mTargetNumber=1,t.mTargetCount=10,t.mCalcCount=5,t.mIsForceHeadTail=!1,t.mNowShowIdx=0,t.mNowShowStep=0,t.mSetLeftNum=0,t.mSpecialCount=10,t}return __extends(NewClass,_super),NewClass.prototype.start=function(){this.mDataList=[]},NewClass.prototype.clearMapData=function(){this.mMapData=new Array(this.MAP_ROW);for(var t=0;t<this.MAP_ROW;++t){this.mMapData[t]=new Array(this.MAP_COL);for(var e=0;e<this.MAP_COL;++e)this.mMapData[t][e]=null}},NewClass.prototype.getInputData=function(){var t=Number(this.input_Line_1.string);if(isNaN(t)||t<0||t>4)return alert("\u7b2c\u4e00\u884c\u5bf9\u6570\u53ea\u80fd\u4e3a\uff1a0-4\uff01"),!1;var e=Number(this.input_Line_2.string);if(isNaN(e)||e<0||e>4)return alert("\u7b2c\u4e8c\u884c\u5bf9\u6570\u53ea\u80fd\u4e3a\uff1a0-4\uff01"),!1;var a=Number(this.input_Line_3.string);if(isNaN(a)||a<0||a>9)return alert("\u7b2c\u4e09\u884c\u5bf9\u6570\u53ea\u80fd\u4e3a\uff1a0-9\uff01"),!1;var i=Number(this.input_Line_4.string);if(isNaN(i)||i<0||i>4)return alert("\u7b2c\u56db\u884c\u5bf9\u6570\u53ea\u80fd\u4e3a\uff1a0-4\uff01"),!1;var s=Number(this.input_Line_5.string);if(isNaN(s)||s<0||s>9)return alert("\u7b2c\u4e94\u884c\u5bf9\u6570\u53ea\u80fd\u4e3a\uff1a0-9\uff01"),!1;var o=Number(this.input_Line_6.string);if(isNaN(o)||o<0||o>2*t)return alert("\u7b2c\u516d\u884c\u914d\u5bf9\u6570\u5fc5\u987b\u662f 0 \u5230 \u884c1\u5bf9\u6570x2!"),!1;var r=Number(this.input_Line_6_count.string);if(isNaN(r)||r<=0||r>this.MAP_COL)return alert("\u7b2c\u516d\u884c\u603b\u4e2a\u6570\u4e0d\u80fd\u8d85\u8fc79!"),!1;var n=Number(this.input_Total_Count.string);return isNaN(n)||n<=0||n>1e4?(alert("\u6570\u636e\u603b\u91cf\u53ea\u80fd\u4e3a\uff1a1-10000\uff01"),!1):(this.mFistLineNum=t,this.mSecLineNum=e,this.mThirdLineNum=a,this.mFourLineNum=i,this.mFiveLineNum=s,this.mSixLineNum=o,this.mSixLineCountNum=r,this.mSixLineNum>this.mSixLineCountNum?(alert("\u7b2c\u516d\u884c\u914d\u5bf9\u4e2a\u6570\u4e0d\u80fd\u5927\u4e8e\u7b2c\u516d\u884c\u6700\u5927\u6570\u91cf\u9650\u5236!"),!1):(this.mTargetNumber=0,this.mTargetCount=n,this.mLinkPercent=0,this.mLinkPercent>0&&(this.mNeedLink=!0),this.mIsForceHeadTail=this.mTaggleForceHeadTail.isChecked,!0))},NewClass.prototype.onToggleHeadTail=function(){this.mIsForceHeadTail=this.mTaggleForceHeadTail.isChecked},NewClass.prototype.onBtnDoneClicked=function(){this.getInputData()&&(this.clearMap(),this.createMap(),this.initScrollView(),alert("\u751f\u6210\u9635\u578b\u6210\u529f, \u5171\u751f\u6210"+this.mDataList.length+"\u7ec4\u6570\u636e\uff01"))},NewClass.prototype.onBtnCopyClicked=function(){if(this.mDataList.length<=0)alert("\u5bf9\u4e0d\u8d77\uff0c\u672a\u627e\u5230\u53ef\u590d\u5236\u9635\u578b\uff01");else{for(var t="",e=0;e<this.mDataList.length;++e){for(var a="[",i=this.mDataList[e].cubes,s=0;s<this.mRows;++s){var o=i[s].length;5==s&&(o=this.mSixLineCountNum);for(var r=0;r<o;++r)a+=i[s][r].num,r<o-1&&(a+=",");s<this.mRows-1&&(a+=",")}t+=a+="]\n"}this.writeData(t,1)}},NewClass.prototype.onBtnLoad=function(){this.getInputData()&&(this.mAddCount=5,this.mDataList=[],this.clearMapData(),this.clearMap(),this.readData())},NewClass.prototype.onBtnCalc=function(){if(!this.mDataList||this.mDataList.length<=0)alert("\u6570\u636e\u9519\u8bef\uff01");else try{this.calcAllCubeDatas(!1,0),this.calcAllCubeDatas(!0,0),this.clearPassPercent(),alert("\u8ba1\u7b97\u6570\u636e\u5b8c\u6bd5\uff01")}catch(t){console.log(t),alert("\u8ba1\u7b97\u6570\u636e\u51fa\u9519\uff01")}},NewClass.prototype.onBtnCalcPass=function(){var t=this;if(!this.mDataList||this.mDataList.length<=0)alert("\u6570\u636e\u9519\u8bef\uff01");else{var e=Number(this.input_calc_count.string);if(isNaN(e)||e<=0||e>1e3)alert("\u8ba1\u7b97\u6b21\u6570\u53c2\u6570\u53ea\u80fd\u4e3a\uff1a1-1000\uff01");else{this.mCalcCount=e;try{this.clearPassPercent(),this.mPercentDialog.active=!0,this.mLabelPercent.string="\u8ba1\u7b97\u8fdb\u5ea6\uff1a0%";var a=0,i=setInterval(function(){if(a>=t.mCalcCount)return clearInterval(i),t.mPercentDialog.active=!1,void alert("\u8ba1\u7b97\u901a\u5173\u7387\u5b8c\u6bd5\uff01");for(var e=0;e<t.mDataList.length;++e)t.mDataList[e].prcessCubes_1=[],t.mDataList[e].prcessCubes_2=[];t.calcAllCubeDatas(!1,a),t.calcAllCubeDatas(!0,a),t.mLabelPercent.string="\u8ba1\u7b97\u8fdb\u5ea6\uff1a"+(a+1)*(100/t.mCalcCount)+"%",a++},5)}catch(s){console.log(s),this.mPercentDialog.active=!1,alert("\u8ba1\u7b97\u6570\u636e\u51fa\u9519\uff01")}}}},NewClass.prototype.clearPassPercent=function(){if(this.mDataList&&!(this.mDataList.length<=0))for(var t=0;t<this.mDataList.length;++t)this.mDataList[t].passPercent=-1,this.mDataList[t].passPercent_2=-1},NewClass.prototype.clearMap=function(){for(var t=this.mapBg.children,e=0;e<t.length;++e)t[e].destroy()},NewClass.prototype.onBtnItemClicked=function(t){var e=t.target._listId;this.mNowShowIdx=e,this.mNowShowStep=0;var a=this.mDataList[e].cubes,i=this.mDataList[e].mergeList;this.clearMap();for(var s=0;s<this.mRows;++s)for(var o=0;o<a[s].length;++o)if(a[s][o]){for(var r=!1,n=0;n<i.length;++n)(i[n][0].x==a[s][o].row&&i[n][0].y==a[s][o].col||i[n][1].x==a[s][o].row&&i[n][1].y==a[s][o].col)&&(r=!0);this.addCube(a[s][o],r)}},NewClass.prototype.onBtnRecodClicked=function(t,e){if(!(this.mDataList.length<=0)){var a;!(a=deepClone("11"==e||"12"==e||"13"==e?this.mDataList[this.mNowShowIdx].prcessCubes_1:this.mDataList[this.mNowShowIdx].prcessCubes_2))||a.length<=0||("11"==e||"21"==e?this.mNowShowStep>0&&this.mNowShowStep--:"12"==e||"22"==e?this.mNowShowStep=0:"13"!=e&&"23"!=e||this.mNowShowStep<a.length-1&&this.mNowShowStep++,this.mNowShowStep<0&&(this.mNowShowStep=0),this.mNowShowStep>=a.length&&(this.mNowShowStep=a.length-1),this.fillMap(a[this.mNowShowStep]))}},NewClass.prototype.fillMap=function(t){this.clearMap();for(var e=0;e<t.length;++e)for(var a=0;a<t[e].length;++a)t[e][a]&&this.addCube(t[e][a],!1)},NewClass.prototype.addCube=function(t,e){var a=t.row,i=t.col,s=t.num,o=cc.instantiate(this.cubeNode);o.getChildByName("bg").active=e,cc.resources.load("nums/"+s,cc.SpriteFrame,function(t,e){t&&console.log(t),o.getChildByName("num").getComponent(cc.Sprite).spriteFrame=e}),o.setPosition((i+.5)*(654/9),72.5*-(a+.5)),this.mapBg.addChild(o)},NewClass.prototype.onBtnDownLoad=function(){if(!this.mDataList||this.mDataList.length<=0)alert("\u5bf9\u4e0d\u8d77\uff0c\u6570\u636e\u9519\u8bef\uff01");else{for(var t="\u76f8\u90bb\u6d88\u9664\t\u975e\u76f8\u90bb\u6a2a\u7ad6\u6d88\u9664\t\u975e\u76f8\u90bb\u659c\u5411\u6d88\u9664\t\u975e\u76f8\u90bb\u659c\u5411\u6d88\u9664\u95f4\u96941\t\u975e\u76f8\u90bb\u659c\u5411\u6d88\u9664\u95f4\u9694\u5927\u4e8e1\t\u9996\u5c3e\u6d88\u9664\tcombo\u89e6\u53d1\u5e73\u5747\u6b21\u6570\t\u6700\u5927combo\u6b21\u6570\t\u901a\u5173\u7387\t\u5e73\u5c40\u590d\u5236\u6b21\u6570\t\u76f8\u90bb\u6d88\u9664_2\t\u975e\u76f8\u90bb\u6a2a\u7ad6\u6d88\u9664_2\t\u975e\u76f8\u90bb\u659c\u5411\u6d88\u9664_2\t\u975e\u76f8\u90bb\u659c\u5411\u6d88\u9664\u95f4\u96941_2\t\u975e\u76f8\u90bb\u659c\u5411\u6d88\u9664\u95f4\u9694\u5927\u4e8e1_2\t\u9996\u5c3e\u6d88\u9664_2\tcombo\u89e6\u53d1\u5e73\u5747\u6b21\u6570_2\t\u6700\u5927combo\u6b21\u6570_2\t\u901a\u5173\u7387_2\t\u5e73\u5c40\u590d\u5236\u6b21\u6570_2\t\u5e73\u5747\u5269\u4f59\u65b9\u5757\u6570(\u603b)\t\u5e73\u5747\u5269\u4f59\u65b9\u5757\u6570(\u5931\u8d25)\t\u5e73\u5747\u5269\u4f59\u65b9\u5757\u6570(\u603b)_2\t\u5e73\u5747\u5269\u4f59\u65b9\u5757\u6570(\u5931\u8d25)_2\n",e=0;e<this.mDataList.length;++e){var a="",i=this.mDataList[e].passPercent;a+=this.mDataList[e].mergeAdjacentNum/this.mCalcCount+"\t",a+=this.mDataList[e].mergeHvNum/this.mCalcCount+"\t",a+=this.mDataList[e].mergeSlantNum/this.mCalcCount+"\t",a+=(this.mDataList[e].mergeSlantNum-this.mDataList[e].mergeSpaceOver1)/this.mCalcCount+"\t",a+=this.mDataList[e].mergeSpaceOver1/this.mCalcCount+"\t",a+=this.mDataList[e].mergeHeadTailNum/this.mCalcCount+"\t",this.mDataList[e].comboTimes>0?a+=this.mDataList[e].comboNum/this.mDataList[e].comboTimes+"\t":a+="0\t",a+=this.mDataList[e].maxCombo+"\t",a+=this.mDataList[e].passPercent*(100/this.mCalcCount)+"\t",a+=this.mDataList[e].copyTimeAvg/this.mCalcCount+"\t";var s=this.mDataList[e].passPercent_2;a+=this.mDataList[e].mergeAdjacentNum_2/this.mCalcCount+"\t",a+=this.mDataList[e].mergeHvNum_2/this.mCalcCount+"\t",a+=this.mDataList[e].mergeSlantNum_2/this.mCalcCount+"\t",a+=(this.mDataList[e].mergeSlantNum_2-this.mDataList[e].mergeSpaceOver1_2)/this.mCalcCount+"\t",a+=this.mDataList[e].mergeSpaceOver1_2/this.mCalcCount+"\t",a+=this.mDataList[e].mergeHeadTailNum_2/this.mCalcCount+"\t",this.mDataList[e].comboTimes_2>0?a+=this.mDataList[e].comboNum_2/this.mDataList[e].comboTimes_2+"\t":a+="0\t",a+=this.mDataList[e].maxCombo_2+"\t",a+=this.mDataList[e].passPercent_2*(100/this.mCalcCount)+"\t",a+=this.mDataList[e].copyTimeAvg_2/this.mCalcCount+"\t",a+=this.mDataList[e].LeftCubeNum/this.mCalcCount+"\t",this.mCalcCount-i>0?a+=this.mDataList[e].LeftCubeNum/(this.mCalcCount-i)+"\t":a+="0\t",a+=this.mDataList[e].LeftCubeNum_2/this.mCalcCount+"\t",this.mCalcCount-s>0?a+=this.mDataList[e].LeftCubeNum_2/(this.mCalcCount-s)+"\n":a+="0\n",t+=a}this.writeData(t,2)}},NewClass.prototype.initNumberPool=function(){if(this.mNumberPool.length<=0){for(var t=0;t<this.MAP_COL;++t)this.mNumberPool.push(t+1);this.mNumberPool.sort(function(){return.5-Math.random()}),this.mNumberPoolBeenEmptyed=!0}},NewClass.prototype.initMapData=function(t){this.clearMapData();for(var e=[],a=0;a<this.MAP_COL;a++)e.push(a);e.sort(function(){return.5-Math.random()}),this.mNumberPool=[],this.initNumberPool(),this.mNumberPoolBeenEmptyed=!1;var i=!1;if(t){this.initNumberPool();var s=this.mNumberPool[0];this.mNumberPool.splice(0,1);var o=cc.math.randomRangeInt(0,3),r=this.MAP_COL-1;this.mMapData[o][r]=new NumberCube,this.mMapData[o][r].row=o,this.mMapData[o][r].col=r,this.mMapData[o][r].num=s,o+=1,r=0,this.mMapData[o][r]=new NumberCube,this.mMapData[o][r].row=o,this.mMapData[o][r].col=r,this.mMapData[o][r].num=s,1==cc.math.randomRangeInt(0,2)&&(this.mMapData[o][r].num=10-s),i=3==o}e.sort(function(){return.5-Math.random()});var n=0;for(a=0;a<this.MAP_COL&&n<this.mFistLineNum;++a)if(o=0,r=e[a],!this.mMapData[o][r]){n++,this.initNumberPool();var l=this.mNumberPool[0];-1==this.fillMapNumber(o,r,l,3,!0)&&this.fillMapNumber(o,r,l,3,!1)}for(n=0,a=0;a<this.MAP_COL&&n<this.mSecLineNum;++a)if(o=1,r=e[a],!this.mMapData[o][r]){n++,this.initNumberPool();var h=0;l=this.mNumberPool[h],this.mNumberPool.splice(h,1),this.mMapData[o][r]=new NumberCube,this.mMapData[o][r].row=o,this.mMapData[o][r].col=r,this.mMapData[o][r].num=l,-1==this.fillMapNumber(o,r,l,3,!0)&&this.fillMapNumber(o,r,l,3,!1)}e.sort(function(){return.5-Math.random()});var c=[];for(a=0;a<this.MAP_COL;++a){var m=e[a];this.mMapData[0][m]&&c.push(m)}for(a=0;a<c.length;++a){var p=2;if(m=c[a],!(this.mMapData[p][m]||i&&0==m)&&(this.mMapData[p][m]=new NumberCube,this.mMapData[p][m].row=p,this.mMapData[p][m].col=m,this.mMapData[p][m].num=this.mMapData[0][m].num,a%2==1&&.8-Math.random()>0&&(!i||0!=c[a-1]))){var u=this.mMapData[p][c[a-1]].num;this.mMapData[p][c[a-1]].num=this.mMapData[p][m].num,this.mMapData[p][m].num=u}}for(e.sort(function(){return.5-Math.random()}),n=0,a=0;a<this.MAP_COL&&n<this.mFourLineNum;++a)o=3,r=e[a],this.mMapData[o][r]||(n++,this.initNumberPool(),h=0,l=this.mNumberPool[h],this.mNumberPool.splice(h,1),this.mMapData[o][r]=new NumberCube,this.mMapData[o][r].row=o,this.mMapData[o][r].col=r,this.mMapData[o][r].num=l,-1==this.fillMapNumber(o,r,l,3,!0)&&this.fillMapNumber(o,r,l,3,!1));e.sort(function(){return.5-Math.random()});var d=[];for(a=0;a<this.MAP_COL&&a<this.mFiveLineNum;++a)m=e[a],this.mMapData[2][m]&&d.push(m);for(a=0;a<d.length;++a)p=4,m=d[a],this.mMapData[p][m]||i&&0==m||(this.mMapData[p][m]=new NumberCube,this.mMapData[p][m].row=p,this.mMapData[p][m].col=m,this.mMapData[p][m].num=this.mMapData[2][m].num,!(a%2==1&&.8-Math.random()>0)||i&&0==d[a-1])||(u=this.mMapData[p][d[a-1]].num,this.mMapData[p][d[a-1]].num=this.mMapData[p][m].num,this.mMapData[p][m].num=u);e.sort(function(){return.5-Math.random()});var _=[];for(a=0;a<this.MAP_COL&&a<this.mSixLineNum;++a)m=e[a],this.mMapData[0][m]&&m<this.mSixLineCountNum&&_.push(m);for(a=0;a<_.length;++a)p=5,m=_[a],this.mMapData[p][m]||i&&0==m||(this.mMapData[p][m]=new NumberCube,this.mMapData[p][m].row=p,this.mMapData[p][m].col=m,this.mMapData[p][m].num=this.mMapData[0][m].num,!(a%2==1&&.8-Math.random()>0)||i&&0==_[a-1])||(u=this.mMapData[p][_[a-1]].num,this.mMapData[p][_[a-1]].num=this.mMapData[p][m].num,this.mMapData[p][m].num=u);var f=[];for(a=0;a<6;++a){var y=this.MAP_COL;5==a&&(y=this.mSixLineCountNum);for(var C=0;C<y;++C)this.mMapData[a][C]||f.push(new IntVec2(a,C))}for(var g=0,D=0;f.length>0;){this.initNumberPool();var w=-1;if(s=0,g%2==1){var b=[D,10-D];if(this.mNumberPoolBeenEmptyed){for(b=[],a=0;a<9;++a)b[a]=a+1;b.sort(function(){return.5-Math.random()})}for(h=0;h<b.length;++h){for(s=b[h],a=0;a<f.length;++a){var L=f[a];if(this.mMapData[L.x][L.y]=new NumberCube,this.mMapData[L.x][L.y].row=L.x,this.mMapData[L.x][L.y].col=L.y,this.mMapData[L.x][L.y].num=s,!this.canSingleCubeMerge(L)){w=a;break}this.mMapData[L.x][L.y]=null}if(w>=0)break}}else for(h=0;h<this.mNumberPool.length;++h){for(s=this.mNumberPool[h],a=0;a<f.length;++a){if(L=f[a],this.mMapData[L.x][L.y]=new NumberCube,this.mMapData[L.x][L.y].row=L.x,this.mMapData[L.x][L.y].col=L.y,this.mMapData[L.x][L.y].num=s,!this.canSingleCubeMerge(L)){w=a,this.mNumberPool.splice(h,1);break}this.mMapData[L.x][L.y]=null}if(w>=0)break}if(-1==w){var v=.5>Math.random()?D:10-D;g%2==1?s=v:(s=this.mNumberPool[0],this.mNumberPool.splice(0,1)),L=f[w=cc.math.randomRangeInt(0,f.length)],this.mMapData[L.x][L.y]=new NumberCube,this.mMapData[L.x][L.y].row=L.x,this.mMapData[L.x][L.y].col=L.y,this.mMapData[L.x][L.y].num=s}D=s,f.splice(w,1),g++}},NewClass.prototype.fillMapNumber=function(t,e,a,i,s){var o=-1;if(1==t||3==t){var r=new IntVec2(t+2,e-2),n=new IntVec2(t+2,e+2);3==t&&(r=new IntVec2(t-2,e-2),n=new IntVec2(t-2,e+2)),this.isValidRowCol(r)&&!this.mMapData[r.x][r.y]&&(this.mMapData[r.x][r.y]=new NumberCube,this.mMapData[r.x][r.y].row=r.x,this.mMapData[r.x][r.y].col=r.y,this.mMapData[r.x][r.y].num=a,1==cc.math.randomRangeInt(0,2)&&(this.mMapData[r.x][r.y].num=10-a),o=0,s&&this.canSingleCubeMerge(r)&&(o=-1,this.mMapData[r.x][r.y]=null)),-1==o&&this.isValidRowCol(n)&&!this.mMapData[n.x][n.y]&&(this.mMapData[n.x][n.y]=new NumberCube,this.mMapData[n.x][n.y].row=n.x,this.mMapData[n.x][n.y].col=n.y,this.mMapData[n.x][n.y].num=a,1==cc.math.randomRangeInt(0,2)&&(this.mMapData[n.x][n.y].num=10-a),o=1,s&&this.canSingleCubeMerge(n)&&(o=-1,this.mMapData[n.x][n.y]=null))}if(-1==o){for(var l=[],h=e+i;h<this.MAP_COL;++h)this.mMapData[t][h]||l.push(h);for(h=e-i;h>=0;--h)this.mMapData[t][h]||l.push(h);l.length>0&&(h=l[h=cc.math.randomRangeInt(0,l.length)],this.mMapData[t][h]=new NumberCube,this.mMapData[t][h].row=t,this.mMapData[t][h].col=h,this.mMapData[t][h].num=a,1==cc.math.randomRangeInt(0,2)&&(this.mMapData[t][h].num=10-a),o=2,s&&this.canSingleCubeMerge(new IntVec2(t,h))&&(o=-1,this.mMapData[t][h]=null))}return o},NewClass.prototype.getAllCubes=function(){for(var t=[],e=0;e<this.MAP_ROW;++e)for(var a=0;a<this.MAP_COL;++a)if(this.mMapData[e]&&this.mMapData[e][a]){var i=new NumberCube;i.row=this.mMapData[e][a].row,i.col=this.mMapData[e][a].col,i.num=this.mMapData[e][a].num,t.push(i)}return t},NewClass.prototype.createMap=function(){this.mDataList=[];for(var t=0,e=0;e<this.mTargetCount&&t<1e5;++e){t++,this.initMapData(this.mIsForceHeadTail);var a=new CubeData;a.cubes=deepClone(this.mMapData),a.mergeList=(new Array).fill([]),a.mergeList=[],this.mDataList.push(a)}},NewClass.prototype.mergeMap=function(t){for(var e=[],a=this.getAllCubes(),i=0;i<a.length;++i)for(var s=0;s<a.length;++s)if(i!=s){var o=a[i].row,r=a[i].col,n=a[s].row,l=a[s].col;if(null!=this.mMapData[o][r]&&null!=this.mMapData[n][l]){for(var h=!1,c=0;c<e.length;++c){var m=e[c][0],p=e[c][1];if(m.x==a[i].row&&m.y==a[i].col||m.x==a[s].row&&m.y==a[s].col){h=!0;break}if(p.x==a[i].row&&p.y==a[i].col||p.x==a[s].row&&p.y==a[s].col){h=!0;break}}h||this.canCubeMerge(a[i].getRowCol(),a[s].getRowCol())&&(e.push([a[i].getRowCol(),a[s].getRowCol()]),t&&(this.mMapData[o][r]=null,this.mMapData[n][l]=null),i=0,s=0)}}return e},NewClass.prototype.getOptimalIndex=function(t,e){var a=-1;if(!t||t.length<=0)return a;a=cc.math.randomRangeInt(0,t.length);var i=!1;if(e)for(var s=0;s<t.length;++s){var o=t[s][0],r=t[s][1];if(3==o.x||4==o.x||3==r.x||4==r.x){i=!0,a=s;break}}if(!i)for(s=0;s<t.length;++s){if(o=t[s][0],r=t[s][1],o.x==r.x&&2==this.getRowCubes(o.x)){i=!0,a=s;break}if(1==this.getRowCubes(o.x)||1==this.getRowCubes(r.x)){i=!0,a=s;break}}return a},NewClass.prototype.getRowCubes=function(t){for(var e=0,a=0;a<this.MAP_COL;++a){var i=new IntVec2(t,a);this.isValidRowCol(i)&&this.mMapData[i.x][i.y]&&e++}return e},NewClass.prototype.getCubeRoundRC=function(t){var e=new Array;if(!this.isValidRowCol(t))return e;var a=new IntVec2(t.x-1,t.y-1);return this.isValidRowCol(a)&&e.push(a),a=new IntVec2(t.x-1,t.y),this.isValidRowCol(a)&&e.push(a),a=new IntVec2(t.x-1,t.y+1),this.isValidRowCol(a)&&e.push(a),a=new IntVec2(t.x,t.y-1),this.isValidRowCol(a)&&e.push(a),a=new IntVec2(t.x,t.y+1),this.isValidRowCol(a)&&e.push(a),a=new IntVec2(t.x+1,t.y-1),this.isValidRowCol(a)&&e.push(a),a=new IntVec2(t.x+1,t.y),this.isValidRowCol(a)&&e.push(a),a=new IntVec2(t.x+1,t.y+1),this.isValidRowCol(a)&&e.push(a),e},NewClass.prototype.initScrollView=function(){this.listV.numItems=this.mDataList.length},NewClass.prototype.isValidRowCol=function(t){return!(t.x<0||t.x>=this.MAP_ROW||t.y<0||t.y>=this.MAP_COL||5==t.x&&t.y>=this.mSixLineCountNum)},NewClass.prototype.isRowColEqual=function(t,e){return t.x==e.x&&t.y==e.y},NewClass.prototype.canCubeMerge=function(t,e){if(!this.isValidRowCol(t)||!this.isValidRowCol(e)||this.isRowColEqual(t,e))return!1;var a=this.mMapData[t.x][t.y],i=this.mMapData[e.x][e.y];if(!a||!i)return!1;var s=a.num+i.num==10,o=a.num==i.num;if(!s&&!o)return!1;var r=[];if(t.x==e.x)for(var n=Math.min(t.y,e.y),l=Math.max(t.y,e.y),h=n+1;h<l;++h)(u=this.mMapData[t.x][h])&&r.push(u);else if(t.y==e.y){var c=Math.min(t.x,e.x),m=Math.max(t.x,e.x);for(h=c+1;h<m;++h)(u=this.mMapData[h][t.y])&&r.push(u)}else if(t.x<e.x&&t.y<e.y&&e.x-t.x==e.y-t.y){h=t.x+1;for(var p=t.y+1;h<e.x&&p<e.y;++h,++p)(u=this.mMapData[h][p])&&r.push(u)}else if(t.x>e.x&&t.y<e.y&&t.x-e.x==e.y-t.y)for(h=t.x-1,p=t.y+1;h>e.x&&p<e.y;--h,++p)(u=this.mMapData[h][p])&&r.push(u);else if(t.x>e.x&&t.y>e.y&&t.x-e.x==t.y-e.y)for(h=t.x-1,p=t.y-1;h>e.x&&p>e.y;--h,--p)(u=this.mMapData[h][p])&&r.push(u);else if(t.x<e.x&&t.y>e.y&&e.x-t.x==t.y-e.y)for(h=t.x+1,p=t.y-1;h<e.x&&p>e.y;++h,--p)(u=this.mMapData[h][p])&&r.push(u);else if(t.x<e.x){for(p=t.y+1;p<this.MAP_COL;++p)(u=this.mMapData[t.x][p])&&r.push(u);for(h=t.x+1;h<e.x;++h)for(p=0;p<this.MAP_COL;++p)(u=this.mMapData[h][p])&&r.push(u);for(p=0;p<e.y;++p)(u=this.mMapData[e.x][p])&&r.push(u)}else if(t.x>e.x){for(p=t.y-1;p>=0;--p)(u=this.mMapData[t.x][p])&&r.push(u);for(h=t.x-1;h>e.x;--h)for(p=this.MAP_COL-1;p>=0;--p)(u=this.mMapData[h][p])&&r.push(u);for(p=this.MAP_COL-1;p>e.y;--p){var u;(u=this.mMapData[e.x][p])&&r.push(u)}}return 0==r.length},NewClass.prototype.canSingleCubeMerge=function(t){for(var e=this.getAllCubes(),a=0;a<e.length;++a)if(this.canCubeMerge(t,e[a].getRowCol()))return!0;return!1},NewClass.prototype.onListVRender=function(t,e){for(var a=this.mDataList[e],i=cc.find("bg/labelData",t),s=e+1+"--[",o=a.cubes,r=0;r<this.mRows;++r){var n=o[r].length;5==r&&(n=this.mSixLineCountNum);for(var l=0;l<n;++l)s+=o[r][l].num,l<n-1&&(s+=",");r<this.mRows-1?s+=",":s+="]"}i.getComponent(cc.Label).string=s},NewClass.prototype.calcAllCubeDatas=function(t){if(!this.mDataList||this.mDataList.length<=0)alert("\u6570\u636e\u51fa\u9519\uff0c\u8bf7\u91cd\u65b0\u4e0a\u4f20\uff01");else{this.mCalcCount,this.mDataList.length,this.mDataList.length,t&&this.mDataList.length;for(var e=0;e<this.mDataList.length;++e){var a=this.mDataList[e];this.clearMapData(),this.mMapData=deepClone(a.cubes),this.addMapRecord(t,e),this.mLastRC=new IntVec2(5,this.mSixLineCountNum-1);var i=this.mAddCount;t&&i>0&&(this.addNewNumbers(),this.mDataList[e].copyTimeAvg_2+=1,i-=1,this.addMapRecord(t,e));for(var s=0,o=0,r=this.mergeMap(!1),n=!1;r.length>0;){var l=this.getOptimalIndex(r,t&&i==this.mAddCount-1),h=r[l][0],c=r[l][1];n||(this.isHeadTails(h,c)?t?this.mDataList[e].mergeHeadTailNum_2+=1:this.mDataList[e].mergeHeadTailNum+=1:h.x==c.x&&Math.abs(h.y-c.y)>1?t?this.mDataList[e].mergeHvNum_2+=1:this.mDataList[e].mergeHvNum+=1:h.y==c.y&&Math.abs(h.x-c.x)>1?t?this.mDataList[e].mergeHvNum_2+=1:this.mDataList[e].mergeHvNum+=1:Math.abs(h.x-c.x)==Math.abs(h.y-c.y)&&Math.abs(h.x-c.x)>1?t?(this.mDataList[e].mergeSlantNum_2+=1,Math.abs(h.x-c.x)>2&&(this.mDataList[e].mergeSpaceOver1_2+=1)):(this.mDataList[e].mergeSlantNum+=1,Math.abs(h.x-c.x)>2&&(this.mDataList[e].mergeSpaceOver1+=1)):t?this.mDataList[e].mergeAdjacentNum_2+=1:this.mDataList[e].mergeAdjacentNum+=1),this.mMapData[h.x][h.y]=null,this.mMapData[c.x][c.y]=null;var m=!1;if(this.getRowCubes(h.x)<=0&&(h.x==this.mLastRC.x&&(this.mLastRC.y=this.MAP_COL-1),this.mLastRC.x-=1,m=!0),h.x!=c.x&&this.getRowCubes(c.x)<=0&&(c.x==this.mLastRC.x&&(this.mLastRC.y=this.MAP_COL-1),this.mLastRC.x-=1,m=!0),m?s+=1:s=0,s>1&&o++,this.checkEmptyLine(),this.addMapRecord(t,e),this.getAllCubes().length<=0)break;for(r=this.mergeMap(!1);r.length<=0&&i>0;)this.addNewNumbers(),n=!0,t?this.mDataList[e].copyTimeAvg_2+=1:this.mDataList[e].copyTimeAvg+=1,this.addMapRecord(t,e),i-=1,r=this.mergeMap(!1)}var p=this.getAllCubes();t?(this.mDataList[e].passPercent_2<=0&&(this.mDataList[e].passPercent_2=0),this.mDataList[e].passPercent_2+=0==p.length?1:0):(this.mDataList[e].passPercent<=0&&(this.mDataList[e].passPercent=0),this.mDataList[e].passPercent+=0==p.length?1:0),t?this.mDataList[e].LeftCubeNum_2+=p.length:this.mDataList[e].LeftCubeNum+=p.length,t?0==p.length&&(this.mDataList[e].comboNum_2+=o,this.mDataList[e].maxCombo_2=Math.max(this.mDataList[e].maxCombo_2,o),this.mDataList[e].comboTimes_2+=1):0==p.length&&(this.mDataList[e].comboNum+=o,this.mDataList[e].maxCombo=Math.max(this.mDataList[e].maxCombo,o),this.mDataList[e].comboTimes+=1)}}},NewClass.prototype.addMapRecord=function(t,e){t?this.mDataList[e].prcessCubes_2.push(deepClone(this.mMapData)):this.mDataList[e].prcessCubes_1.push(deepClone(this.mMapData))},NewClass.prototype.checkEmptyLine=function(){for(var t=1;t<this.MAP_ROW;++t){for(var e=!0,a=0;a<this.MAP_COL;++a)if(this.mMapData[t]&&this.mMapData[t][a]){e=!1;break}if(!e){for(var i=0,s=t-1;s>=0;--s){var o=!0;for(a=0;a<this.MAP_COL;++a)if(this.mMapData[s][a]){o=!1;break}if(!o)break;i++}if(i>0){for(var r=t;r<this.MAP_ROW;++r)for(a=0;a<this.MAP_COL;++a)if(this.mMapData[r]){var n=r-i;this.mMapData[n][a]=this.mMapData[r][a],this.mMapData[r][a]=null,this.mMapData[n][a]&&(this.mMapData[n][a].row=n)}t-=i}}}},NewClass.prototype.addNewNumbers=function(){for(var t=this.getAllCubes(),e=0,a=this.mLastRC,i=this.mLastRC.x;i<this.MAP_ROW;++i)for(var s=i==this.mLastRC.x?this.mLastRC.y+1:0;s<this.MAP_COL;++s){this.mMapData[i]||(this.mMapData[i]=[]);var o=t[e++],r=new NumberCube;r.row=i,r.col=s,r.num=o.num,this.mMapData[i][s]=r,a.x=i,a.y=s,e>=t.length&&(i=this.MAP_ROW,s=this.MAP_COL)}this.mLastRC=a},NewClass.prototype.isHeadTails=function(t,e){var a=!1,i=0;if(t.x<e.x){for(var s=t.y+1;s<this.MAP_COL;++s)null!=this.mMapData[t.x][s]&&i++;for(var o=t.x+1;o<e.x;++o)for(s=0;s<this.MAP_COL;++s)null!=this.mMapData[o][s]&&i++;for(s=0;s<e.y;++s)null!=this.mMapData[e.x][s]&&i++;0==i&&(a=!0)}else if(t.x>e.x){for(s=t.y-1;s>=0;--s)null!=this.mMapData[t.x][s]&&i++;for(o=t.x-1;o>e.x;--o)for(s=this.MAP_COL-1;s>=0;--s)null!=this.mMapData[o][s]&&i++;for(s=this.MAP_COL-1;s>e.y;--s)null!=this.mMapData[e.x][s]&&i++;0==i&&(a=!0)}return a},NewClass.prototype.onBtnOldVersionClicked=function(t,e){"1"==e?cc.director.loadScene("main"):"2"==e?cc.director.loadScene("map2"):cc.director.loadScene("map3")},NewClass.prototype.showToast=function(t){var e=document.createElement("div");e.innerHTML=t,e.style.cssText="width:40%; min-width:180px; background:#000; opacity:0.8; height:auto;min-height: 50px; color:#fff; line-height:200px; font-size:60; text-align:center; border-radius:4px; position:fixed; top:60%; left:30%; z-index:999999;",document.body.appendChild(e),setTimeout(function(){e.style.webkitTransition="-webkit-transform 0.5s ease-in, opacity 0.5s ease-in",e.style.opacity="0",setTimeout(function(){document.body.removeChild(e)},500)},1e3)},NewClass.prototype.writeData=function(t,e){if(cc.sys.platform==cc.sys.WIN32){var a=jsb.fileUtils.getWritablePath();console.log("\u53ef\u5199\u8def\u5f84:",a);var i=a+(1==e?"output.xlsx":"output_calc.xlsx");jsb.fileUtils.isFileExist(i)&&jsb.fileUtils.removeFile(i),jsb.fileUtils.writeStringToFile(t,i)}else navigator.clipboard.writeText(t),this.showToast("\u590d\u5236\u5230\u526a\u5207\u677f\u6210\u529f\uff01")},NewClass.prototype.readData=function(){var _this=this;if(cc.sys.platform==cc.sys.WIN32){var writablePath=jsb.fileUtils.getWritablePath();console.log("\u53ef\u5199\u8def\u5f84:",writablePath);for(var filePath=writablePath+"output.xlsx",text=jsb.fileUtils.getStringFromFile(filePath),str=text.toString(),data=str.split("\n"),i=0;i<data.length;++i){var arr=data[i];if(arr=eval(arr),null!=arr&&""!=arr){var cData=new CubeData;cData.cubes=[],cData.mergeList=[];for(var j=0;j<arr.length;++j){var row=Math.floor(j/this.MAP_COL),col=j%this.MAP_COL;cData.cubes[row]||(cData.cubes[row]=[]);var cube=new NumberCube;cube.row=row,cube.col=col,cube.num=Number(arr[j]),cData.cubes[row][col]=cube}this.clearMapData(),this.mMapData=deepClone(cData.cubes);var merListTmp=this.mergeMap(!0);this.clearMapData(),merListTmp&&merListTmp.length>0&&(cData.mergeList=deepClone(merListTmp)),this.mDataList.push(cData)}}this.initScrollView(),alert("\u4e0a\u4f20\u6570\u636e"+this.mDataList.length+"\u6761")}else navigator.clipboard.readText().then(function(text){for(var str=text.toString(),data=str.split("\n"),i=0;i<data.length;++i){var arr=data[i];if(arr=eval(arr),null!=arr&&""!=arr){var cData=new CubeData;cData.cubes=[],cData.mergeList=[];for(var j=0;j<arr.length;++j){var row=Math.floor(j/_this.MAP_COL),col=j%_this.MAP_COL;cData.cubes[row]||(cData.cubes[row]=[]);var cube=new NumberCube;cube.row=row,cube.col=col,cube.num=Number(arr[j]),cData.cubes[row][col]=cube}_this.clearMapData(),_this.mMapData=deepClone(cData.cubes);var merListTmp=_this.mergeMap(!0);_this.clearMapData(),merListTmp&&merListTmp.length>0&&(cData.mergeList=deepClone(merListTmp)),_this.mDataList.push(cData)}}_this.initScrollView(),alert("\u4e0a\u4f20\u6570\u636e"+_this.mDataList.length+"\u6761")}).catch(function(t){console.error("Failed to read clipboard contents: ",t),_this.showToast("\u4e0a\u4f20\u6570\u636e\u51fa\u9519\uff01")})},__decorate([property({type:cc.Node})],NewClass.prototype,"mapBg",void 0),__decorate([property({type:cc.EditBox})],NewClass.prototype,"input_Line_1",void 0),__decorate([property({type:cc.EditBox})],NewClass.prototype,"input_Line_2",void 0),__decorate([property({type:cc.EditBox})],NewClass.prototype,"input_Line_3",void 0),__decorate([property({type:cc.EditBox})],NewClass.prototype,"input_Line_4",void 0),__decorate([property({type:cc.EditBox})],NewClass.prototype,"input_Line_5",void 0),__decorate([property({type:cc.EditBox})],NewClass.prototype,"input_Line_6",void 0),__decorate([property({type:cc.EditBox})],NewClass.prototype,"input_Line_6_count",void 0),__decorate([property({type:cc.EditBox})],NewClass.prototype,"input_Total_Count",void 0),__decorate([property({type:cc.EditBox})],NewClass.prototype,"input_calc_count",void 0),__decorate([property({type:cc.Button})],NewClass.prototype,"btnDone",void 0),__decorate([property({type:cc.Button})],NewClass.prototype,"btnCopy",void 0),__decorate([property({type:cc.Node})],NewClass.prototype,"cubeNode",void 0),__decorate([property({type:cc.Node})],NewClass.prototype,"mPercentDialog",void 0),__decorate([property({type:cc.Label})],NewClass.prototype,"mLabelPercent",void 0),__decorate([property({type:cc.Toggle})],NewClass.prototype,"mTaggleForceHeadTail",void 0),__decorate([property({type:List_1.default})],NewClass.prototype,"listV",void 0),__decorate([property({type:cc.Label})],NewClass.prototype,"labelLeft_1",void 0),__decorate([property({type:cc.Label})],NewClass.prototype,"labelLeft_2",void 0),NewClass=__decorate([ccclass],NewClass),NewClass}(cc.Component);exports.default=NewClass,cc._RF.pop()},{"./List":"List"}],map5:[function(require,module,exports){"use strict";cc._RF.push(module,"8d8d4mn26RJSK4L+bZifVMx","map5");var __extends=this&&this.__extends||(extendStatics=function(t,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),extendStatics,__decorate=this&&this.__decorate||function(t,e,a,i){var s,o=arguments.length,r=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,a):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,i);else for(var n=t.length-1;n>=0;n--)(s=t[n])&&(r=(o<3?s(r):o>3?s(e,a,r):s(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(exports,"__esModule",{value:!0});var List_1=require("./List"),_a=cc._decorator,ccclass=_a.ccclass,property=_a.property,IntVec2=function(t,e){this.x=0,this.y=0,this.x=t,this.y=e},NumberCube=function(){function t(){this.row=0,this.col=0,this.num=0}return t.prototype.getRowCol=function(){return new IntVec2(this.row,this.col)},t}(),deepArray=function(t){return t.map(deepClone)},deepObject=function(t){var e=Object.keys(t),a={};return e.forEach(function(e){a[e]=deepClone(t[e])}),a},deepClone=function(t){if(null===t||!t)return t;if("[object Object]"===Object.prototype.toString.call(t)){var e={};return Object.keys(t).forEach(function(a){t[a]&&"object"==typeof t[a]?e[a]=deepClone(t[a]):e[a]=t[a]}),e}if(Array.isArray(t)){var a=[];return t.forEach(function(t,e){a[e]=t&&"object"==typeof t?deepClone(t):t}),a}},CubeData=function(){this.prcessCubes_1=[],this.prcessCubes_2=[],this.mergeAdjacentNum=0,this.mergeHvNum=0,this.mergeSlantNum=0,this.mergeSpaceOver1=0,this.mergeHeadTailNum=0,this.comboNum=0,this.comboTimes=0,this.maxCombo=0,this.passPercent=-1,this.copyTimeAvg=0,this.LeftCubeNum=0,this.mergeAdjacentNum_2=0,this.mergeHvNum_2=0,this.mergeSlantNum_2=0,this.mergeSpaceOver1_2=0,this.mergeHeadTailNum_2=0,this.comboNum_2=0,this.comboTimes_2=0,this.maxCombo_2=0,this.passPercent_2=-1,this.copyTimeAvg_2=0,this.LeftCubeNum_2=0},NewClass=function(_super){function NewClass(){var t=null!==_super&&_super.apply(this,arguments)||this;return t.mapBg=null,t.input_Line_1=null,t.input_Line_2=null,t.input_Line_3=null,t.input_Line_4=null,t.input_Line_5=null,t.input_Line_5_count=null,t.input_Total_Count=null,t.input_calc_count=null,t.btnDone=null,t.btnCopy=null,t.cubeNode=null,t.mPercentDialog=null,t.mLabelPercent=null,t.mTaggleForceHeadTail=null,t.listV=null,t.labelLeft_1=null,t.labelLeft_2=null,t.mRows=5,t.MAP_ROW=96,t.MAP_COL=9,t.mFistLineNum=0,t.mSecLineNum=0,t.mThirdLineNum=0,t.mFourLineNum=0,t.mFiveLineNum=0,t.mFiveLineCountNum=0,t.mNumberPool=[],t.mNumberPoolBeenEmptyed=!1,t.mNeedLink=!1,t.mLinkPercent=0,t.mAddCount=0,t.mTargetNumber=1,t.mTargetCount=10,t.mCalcCount=5,t.mIsForceHeadTail=!1,t.mNowShowIdx=0,t.mNowShowStep=0,t.mSetLeftNum=0,t.mSpecialCount=10,t.mOutPutFileTime="",t}return __extends(NewClass,_super),NewClass.prototype.start=function(){this.mDataList=[]},NewClass.prototype.clearMapData=function(){this.mMapData=new Array(this.MAP_ROW);for(var t=0;t<this.MAP_ROW;++t){this.mMapData[t]=new Array(this.MAP_COL);for(var e=0;e<this.MAP_COL;++e)this.mMapData[t][e]=null}},NewClass.prototype.getInputData=function(){var t=Number(this.input_Line_1.string);if(isNaN(t)||t<0||t>4)return alert("\u7b2c\u4e00\u884c\u5bf9\u6570\u53ea\u80fd\u4e3a\uff1a0-4\uff01"),!1;var e=Number(this.input_Line_2.string);if(isNaN(e)||e<0||e>4)return alert("\u7b2c\u4e8c\u884c\u5bf9\u6570\u53ea\u80fd\u4e3a\uff1a0-4\uff01"),!1;var a=Number(this.input_Line_3.string);if(isNaN(a)||a<0||a>9)return alert("\u7b2c\u4e09\u884c\u5bf9\u6570\u53ea\u80fd\u4e3a\uff1a0-9\uff01"),!1;var i=Number(this.input_Line_4.string);if(isNaN(i)||i<0||i>4)return alert("\u7b2c\u56db\u884c\u5bf9\u6570\u53ea\u80fd\u4e3a\uff1a0-4\uff01"),!1;var s=Number(this.input_Line_5.string);if(isNaN(s)||s<0||s>2*t)return alert("\u7b2c\u4e94\u884c\u914d\u5bf9\u6570\u5fc5\u987b\u662f 0 \u5230 \u884c1\u5bf9\u6570x2!"),!1;var o=Number(this.input_Line_5_count.string);if(isNaN(o)||o<=0||o>this.MAP_COL)return alert("\u7b2c\u4e94\u884c\u603b\u4e2a\u6570\u4e0d\u80fd\u8d85\u8fc79!"),!1;var r=Number(this.input_Total_Count.string);return isNaN(r)||r<=0||r>1e4?(alert("\u6570\u636e\u603b\u91cf\u53ea\u80fd\u4e3a\uff1a1-10000\uff01"),!1):(this.mFistLineNum=t,this.mSecLineNum=e,this.mThirdLineNum=a,this.mFourLineNum=i,this.mFiveLineNum=s,this.mFiveLineCountNum=o,this.mFiveLineNum>this.mFiveLineCountNum?(alert("\u7b2c\u4e94\u884c\u914d\u5bf9\u4e2a\u6570\u4e0d\u80fd\u5927\u4e8e\u7b2c\u4e94\u884c\u6700\u5927\u6570\u91cf\u9650\u5236!"),!1):(this.mTargetNumber=0,this.mTargetCount=r,this.mLinkPercent=0,this.mLinkPercent>0&&(this.mNeedLink=!0),this.mIsForceHeadTail=this.mTaggleForceHeadTail.isChecked,!0))},NewClass.prototype.onToggleHeadTail=function(){this.mIsForceHeadTail=this.mTaggleForceHeadTail.isChecked},NewClass.prototype.onBtnDoneClicked=function(){this.getInputData()&&(this.clearMap(),this.createMap(),this.initScrollView(),alert("\u751f\u6210\u9635\u578b\u6210\u529f, \u5171\u751f\u6210"+this.mDataList.length+"\u7ec4\u6570\u636e\uff01"))},NewClass.prototype.onBtnCopyClicked=function(){if(this.mDataList.length<=0)alert("\u5bf9\u4e0d\u8d77\uff0c\u672a\u627e\u5230\u53ef\u590d\u5236\u9635\u578b\uff01");else{for(var t="",e=0;e<this.mDataList.length;++e){for(var a="[",i=this.mDataList[e].cubes,s=0;s<this.mRows;++s){var o=i[s].length;4==s&&(o=this.mFiveLineCountNum);for(var r=0;r<o;++r)a+=i[s][r].num,r<o-1&&(a+=",");s<this.mRows-1&&(a+=",")}t+=a+="]\n"}this.writeData(t,1)}},NewClass.prototype.onBtnLoad=function(){this.getInputData()&&(this.mAddCount=5,this.mDataList=[],this.clearMapData(),this.clearMap(),this.readData())},NewClass.prototype.onBtnCalc=function(){if(!this.mDataList||this.mDataList.length<=0)alert("\u6570\u636e\u9519\u8bef\uff01");else try{this.calcAllCubeDatas(!1,0),this.calcAllCubeDatas(!0,0),this.clearPassPercent(),alert("\u8ba1\u7b97\u6570\u636e\u5b8c\u6bd5\uff01")}catch(t){console.log(t),alert("\u8ba1\u7b97\u6570\u636e\u51fa\u9519\uff01")}},NewClass.prototype.onBtnCalcPass=function(){var t=this;if(!this.mDataList||this.mDataList.length<=0)alert("\u6570\u636e\u9519\u8bef\uff01");else{var e=Number(this.input_calc_count.string);if(isNaN(e)||e<=0||e>1e3)alert("\u8ba1\u7b97\u6b21\u6570\u53c2\u6570\u53ea\u80fd\u4e3a\uff1a1-1000\uff01");else{this.mCalcCount=e;try{this.clearPassPercent(),this.mPercentDialog.active=!0,this.mLabelPercent.string="\u8ba1\u7b97\u8fdb\u5ea6\uff1a0%";var a=0,i=setInterval(function(){if(a>=t.mCalcCount)return clearInterval(i),t.mPercentDialog.active=!1,void alert("\u8ba1\u7b97\u901a\u5173\u7387\u5b8c\u6bd5\uff01");for(var e=0;e<t.mDataList.length;++e)t.mDataList[e].prcessCubes_1=[],t.mDataList[e].prcessCubes_2=[];t.calcAllCubeDatas(!1,a),t.calcAllCubeDatas(!0,a),t.mLabelPercent.string="\u8ba1\u7b97\u8fdb\u5ea6\uff1a"+(a+1)*(100/t.mCalcCount)+"%",a++},5)}catch(s){console.log(s),this.mPercentDialog.active=!1,alert("\u8ba1\u7b97\u6570\u636e\u51fa\u9519\uff01")}}}},NewClass.prototype.clearPassPercent=function(){if(this.mDataList&&!(this.mDataList.length<=0))for(var t=0;t<this.mDataList.length;++t)this.mDataList[t].passPercent=-1,this.mDataList[t].passPercent_2=-1},NewClass.prototype.clearMap=function(){for(var t=this.mapBg.children,e=0;e<t.length;++e)t[e].destroy()},NewClass.prototype.onBtnItemClicked=function(t){var e=t.target._listId;this.mNowShowIdx=e,this.mNowShowStep=0;var a=this.mDataList[e].cubes,i=this.mDataList[e].mergeList;this.clearMap();for(var s=0;s<this.mRows;++s)for(var o=0;o<a[s].length;++o)if(a[s][o]){for(var r=!1,n=0;n<i.length;++n)(i[n][0].x==a[s][o].row&&i[n][0].y==a[s][o].col||i[n][1].x==a[s][o].row&&i[n][1].y==a[s][o].col)&&(r=!0);this.addCube(a[s][o],r)}},NewClass.prototype.onBtnRecodClicked=function(t,e){if(!(this.mDataList.length<=0)){var a;!(a=deepClone("11"==e||"12"==e||"13"==e?this.mDataList[this.mNowShowIdx].prcessCubes_1:this.mDataList[this.mNowShowIdx].prcessCubes_2))||a.length<=0||("11"==e||"21"==e?this.mNowShowStep>0&&this.mNowShowStep--:"12"==e||"22"==e?this.mNowShowStep=0:"13"!=e&&"23"!=e||this.mNowShowStep<a.length-1&&this.mNowShowStep++,this.mNowShowStep<0&&(this.mNowShowStep=0),this.mNowShowStep>=a.length&&(this.mNowShowStep=a.length-1),this.fillMap(a[this.mNowShowStep]))}},NewClass.prototype.fillMap=function(t){this.clearMap();for(var e=0;e<t.length;++e)for(var a=0;a<t[e].length;++a)t[e][a]&&this.addCube(t[e][a],!1)},NewClass.prototype.addCube=function(t,e){var a=t.row,i=t.col,s=t.num,o=cc.instantiate(this.cubeNode);o.getChildByName("bg").active=e,cc.resources.load("nums/"+s,cc.SpriteFrame,function(t,e){t&&console.log(t),o.getChildByName("num").getComponent(cc.Sprite).spriteFrame=e}),o.setPosition((i+.5)*(654/9),72.5*-(a+.5)),this.mapBg.addChild(o)},NewClass.prototype.onBtnDownLoad=function(){if(!this.mDataList||this.mDataList.length<=0)alert("\u5bf9\u4e0d\u8d77\uff0c\u6570\u636e\u9519\u8bef\uff01");else{for(var t="\u76f8\u90bb\u6d88\u9664\t\u975e\u76f8\u90bb\u6a2a\u7ad6\u6d88\u9664\t\u975e\u76f8\u90bb\u659c\u5411\u6d88\u9664\t\u975e\u76f8\u90bb\u659c\u5411\u6d88\u9664\u95f4\u96941\t\u975e\u76f8\u90bb\u659c\u5411\u6d88\u9664\u95f4\u9694\u5927\u4e8e1\t\u9996\u5c3e\u6d88\u9664\tcombo\u89e6\u53d1\u5e73\u5747\u6b21\u6570\t\u6700\u5927combo\u6b21\u6570\t\u901a\u5173\u7387\t\u5e73\u5c40\u590d\u5236\u6b21\u6570\t\u76f8\u90bb\u6d88\u9664_2\t\u975e\u76f8\u90bb\u6a2a\u7ad6\u6d88\u9664_2\t\u975e\u76f8\u90bb\u659c\u5411\u6d88\u9664_2\t\u975e\u76f8\u90bb\u659c\u5411\u6d88\u9664\u95f4\u96941_2\t\u975e\u76f8\u90bb\u659c\u5411\u6d88\u9664\u95f4\u9694\u5927\u4e8e1_2\t\u9996\u5c3e\u6d88\u9664_2\tcombo\u89e6\u53d1\u5e73\u5747\u6b21\u6570_2\t\u6700\u5927combo\u6b21\u6570_2\t\u901a\u5173\u7387_2\t\u5e73\u5c40\u590d\u5236\u6b21\u6570_2\t\u5e73\u5747\u5269\u4f59\u65b9\u5757\u6570(\u603b)\t\u5e73\u5747\u5269\u4f59\u65b9\u5757\u6570(\u5931\u8d25)\t\u5e73\u5747\u5269\u4f59\u65b9\u5757\u6570(\u603b)_2\t\u5e73\u5747\u5269\u4f59\u65b9\u5757\u6570(\u5931\u8d25)_2\n",e=0;e<this.mDataList.length;++e){var a="",i=this.mDataList[e].passPercent;a+=this.mDataList[e].mergeAdjacentNum/this.mCalcCount+"\t",a+=this.mDataList[e].mergeHvNum/this.mCalcCount+"\t",a+=this.mDataList[e].mergeSlantNum/this.mCalcCount+"\t",a+=(this.mDataList[e].mergeSlantNum-this.mDataList[e].mergeSpaceOver1)/this.mCalcCount+"\t",a+=this.mDataList[e].mergeSpaceOver1/this.mCalcCount+"\t",a+=this.mDataList[e].mergeHeadTailNum/this.mCalcCount+"\t",this.mDataList[e].comboTimes>0?a+=this.mDataList[e].comboNum/this.mDataList[e].comboTimes+"\t":a+="0\t",a+=this.mDataList[e].maxCombo+"\t",a+=this.mDataList[e].passPercent*(100/this.mCalcCount)+"\t",a+=this.mDataList[e].copyTimeAvg/this.mCalcCount+"\t";var s=this.mDataList[e].passPercent_2;a+=this.mDataList[e].mergeAdjacentNum_2/this.mCalcCount+"\t",a+=this.mDataList[e].mergeHvNum_2/this.mCalcCount+"\t",a+=this.mDataList[e].mergeSlantNum_2/this.mCalcCount+"\t",a+=(this.mDataList[e].mergeSlantNum_2-this.mDataList[e].mergeSpaceOver1_2)/this.mCalcCount+"\t",a+=this.mDataList[e].mergeSpaceOver1_2/this.mCalcCount+"\t",a+=this.mDataList[e].mergeHeadTailNum_2/this.mCalcCount+"\t",this.mDataList[e].comboTimes_2>0?a+=this.mDataList[e].comboNum_2/this.mDataList[e].comboTimes_2+"\t":a+="0\t",a+=this.mDataList[e].maxCombo_2+"\t",a+=this.mDataList[e].passPercent_2*(100/this.mCalcCount)+"\t",a+=this.mDataList[e].copyTimeAvg_2/this.mCalcCount+"\t",a+=this.mDataList[e].LeftCubeNum/this.mCalcCount+"\t",this.mCalcCount-i>0?a+=this.mDataList[e].LeftCubeNum/(this.mCalcCount-i)+"\t":a+="0\t",a+=this.mDataList[e].LeftCubeNum_2/this.mCalcCount+"\t",this.mCalcCount-s>0?a+=this.mDataList[e].LeftCubeNum_2/(this.mCalcCount-s)+"\n":a+="0\n",t+=a}this.writeData(t,2)}},NewClass.prototype.initNumberPool=function(){if(this.mNumberPool.length<=0){for(var t=0;t<this.MAP_COL;++t)this.mNumberPool.push(t+1);this.mNumberPool.sort(function(){return.5-Math.random()}),this.mNumberPoolBeenEmptyed=!0}},NewClass.prototype.initMapData=function(t){this.clearMapData();for(var e=[],a=0;a<this.MAP_COL;a++)e.push(a);e.sort(function(){return.5-Math.random()}),this.mNumberPool=[],this.initNumberPool(),this.mNumberPoolBeenEmptyed=!1;var i=!1;if(t){this.initNumberPool();var s=this.mNumberPool[0];this.mNumberPool.splice(0,1);var o=cc.math.randomRangeInt(0,3),r=this.MAP_COL-1;this.mMapData[o][r]=new NumberCube,this.mMapData[o][r].row=o,this.mMapData[o][r].col=r,this.mMapData[o][r].num=s,o+=1,r=0,this.mMapData[o][r]=new NumberCube,this.mMapData[o][r].row=o,this.mMapData[o][r].col=r,this.mMapData[o][r].num=s,1==cc.math.randomRangeInt(0,2)&&(this.mMapData[o][r].num=10-s),i=3==o}e.sort(function(){return.5-Math.random()});var n=0;for(a=0;a<this.MAP_COL&&n<this.mFistLineNum;++a)if(o=0,r=e[a],!this.mMapData[o][r]){n++,this.initNumberPool();var l=this.mNumberPool[0];-1==this.fillMapNumber(o,r,l,3,!0)&&this.fillMapNumber(o,r,l,3,!1)}for(n=0,a=0;a<this.MAP_COL&&n<this.mSecLineNum;++a)if(o=1,r=e[a],!this.mMapData[o][r]){n++,this.initNumberPool();var h=0;l=this.mNumberPool[h],this.mNumberPool.splice(h,1),this.mMapData[o][r]=new NumberCube,this.mMapData[o][r].row=o,this.mMapData[o][r].col=r,this.mMapData[o][r].num=l,-1==this.fillMapNumber(o,r,l,3,!0)&&this.fillMapNumber(o,r,l,3,!1)}for(n=0,a=0;a<this.MAP_COL&&n<this.mThirdLineNum;++a)o=2,r=e[a],this.mMapData[o][r]||(n++,this.initNumberPool(),h=0,l=this.mNumberPool[h],this.mNumberPool.splice(h,1),this.mMapData[o][r]=new NumberCube,this.mMapData[o][r].row=o,this.mMapData[o][r].col=r,this.mMapData[o][r].num=l,-1==this.fillMapNumber(o,r,l,3,!0)&&this.fillMapNumber(o,r,l,3,!1));for(n=0,a=0;a<this.MAP_COL&&n<this.mFourLineNum;++a)o=3,r=e[a],this.mMapData[o][r]||(n++,this.initNumberPool(),h=0,l=this.mNumberPool[h],this.mNumberPool.splice(h,1),this.mMapData[o][r]=new NumberCube,this.mMapData[o][r].row=o,this.mMapData[o][r].col=r,this.mMapData[o][r].num=l,-1==this.fillMapNumber(o,r,l,3,!0)&&this.fillMapNumber(o,r,l,3,!1));e.sort(function(){return.5-Math.random()});var c=[];for(a=0;a<this.MAP_COL&&a<this.mFiveLineNum;++a){var m=e[a];this.mMapData[0][m]&&m<this.mFiveLineCountNum&&c.push(m)}for(a=0;a<c.length;++a)if(m=c[a],!(this.mMapData[4][m]||i&&0==m)&&(this.mMapData[4][m]=new NumberCube,this.mMapData[4][m].row=4,this.mMapData[4][m].col=m,this.mMapData[4][m].num=this.mMapData[0][m].num,a%2==1&&.8-Math.random()>0&&(!i||0!=c[a-1]))){var p=this.mMapData[4][c[a-1]].num;this.mMapData[4][c[a-1]].num=this.mMapData[4][m].num,this.mMapData[4][m].num=p}var u=[];for(a=0;a<5;++a){var d=this.MAP_COL;4==a&&(d=this.mFiveLineCountNum);for(var _=0;_<d;++_)this.mMapData[a][_]||u.push(new IntVec2(a,_))}for(var f=0,y=0;u.length>0;){this.initNumberPool();var C=-1;if(s=0,f%2==1){var g=[y,10-y];if(this.mNumberPoolBeenEmptyed){for(g=[],a=0;a<9;++a)g[a]=a+1;g.sort(function(){return.5-Math.random()})}for(h=0;h<g.length;++h){for(s=g[h],a=0;a<u.length;++a){var D=u[a];if(this.mMapData[D.x][D.y]=new NumberCube,this.mMapData[D.x][D.y].row=D.x,this.mMapData[D.x][D.y].col=D.y,this.mMapData[D.x][D.y].num=s,!this.canSingleCubeMerge(D)){C=a;break}this.mMapData[D.x][D.y]=null}if(C>=0)break}}else for(h=0;h<this.mNumberPool.length;++h){for(s=this.mNumberPool[h],a=0;a<u.length;++a){if(D=u[a],this.mMapData[D.x][D.y]=new NumberCube,this.mMapData[D.x][D.y].row=D.x,this.mMapData[D.x][D.y].col=D.y,this.mMapData[D.x][D.y].num=s,!this.canSingleCubeMerge(D)){C=a,this.mNumberPool.splice(h,1);break}this.mMapData[D.x][D.y]=null}if(C>=0)break}if(-1==C){var w=.5>Math.random()?y:10-y;f%2==1?s=w:(s=this.mNumberPool[0],this.mNumberPool.splice(0,1)),D=u[C=cc.math.randomRangeInt(0,u.length)],this.mMapData[D.x][D.y]=new NumberCube,this.mMapData[D.x][D.y].row=D.x,this.mMapData[D.x][D.y].col=D.y,this.mMapData[D.x][D.y].num=s}y=s,u.splice(C,1),f++}},NewClass.prototype.fillMapNumber=function(t,e,a,i,s){var o=-1;if(2==t||3==t){var r=new IntVec2(t-2,e-2),n=new IntVec2(t-2,e+2);this.isValidRowCol(r)&&!this.mMapData[r.x][r.y]&&(this.mMapData[r.x][r.y]=new NumberCube,this.mMapData[r.x][r.y].row=r.x,this.mMapData[r.x][r.y].col=r.y,this.mMapData[r.x][r.y].num=a,1==cc.math.randomRangeInt(0,2)&&(this.mMapData[r.x][r.y].num=10-a),o=0,s&&this.canSingleCubeMerge(r)&&(o=-1,this.mMapData[r.x][r.y]=null)),-1==o&&this.isValidRowCol(n)&&!this.mMapData[n.x][n.y]&&(this.mMapData[n.x][n.y]=new NumberCube,this.mMapData[n.x][n.y].row=n.x,this.mMapData[n.x][n.y].col=n.y,this.mMapData[n.x][n.y].num=a,1==cc.math.randomRangeInt(0,2)&&(this.mMapData[n.x][n.y].num=10-a),o=1,s&&this.canSingleCubeMerge(n)&&(o=-1,this.mMapData[n.x][n.y]=null))}if(-1==o){for(var l=[],h=e+i;h<this.MAP_COL;++h)this.mMapData[t][h]||l.push(h);for(h=e-i;h>=0;--h)this.mMapData[t][h]||l.push(h);l.length>0&&(h=l[h=cc.math.randomRangeInt(0,l.length)],this.mMapData[t][h]=new NumberCube,this.mMapData[t][h].row=t,this.mMapData[t][h].col=h,this.mMapData[t][h].num=a,1==cc.math.randomRangeInt(0,2)&&(this.mMapData[t][h].num=10-a),o=2,s&&this.canSingleCubeMerge(new IntVec2(t,h))&&(o=-1,this.mMapData[t][h]=null))}return o},NewClass.prototype.getAllCubes=function(){for(var t=[],e=0;e<this.MAP_ROW;++e)for(var a=0;a<this.MAP_COL;++a)if(this.mMapData[e]&&this.mMapData[e][a]){var i=new NumberCube;i.row=this.mMapData[e][a].row,i.col=this.mMapData[e][a].col,i.num=this.mMapData[e][a].num,t.push(i)}return t},NewClass.prototype.createMap=function(){this.mDataList=[];for(var t=0,e=0;e<this.mTargetCount&&t<1e5;++e){t++,this.initMapData(this.mIsForceHeadTail);var a=new CubeData;a.cubes=deepClone(this.mMapData),a.mergeList=(new Array).fill([]),a.mergeList=[],this.mDataList.push(a)}},NewClass.prototype.mergeMap=function(t){for(var e=[],a=this.getAllCubes(),i=0;i<a.length;++i)for(var s=0;s<a.length;++s)if(i!=s){var o=a[i].row,r=a[i].col,n=a[s].row,l=a[s].col;if(null!=this.mMapData[o][r]&&null!=this.mMapData[n][l]){for(var h=!1,c=0;c<e.length;++c){var m=e[c][0],p=e[c][1];if(m.x==a[i].row&&m.y==a[i].col||m.x==a[s].row&&m.y==a[s].col){h=!0;break}if(p.x==a[i].row&&p.y==a[i].col||p.x==a[s].row&&p.y==a[s].col){h=!0;break}}h||this.canCubeMerge(a[i].getRowCol(),a[s].getRowCol())&&(e.push([a[i].getRowCol(),a[s].getRowCol()]),t&&(this.mMapData[o][r]=null,this.mMapData[n][l]=null),i=0,s=0)}}return e},NewClass.prototype.getOptimalIndex=function(t,e){var a=-1;if(!t||t.length<=0)return a;a=cc.math.randomRangeInt(0,t.length);var i=!1;if(e)for(var s=0;s<t.length;++s){var o=t[s][0],r=t[s][1];if(3==o.x||4==o.x||3==r.x||4==r.x){i=!0,a=s;break}}if(!i)for(s=0;s<t.length;++s){if(o=t[s][0],r=t[s][1],o.x==r.x&&2==this.getRowCubes(o.x)){i=!0,a=s;break}if(1==this.getRowCubes(o.x)||1==this.getRowCubes(r.x)){i=!0,a=s;break}}return a},NewClass.prototype.getRowCubes=function(t){for(var e=0,a=0;a<this.MAP_COL;++a){var i=new IntVec2(t,a);this.isValidRowCol(i)&&this.mMapData[i.x][i.y]&&e++}return e},NewClass.prototype.getCubeRoundRC=function(t){var e=new Array;if(!this.isValidRowCol(t))return e;var a=new IntVec2(t.x-1,t.y-1);return this.isValidRowCol(a)&&e.push(a),a=new IntVec2(t.x-1,t.y),this.isValidRowCol(a)&&e.push(a),a=new IntVec2(t.x-1,t.y+1),this.isValidRowCol(a)&&e.push(a),a=new IntVec2(t.x,t.y-1),this.isValidRowCol(a)&&e.push(a),a=new IntVec2(t.x,t.y+1),this.isValidRowCol(a)&&e.push(a),a=new IntVec2(t.x+1,t.y-1),this.isValidRowCol(a)&&e.push(a),a=new IntVec2(t.x+1,t.y),this.isValidRowCol(a)&&e.push(a),a=new IntVec2(t.x+1,t.y+1),this.isValidRowCol(a)&&e.push(a),e},NewClass.prototype.initScrollView=function(){this.listV.numItems=this.mDataList.length},NewClass.prototype.isValidRowCol=function(t){return!(t.x<0||t.x>=this.MAP_ROW||t.y<0||t.y>=this.MAP_COL||4==t.x&&t.y>=this.mFiveLineCountNum)},NewClass.prototype.isRowColEqual=function(t,e){return t.x==e.x&&t.y==e.y},NewClass.prototype.canCubeMerge=function(t,e){if(!this.isValidRowCol(t)||!this.isValidRowCol(e)||this.isRowColEqual(t,e))return!1;var a=this.mMapData[t.x][t.y],i=this.mMapData[e.x][e.y];if(!a||!i)return!1;var s=a.num+i.num==10,o=a.num==i.num;if(!s&&!o)return!1;var r=[];try{if(t.x==e.x)for(var n=Math.min(t.y,e.y),l=Math.max(t.y,e.y),h=n+1;h<l;++h)(u=this.mMapData[t.x][h])&&r.push(u);else if(t.y==e.y){var c=Math.min(t.x,e.x),m=Math.max(t.x,e.x);for(h=c+1;h<m;++h)(u=this.mMapData[h][t.y])&&r.push(u)}else if(t.x<e.x&&t.y<e.y&&e.x-t.x==e.y-t.y){h=t.x+1;for(var p=t.y+1;h<e.x&&p<e.y;++h,++p)(u=this.mMapData[h][p])&&r.push(u)}else if(t.x>e.x&&t.y<e.y&&t.x-e.x==e.y-t.y)for(h=t.x-1,p=t.y+1;h>e.x&&p<e.y;--h,++p)(u=this.mMapData[h][p])&&r.push(u);else if(t.x>e.x&&t.y>e.y&&t.x-e.x==t.y-e.y)for(h=t.x-1,p=t.y-1;h>e.x&&p>e.y;--h,--p)(u=this.mMapData[h][p])&&r.push(u);else if(t.x<e.x&&t.y>e.y&&e.x-t.x==t.y-e.y)for(h=t.x+1,p=t.y-1;h<e.x&&p>e.y;++h,--p)(u=this.mMapData[h][p])&&r.push(u);else if(t.x<e.x){for(p=t.y+1;p<this.MAP_COL;++p)(u=this.mMapData[t.x][p])&&r.push(u);for(h=t.x+1;h<e.x;++h)for(p=0;p<this.MAP_COL;++p)(u=this.mMapData[h][p])&&r.push(u);for(p=0;p<e.y;++p)(u=this.mMapData[e.x][p])&&r.push(u)}else if(t.x>e.x){for(p=t.y-1;p>=0;--p)(u=this.mMapData[t.x][p])&&r.push(u);for(h=t.x-1;h>e.x;--h)for(p=this.MAP_COL-1;p>=0;--p)(u=this.mMapData[h][p])&&r.push(u);for(p=this.MAP_COL-1;p>e.y;--p){var u;(u=this.mMapData[e.x][p])&&r.push(u)}}}catch(d){d.toString()}return 0==r.length},NewClass.prototype.canSingleCubeMerge=function(t){for(var e=this.getAllCubes(),a=0;a<e.length;++a)if(this.canCubeMerge(t,e[a].getRowCol()))return!0;return!1},NewClass.prototype.onListVRender=function(t,e){for(var a=this.mDataList[e],i=cc.find("bg/labelData",t),s=e+1+"--[",o=a.cubes,r=0;r<this.mRows;++r){var n=o[r].length;4==r&&(n=this.mFiveLineCountNum);for(var l=0;l<n;++l)s+=o[r][l].num,l<n-1&&(s+=",");r<this.mRows-1?s+=",":s+="]"}i.getComponent(cc.Label).string=s},NewClass.prototype.calcAllCubeDatas=function(t){if(!this.mDataList||this.mDataList.length<=0)alert("\u6570\u636e\u51fa\u9519\uff0c\u8bf7\u91cd\u65b0\u4e0a\u4f20\uff01");else{this.mCalcCount,this.mDataList.length,this.mDataList.length,t&&this.mDataList.length;for(var e=0;e<this.mDataList.length;++e){var a=this.mDataList[e];this.clearMapData(),this.mMapData=deepClone(a.cubes),this.addMapRecord(t,e),this.mLastRC=new IntVec2(this.mRows-1,this.mFiveLineCountNum-1);var i=this.mAddCount;t&&i>0&&(this.addNewNumbers(),this.mDataList[e].copyTimeAvg_2+=1,i-=1,this.addMapRecord(t,e));for(var s=0,o=0,r=this.mergeMap(!1),n=!1;r.length>0;){var l=this.getOptimalIndex(r,t&&i==this.mAddCount-1),h=r[l][0],c=r[l][1];n||(this.isHeadTails(h,c)?t?this.mDataList[e].mergeHeadTailNum_2+=1:this.mDataList[e].mergeHeadTailNum+=1:h.x==c.x&&Math.abs(h.y-c.y)>1?t?this.mDataList[e].mergeHvNum_2+=1:this.mDataList[e].mergeHvNum+=1:h.y==c.y&&Math.abs(h.x-c.x)>1?t?this.mDataList[e].mergeHvNum_2+=1:this.mDataList[e].mergeHvNum+=1:Math.abs(h.x-c.x)==Math.abs(h.y-c.y)&&Math.abs(h.x-c.x)>1?t?(this.mDataList[e].mergeSlantNum_2+=1,Math.abs(h.x-c.x)>2&&(this.mDataList[e].mergeSpaceOver1_2+=1)):(this.mDataList[e].mergeSlantNum+=1,Math.abs(h.x-c.x)>2&&(this.mDataList[e].mergeSpaceOver1+=1)):t?this.mDataList[e].mergeAdjacentNum_2+=1:this.mDataList[e].mergeAdjacentNum+=1),this.mMapData[h.x][h.y]=null,this.mMapData[c.x][c.y]=null;var m=!1;if(this.getRowCubes(h.x)<=0&&(h.x==this.mLastRC.x&&(this.mLastRC.y=this.MAP_COL-1),this.mLastRC.x-=1,m=!0),h.x!=c.x&&this.getRowCubes(c.x)<=0&&(c.x==this.mLastRC.x&&(this.mLastRC.y=this.MAP_COL-1),this.mLastRC.x-=1,m=!0),m?s+=1:s=0,s>1&&o++,this.checkEmptyLine(),this.addMapRecord(t,e),this.getAllCubes().length<=0)break;for(r=this.mergeMap(!1);r.length<=0&&i>0;)this.addNewNumbers(),n=!0,t?this.mDataList[e].copyTimeAvg_2+=1:this.mDataList[e].copyTimeAvg+=1,this.addMapRecord(t,e),i-=1,r=this.mergeMap(!1)}var p=this.getAllCubes();t?(this.mDataList[e].passPercent_2<=0&&(this.mDataList[e].passPercent_2=0),this.mDataList[e].passPercent_2+=0==p.length?1:0):(this.mDataList[e].passPercent<=0&&(this.mDataList[e].passPercent=0),this.mDataList[e].passPercent+=0==p.length?1:0),t?this.mDataList[e].LeftCubeNum_2+=p.length:this.mDataList[e].LeftCubeNum+=p.length,t?0==p.length&&(this.mDataList[e].comboNum_2+=o,this.mDataList[e].maxCombo_2=Math.max(this.mDataList[e].maxCombo_2,o),this.mDataList[e].comboTimes_2+=1):0==p.length&&(this.mDataList[e].comboNum+=o,this.mDataList[e].maxCombo=Math.max(this.mDataList[e].maxCombo,o),this.mDataList[e].comboTimes+=1)}}},NewClass.prototype.addMapRecord=function(t,e){t?this.mDataList[e].prcessCubes_2.push(deepClone(this.mMapData)):this.mDataList[e].prcessCubes_1.push(deepClone(this.mMapData))},NewClass.prototype.checkEmptyLine=function(){try{for(var t=1;t<this.MAP_ROW;++t){for(var e=!0,a=0;a<this.MAP_COL;++a)if(this.mMapData[t]&&this.mMapData[t][a]){e=!1;break}if(!e){for(var i=0,s=t-1;s>=0;--s){var o=!0;for(a=0;a<this.MAP_COL;++a)if(this.mMapData[s][a]){o=!1;break}if(!o)break;i++}if(i>0){for(var r=t;r<this.MAP_ROW;++r)for(a=0;a<this.MAP_COL;++a)if(this.mMapData[r]){var n=r-i;this.mMapData[n][a]=this.mMapData[r][a],this.mMapData[r][a]=null,this.mMapData[n][a]&&(this.mMapData[n][a].row=n)}t-=i}}}}catch(l){l.toString()}},NewClass.prototype.addNewNumbers=function(){for(var t=this.getAllCubes(),e=0,a=this.mLastRC,i=this.mLastRC.x;i<this.MAP_ROW;++i)for(var s=i==this.mLastRC.x?this.mLastRC.y+1:0;s<this.MAP_COL;++s){this.mMapData[i]||(this.mMapData[i]=[]);var o=t[e++],r=new NumberCube;r.row=i,r.col=s,r.num=o.num,this.mMapData[i][s]=r,a.x=i,a.y=s,e>=t.length&&(i=this.MAP_ROW,s=this.MAP_COL)}this.mLastRC=a},NewClass.prototype.isHeadTails=function(t,e){var a=!1,i=0;if(t.x<e.x){for(var s=t.y+1;s<this.MAP_COL;++s)null!=this.mMapData[t.x][s]&&i++;for(var o=t.x+1;o<e.x;++o)for(s=0;s<this.MAP_COL;++s)null!=this.mMapData[o][s]&&i++;for(s=0;s<e.y;++s)null!=this.mMapData[e.x][s]&&i++;0==i&&(a=!0)}else if(t.x>e.x){for(s=t.y-1;s>=0;--s)null!=this.mMapData[t.x][s]&&i++;for(o=t.x-1;o>e.x;--o)for(s=this.MAP_COL-1;s>=0;--s)null!=this.mMapData[o][s]&&i++;for(s=this.MAP_COL-1;s>e.y;--s)null!=this.mMapData[e.x][s]&&i++;0==i&&(a=!0)}return a},NewClass.prototype.onBtnOldVersionClicked=function(t,e){"1"==e?cc.director.loadScene("main"):"2"==e?cc.director.loadScene("map2"):cc.director.loadScene("map3")},NewClass.prototype.showToast=function(t){var e=document.createElement("div");e.innerHTML=t,e.style.cssText="width:40%; min-width:180px; background:#000; opacity:0.8; height:auto;min-height: 50px; color:#fff; line-height:200px; font-size:60; text-align:center; border-radius:4px; position:fixed; top:60%; left:30%; z-index:999999;",document.body.appendChild(e),setTimeout(function(){e.style.webkitTransition="-webkit-transform 0.5s ease-in, opacity 0.5s ease-in",e.style.opacity="0",setTimeout(function(){document.body.removeChild(e)},500)},1e3)},NewClass.prototype.writeData=function(t,e){if(cc.sys.platform==cc.sys.WIN32){if(""==this.mOutPutFileTime){Date.now();var a=new Date;this.mOutPutFileTime=a.getFullYear().toString()+"-"+(a.getMonth()+1).toString()+"-"+a.getDate().toString(),this.mOutPutFileTime+="-"+a.getHours().toString()+":"+a.getMinutes().toString()+":"+a.getSeconds()}var i=jsb.fileUtils.getWritablePath();console.log("\u53ef\u5199\u8def\u5f84:",i);var s=1==e?"output":"output_calc",o=i+(s+=this.mOutPutFileTime+".xlsx");jsb.fileUtils.isFileExist(o)&&jsb.fileUtils.removeFile(o),jsb.fileUtils.writeStringToFile(t,o)}else navigator.clipboard.writeText(t),this.showToast("\u590d\u5236\u5230\u526a\u5207\u677f\u6210\u529f\uff01")},NewClass.prototype.readData=function(){var _this=this;if(cc.sys.platform==cc.sys.WIN32){var writablePath=jsb.fileUtils.getWritablePath();console.log("\u53ef\u5199\u8def\u5f84:",writablePath);for(var filePath=writablePath+"output.xlsx",text=jsb.fileUtils.getStringFromFile(filePath),str=text.toString(),data=str.split("\n"),i=0;i<data.length;++i){var arr=data[i];if(arr=eval(arr),null!=arr&&""!=arr){var cData=new CubeData;cData.cubes=[],cData.mergeList=[];for(var j=0;j<arr.length;++j){var row=Math.floor(j/this.MAP_COL),col=j%this.MAP_COL;cData.cubes[row]||(cData.cubes[row]=[]);var cube=new NumberCube;cube.row=row,cube.col=col,cube.num=Number(arr[j]),cData.cubes[row][col]=cube}this.clearMapData(),this.mMapData=deepClone(cData.cubes);var merListTmp=this.mergeMap(!0);this.clearMapData(),merListTmp&&merListTmp.length>0&&(cData.mergeList=deepClone(merListTmp)),this.mDataList.push(cData)}}this.initScrollView(),alert("\u4e0a\u4f20\u6570\u636e"+this.mDataList.length+"\u6761")}else navigator.clipboard.readText().then(function(text){for(var str=text.toString(),data=str.split("\n"),i=0;i<data.length;++i){var arr=data[i];if(arr=eval(arr),null!=arr&&""!=arr){var cData=new CubeData;cData.cubes=[],cData.mergeList=[];for(var j=0;j<arr.length;++j){var row=Math.floor(j/_this.MAP_COL),col=j%_this.MAP_COL;cData.cubes[row]||(cData.cubes[row]=[]);var cube=new NumberCube;cube.row=row,cube.col=col,cube.num=Number(arr[j]),cData.cubes[row][col]=cube}_this.clearMapData(),_this.mMapData=deepClone(cData.cubes);var merListTmp=_this.mergeMap(!0);_this.clearMapData(),merListTmp&&merListTmp.length>0&&(cData.mergeList=deepClone(merListTmp)),_this.mDataList.push(cData)}}_this.initScrollView(),alert("\u4e0a\u4f20\u6570\u636e"+_this.mDataList.length+"\u6761")}).catch(function(t){console.error("Failed to read clipboard contents: ",t),_this.showToast("\u4e0a\u4f20\u6570\u636e\u51fa\u9519\uff01")})},__decorate([property({type:cc.Node})],NewClass.prototype,"mapBg",void 0),__decorate([property({type:cc.EditBox})],NewClass.prototype,"input_Line_1",void 0),__decorate([property({type:cc.EditBox})],NewClass.prototype,"input_Line_2",void 0),__decorate([property({type:cc.EditBox})],NewClass.prototype,"input_Line_3",void 0),__decorate([property({type:cc.EditBox})],NewClass.prototype,"input_Line_4",void 0),__decorate([property({type:cc.EditBox})],NewClass.prototype,"input_Line_5",void 0),__decorate([property({type:cc.EditBox})],NewClass.prototype,"input_Line_5_count",void 0),__decorate([property({type:cc.EditBox})],NewClass.prototype,"input_Total_Count",void 0),__decorate([property({type:cc.EditBox})],NewClass.prototype,"input_calc_count",void 0),__decorate([property({type:cc.Button})],NewClass.prototype,"btnDone",void 0),__decorate([property({type:cc.Button})],NewClass.prototype,"btnCopy",void 0),__decorate([property({type:cc.Node})],NewClass.prototype,"cubeNode",void 0),__decorate([property({type:cc.Node})],NewClass.prototype,"mPercentDialog",void 0),__decorate([property({type:cc.Label})],NewClass.prototype,"mLabelPercent",void 0),__decorate([property({type:cc.Toggle})],NewClass.prototype,"mTaggleForceHeadTail",void 0),__decorate([property({type:List_1.default})],NewClass.prototype,"listV",void 0),__decorate([property({type:cc.Label})],NewClass.prototype,"labelLeft_1",void 0),__decorate([property({type:cc.Label})],NewClass.prototype,"labelLeft_2",void 0),NewClass=__decorate([ccclass],NewClass),NewClass}(cc.Component);exports.default=NewClass,cc._RF.pop()},{"./List":"List"}]},{},["CalcWorker","List","ListItem","Start","main","map2","map3","map4","map5"]);